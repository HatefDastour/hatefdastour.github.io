

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7. Morphological Transformations &#8212; Computer Vision</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Morphological_Transformations';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="6. Image Filtering" href="Image_Filtering.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="Getting_Started.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Getting_Started.html">
                    Getting Started with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Getting_Started_with_Open_CV.html">1. Getting Started with Open CV</a></li>

<li class="toctree-l1"><a class="reference internal" href="Geometric_Image_Transformations.html">3. Geometric Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Drawing_Functions.html">4. Drawing Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image_Thresholding.html">5. Image Thresholding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Image_Filtering.html">6. Image Filtering</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Morphological Transformations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://hatefdastour.github.io/notes/Numerical_Analysis/issues/new?title=Issue%20on%20page%20%2FMorphological_Transformations.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Morphological_Transformations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Morphological Transformations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dilation">7.1. Dilation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#erosion">7.2. Erosion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphologyex">7.3. morphologyEx</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-operation">7.3.1. Opening Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-operation">7.3.2. Closing Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morphological-gradient">7.3.3. Morphological Gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#top-hat">7.3.4. Top Hat</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#black-hat">7.3.5. Black Hat</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refrences">7.4. Refrences</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="morphological-transformations">
<h1><span class="section-number">7. </span>Morphological Transformations<a class="headerlink" href="#morphological-transformations" title="Permalink to this headline">#</a></h1>
<p>Morphological operations are image processing techniques that involve the use of a structuring element to analyze the relationship between shapes in an image. The two fundamental morphological operations are erosion and dilation, which can be used for various purposes including:</p>
<ol class="arabic simple">
<li><p>Noise reduction: Erosion can help in reducing noise or small artifacts in an image by shrinking the boundaries of regions and smoothing out irregularities. It removes isolated pixels or small clusters that do not match the shape of the structuring element.</p></li>
<li><p>Isolation of individual elements and joining disparate elements: Dilation expands the boundaries of regions in an image, which can be useful for joining broken or disconnected parts of an object. It can help in closing small gaps between objects or filling in missing regions.</p></li>
<li><p>Detection of intensity bumps or holes: By performing erosion and dilation operations in combination, morphological operations can be used to detect and analyze the presence of intensity bumps or holes in an image. Erosion followed by dilation (closing operation) can fill in small holes or gaps, while dilation followed by erosion (opening operation) can separate or isolate individual intensity bumps.</p></li>
</ol>
<p>These morphological operations play a significant role in various image processing tasks, including image enhancement, segmentation, feature extraction, and object recognition. They provide a powerful set of tools for modifying and analyzing the structure of images based on the shapes and relationships within them.</p>
<div class="section" id="dilation">
<h2><span class="section-number">7.1. </span>Dilation<a class="headerlink" href="#dilation" title="Permalink to this headline">#</a></h2>
<p>Dilation is a morphological operation that involves convoluting an image with a kernel or structuring element. The kernel is a small matrix with a defined anchor point, typically located at its center.</p>
<p>During the dilation operation, the center of the kernel is placed on each pixel of the input image, and the values of the kernel are compared to the corresponding pixels in the neighborhood. The output pixel value is determined by finding the maximum value among the kernel elements that overlap with the neighborhood.</p>
<p>The dilation operation causes regions in the image to expand or grow, as the maximum pixel value in the neighborhood becomes the new value for the central pixel. It helps in highlighting or enlarging the bright areas or regions in an image. Dilation is often used in conjunction with other morphological operations, such as erosion, to achieve desired image processing effects and manipulate the shape and size of objects within an image.</p>
<p>Dilation plays a crucial role in various applications, including image enhancement, edge detection, feature extraction, and object recognition. It is particularly useful for filling small gaps, joining broken parts, and thickening or enlarging object boundaries in an image.</p>
<p>In OpenCV, dilating an image can be done using <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/filtering.html?highlight=cv2.erode#dilate">dilate</a>. The function dilates the source image using the specified structuring element that determines the shape of a pixel neighborhood over which the maximum is taken:</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} (x,y) =  \max _{(x',y'):  \, \texttt{element} (x',y') \ne0 } \texttt{src} (x+x',y+y')\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>cv2.dilate(src, kernel[, dst[, anchor[, iterations[, borderType[, borderValue]]]]]) → dst
</pre></div>
</div>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p>src – input image; the number of channels can be arbitrary, but the depth should be one of CV_8U, CV_16U, CV_16S, CV_32F` or ``CV_64F.</p></li>
<li><p>dst – output image of the same size and type as src.</p></li>
<li><p>element – structuring element used for dilation; if element=Mat() , a 3 x 3 rectangular structuring element is used.</p></li>
<li><p>anchor – position of the anchor within the element; default value (-1, -1) means that the anchor is at the element center.</p></li>
<li><p>iterations – number of times dilation is applied.</p></li>
<li><p>borderType – pixel extrapolation method.</p></li>
<li><p>borderValue – border value in case of a constant border.</p></li>
</ul>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">import</span> <span class="nn">inflect</span>

<span class="c1"># Sample Image</span>
<span class="n">Colors</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;White&#39;</span><span class="p">:(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="s1">&#39;Black&#39;</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Red&#39;</span><span class="p">:(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="s1">&#39;Green&#39;</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Blue&#39;</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)}</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Dilation&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">()</span>
<span class="n">font</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Dilate&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Dilation</span>
<span class="n">IT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IT</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iteration&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iterations&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="k">del</span> <span class="n">i</span><span class="p">,</span> <span class="n">rows</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e69f329993c3b14929f975f2911b60bc1ef395099d69df2eea57c60d4b7674d2.png" src="_images/e69f329993c3b14929f975f2911b60bc1ef395099d69df2eea57c60d4b7674d2.png" />
</div>
</div>
<p>Let’s break down the code step by step:</p>
<ol class="arabic simple">
<li><p>Import libraries: The code imports the necessary libraries including NumPy, OpenCV (<code class="docutils literal notranslate"><span class="pre">cv2</span></code>), Matplotlib (<code class="docutils literal notranslate"><span class="pre">plt</span></code>), <code class="docutils literal notranslate"><span class="pre">FontProperties</span></code> from Matplotlib, and <code class="docutils literal notranslate"><span class="pre">inflect</span></code> for number-to-word conversion.</p></li>
<li><p>Sample Image and Colors: The code initializes a NumPy array called <code class="docutils literal notranslate"><span class="pre">Img</span></code> with dimensions 800x1000x3, representing an image. The dictionary <code class="docutils literal notranslate"><span class="pre">Colors</span></code> stores color values as RGB tuples.</p></li>
<li><p>Text and Font Properties: The variable <code class="docutils literal notranslate"><span class="pre">TXT</span></code> stores the text to be displayed on the image. The font face (<code class="docutils literal notranslate"><span class="pre">FF</span></code>) is set to <code class="docutils literal notranslate"><span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code>, and the font thickness (<code class="docutils literal notranslate"><span class="pre">thickness</span></code>) is set to 2. The font scale (<code class="docutils literal notranslate"><span class="pre">FS</span></code>) is set to 3.</p></li>
<li><p>Placing Text on the Image: The code calculates the size of the text using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code> and stores it in <code class="docutils literal notranslate"><span class="pre">(label_width,</span> <span class="pre">label_height)</span></code>. Then, it uses <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code> to place the text on the image three times with different colors and positions.</p></li>
<li><p>Kernel Creation: A binary circular kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones()</span></code> and <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The kernel size is set to (11, 11), and it is filled with the color white (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>).</p></li>
<li><p>Create Subplots: The code creates subplots using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> with a total of <code class="docutils literal notranslate"><span class="pre">rows</span> <span class="pre">*</span> <span class="pre">1</span></code> rows and 2 columns. The <code class="docutils literal notranslate"><span class="pre">figsize</span></code> parameter sets the size of the figure to (17, rows * 6) units. The subplots are stored in the variables <code class="docutils literal notranslate"><span class="pre">fig</span></code> and <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p></li>
<li><p>Set Title: The code sets the main title of the figure as ‘Dilate’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>. The font properties are set to bold.</p></li>
<li><p>Display Original Image and Kernel: The code selects the first subplot (<code class="docutils literal notranslate"><span class="pre">ax[0]</span></code>) and displays the original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">ax[0].imshow()</span></code>. The title of the subplot is set to ‘Original Image’. Similarly, the second subplot (<code class="docutils literal notranslate"><span class="pre">ax[1]</span></code>) displays the kernel image using <code class="docutils literal notranslate"><span class="pre">ax[1].imshow()</span></code>, and its title is set to ‘Kernel’.</p></li>
<li><p>Perform Dilation and Display Results: The code enters a loop that iterates from 1 to <code class="docutils literal notranslate"><span class="pre">IT</span></code> (4 in this case). In each iteration, it applies the dilation operation to the image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">cv2.dilate()</span></code> with the specified kernel and number of iterations (<code class="docutils literal notranslate"><span class="pre">i</span></code>). The resulting image (<code class="docutils literal notranslate"><span class="pre">Out</span></code>) is displayed in the corresponding subplot (<code class="docutils literal notranslate"><span class="pre">ax[i+1]</span></code>).</p></li>
<li><p>Set Subplot Titles: For each iteration, the code sets the title of the subplot based on the number of iterations using <code class="docutils literal notranslate"><span class="pre">inflect.engine().number_to_words()</span></code> to convert the iteration count to words. The titles are formatted as ‘Dilation after x iterations’ or ‘Dilation after y iteration’ for the first iteration.</p></li>
<li><p>Set Plot Properties: The code sets various properties for all subplots. It sets the aspect ratio to 1 and hides the axis.</p></li>
<li><p>Clean up: The variables <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">rows</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted from memory using the <code class="docutils literal notranslate"><span class="pre">del</span></code> statements.</p></li>
</ol>
<p>Note: To run this code successfully, you need to have the necessary libraries (NumPy, OpenCV, Matplotlib) imported and initialized correctly.</p>
</div>
<div class="section" id="erosion">
<h2><span class="section-number">7.2. </span>Erosion<a class="headerlink" href="#erosion" title="Permalink to this headline">#</a></h2>
<p>Erosion is a fundamental morphological operation that involves the convolution of an image with a kernel or structuring element. The kernel is a small matrix with a defined anchor point, typically located at its center.</p>
<p>During the erosion operation, the center of the kernel is placed on each pixel of the input image, and the values of the kernel are compared to the corresponding pixels in the neighborhood. The output pixel value is determined by finding the minimum value among the kernel elements that overlap with the neighborhood.</p>
<p>The erosion operation causes regions in the image to shrink or erode, as the minimum pixel value in the neighborhood becomes the new value for the central pixel. It helps in removing small details, smoothing boundaries, and separating or breaking apart connected regions in an image.</p>
<p>Erosion is often used in conjunction with other morphological operations, such as dilation, to achieve desired image processing effects and manipulate the shape and size of objects within an image.</p>
<p>Erosion is valuable in various applications, including noise reduction, object segmentation, feature extraction, and image analysis. It is particularly useful for removing small objects or thin structures, separating overlapping objects, and preparing images for further processing or analysis.</p>
<p>Here, <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/filtering.html?highlight=cv2.erode#erode">erode</a> function erodes the source image using the specified structuring element that determines the shape of a pixel neighborhood over which the minimum is taken (in <span class="xref myst">Dilation</span>, maximum is used instead!):</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} (x,y) =  \min _{(x',y'):  \, \texttt{element} (x',y') \ne0 } \texttt{src} (x+x',y+y')\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>cv2.dilate(src, kernel[, dst[, anchor[, iterations[, borderType[, borderValue]]]]]) → dst
</pre></div>
</div>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p>src – input image; the number of channels can be arbitrary, but the depth should be one of CV_8U, CV_16U, CV_16S, CV_32F` or ``CV_64F.</p></li>
<li><p>dst – output image of the same size and type as src.</p></li>
<li><p>element – structuring element used for erosion; if element=Mat() , a 3 x 3 rectangular structuring element is used.</p></li>
<li><p>anchor – position of the anchor within the element; default value (-1, -1) means that the anchor is at the element center.</p></li>
<li><p>iterations – number of times erosion is applied.</p></li>
<li><p>borderType – pixel extrapolation method.</p></li>
<li><p>borderValue – border value in case of a constant border.</p></li>
</ul>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Erosion&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">rows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Erosion&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Erosion</span>
<span class="n">IT</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IT</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Erosion after </span><span class="si">%s</span><span class="s1"> iteration&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Erosion after </span><span class="si">%s</span><span class="s1"> iterations&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span><span class="p">,</span> <span class="n">rows</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df2d631997dc24d092fa83473de53311d495b14f3b6b429454f4d48e9b8ccfac.png" src="_images/df2d631997dc24d092fa83473de53311d495b14f3b6b429454f4d48e9b8ccfac.png" />
</div>
</div>
<p>Let’s break down the code step by step:</p>
<ol class="arabic simple">
<li><p>Sample Image: The code initializes a NumPy array called <code class="docutils literal notranslate"><span class="pre">Img</span></code> with dimensions 800x1000x3, representing an image. The array is filled with zeros and has a data type of <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>.</p></li>
<li><p>Text and Font Properties: The variable <code class="docutils literal notranslate"><span class="pre">TXT</span></code> stores the text to be displayed on the image. The font face (<code class="docutils literal notranslate"><span class="pre">FF</span></code>) is set to <code class="docutils literal notranslate"><span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code>, the font thickness (<code class="docutils literal notranslate"><span class="pre">thickness</span></code>) is set to 20, and the font scale (<code class="docutils literal notranslate"><span class="pre">FS</span></code>) is set to 3.</p></li>
<li><p>Placing Text on the Image: The code calculates the size of the text using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code> and stores it in <code class="docutils literal notranslate"><span class="pre">(label_width,</span> <span class="pre">label_height)</span></code>. Then, it uses <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code> to place the text on the image three times with different colors and positions. The text is centered vertically and horizontally on the image.</p></li>
<li><p>Kernel Creation: A binary circular kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones()</span></code> and <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The kernel size is set to (11, 11), and it is filled with the color white (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>).</p></li>
<li><p>Create Subplots: The code creates subplots using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> with a total of <code class="docutils literal notranslate"><span class="pre">rows</span> <span class="pre">*</span> <span class="pre">1</span></code> rows and 2 columns. The <code class="docutils literal notranslate"><span class="pre">figsize</span></code> parameter sets the size of the figure to (17, rows * 6) units. The subplots are stored in the variables <code class="docutils literal notranslate"><span class="pre">fig</span></code> and <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p></li>
<li><p>Set Title: The code sets the main title of the figure as ‘Erosion’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>Display Original Image and Kernel: The code selects the first subplot (<code class="docutils literal notranslate"><span class="pre">ax[0]</span></code>) and displays the original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">ax[0].imshow()</span></code>. The title of the subplot is set to ‘Original Image’. Similarly, the second subplot (<code class="docutils literal notranslate"><span class="pre">ax[1]</span></code>) displays the kernel image using <code class="docutils literal notranslate"><span class="pre">ax[1].imshow()</span></code>, and its title is set to ‘Kernel’.</p></li>
<li><p>Perform Erosion and Display Results: The code enters a loop that iterates from 1 to <code class="docutils literal notranslate"><span class="pre">IT</span></code> (2 in this case). In each iteration, it applies the erosion operation to the image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">cv2.erode()</span></code> with the specified kernel and number of iterations (<code class="docutils literal notranslate"><span class="pre">i</span></code>). The resulting image (<code class="docutils literal notranslate"><span class="pre">Out</span></code>) is displayed in the corresponding subplot (<code class="docutils literal notranslate"><span class="pre">ax[i+1]</span></code>).</p></li>
<li><p>Set Subplot Titles: For each iteration, the code sets the title of the subplot based on the number of iterations using <code class="docutils literal notranslate"><span class="pre">inflect.engine().number_to_words()</span></code> to convert the iteration count to words. The titles are formatted as ‘Erosion after x iterations’ or ‘Erosion after y iteration’ for the first iteration.</p></li>
<li><p>Set Plot Properties: The code sets various properties for all subplots. It sets the aspect ratio to 1 and hides the axis.</p></li>
<li><p>Clean up: The variables <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">rows</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted from memory using the <code class="docutils literal notranslate"><span class="pre">del</span></code> statements.</p></li>
</ol>
<p>Note: To run this code successfully, you need to have the necessary libraries (NumPy, OpenCV, Matplotlib) imported and initialized correctly. Additionally, the code assumes that the <code class="docutils literal notranslate"><span class="pre">Colors</span></code> dictionary is defined with the desired color values.</p>
</div>
<div class="section" id="morphologyex">
<h2><span class="section-number">7.3. </span>morphologyEx<a class="headerlink" href="#morphologyex" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">morphologyEx</span></code> function in OpenCV provides a versatile way to apply various morphological transformations to an image. It allows us to perform operations like erosion, dilation, opening, closing, and more, using different types of structuring elements or kernels.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>cv2.morphologyEx(src, op, kernel[, dst[, anchor[, iterations[, borderType[, borderValue]]]]]) → dst
</pre></div>
</div>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p>src – Source image. The number of channels can be arbitrary. The depth should be one of CV_8U, CV_16U, CV_16S, CV_32F or CV_64F.</p></li>
<li><p>dst – Destination image of the same size and type as src .</p></li>
<li><p>element – Structuring element.</p></li>
<li><p>op – Type of a morphological operation that can be one of the following:</p>
<ul>
<li><p>MORPH_OPEN - an opening operation</p></li>
<li><p>MORPH_CLOSE - a closing operation</p></li>
<li><p>MORPH_GRADIENT - a morphological gradient</p></li>
<li><p>MORPH_TOPHAT - “top hat”</p></li>
<li><p>MORPH_BLACKHAT - “black hat”</p></li>
<li><p>MORPH_HITMISS - “hit and miss”</p></li>
</ul>
</li>
<li><p>iterations – Number of times erosion and dilation are applied.</p></li>
<li><p>borderType – Pixel extrapolation method. See borderInterpolate() for details.</p></li>
<li><p>borderValue – Border value in case of a constant border. The default value has a special meaning.</p></li>
</ul>
<div class="section" id="opening-operation">
<h3><span class="section-number">7.3.1. </span>Opening Operation<a class="headerlink" href="#opening-operation" title="Permalink to this headline">#</a></h3>
<p>It is obtained by the erosion of an image followed by a dilation.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{open} ( \texttt{src} , \texttt{element} )= \mathrm{dilate} ( \mathrm{erode} ( \texttt{src} , \texttt{element} ))\]</div>
<p>This is useful for removing small objects.</p>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Opening&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Opening Operation&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Opening Operation</span>

<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_OPEN</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Opening Operation&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dd7d590c0d6cbd576a0fcde3e7ebf63ca3fbb2758e33b62263b219d22905110e.png" src="_images/dd7d590c0d6cbd576a0fcde3e7ebf63ca3fbb2758e33b62263b219d22905110e.png" />
</div>
</div>
<p>Let’s break down the code step by step:</p>
<ol class="arabic simple">
<li><p>Sample Image: The code initializes a NumPy array called <code class="docutils literal notranslate"><span class="pre">Img</span></code> with dimensions 800x1000x3, representing an image. The array is filled with zeros and has a data type of <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>.</p></li>
<li><p>Text and Font Properties: The variable <code class="docutils literal notranslate"><span class="pre">TXT</span></code> stores the text to be displayed on the image. The font face (<code class="docutils literal notranslate"><span class="pre">FF</span></code>) is set to <code class="docutils literal notranslate"><span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code>, the font thickness (<code class="docutils literal notranslate"><span class="pre">thickness</span></code>) is set to 8, and the font scale (<code class="docutils literal notranslate"><span class="pre">FS</span></code>) is set to 3.</p></li>
<li><p>Placing Text on the Image: The code calculates the size of the text using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code> and stores it in <code class="docutils literal notranslate"><span class="pre">(label_width,</span> <span class="pre">label_height)</span></code>. Then, it uses <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code> to place the text on the image three times with different colors and positions. The text is centered vertically and horizontally on the image.</p></li>
<li><p>Kernel Creation: A binary circular kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones()</span></code> and <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The kernel size is set to (11, 11), and it is filled with the color white (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>).</p></li>
<li><p>Create Subplots: The code creates subplots using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> with 1 row and 3 columns. The <code class="docutils literal notranslate"><span class="pre">figsize</span></code> parameter sets the size of the figure to (18, 6) units. The subplots are stored in the variables <code class="docutils literal notranslate"><span class="pre">fig</span></code> and <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p></li>
<li><p>Set Title: The code sets the main title of the figure as ‘Opening Operation’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>Display Original Image and Kernel: The code selects the first subplot (<code class="docutils literal notranslate"><span class="pre">ax[0]</span></code>) and displays the original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">ax[0].imshow()</span></code>. The title of the subplot is set to ‘Original Image’. Similarly, the second subplot (<code class="docutils literal notranslate"><span class="pre">ax[1]</span></code>) displays the kernel image using <code class="docutils literal notranslate"><span class="pre">ax[1].imshow()</span></code>, and its title is set to ‘Kernel’.</p></li>
<li><p>Perform Opening Operation and Display Result: The code applies the opening operation to the image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx()</span></code> with the operation type <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_OPEN</span></code> and the specified kernel. The resulting image (<code class="docutils literal notranslate"><span class="pre">Out</span></code>) is displayed in the third subplot (<code class="docutils literal notranslate"><span class="pre">ax[2]</span></code>), and its title is set to ‘Opening Operation’.</p></li>
<li><p>Set Subplot Properties: The code sets various properties for all subplots. It sets the aspect ratio to 1 and hides the axis.</p></li>
<li><p>Clean up: The variables <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted from memory using the <code class="docutils literal notranslate"><span class="pre">del</span></code> statements.</p></li>
</ol>
<p>Note: To run this code successfully, you need to have the necessary libraries (NumPy, OpenCV, Matplotlib) imported and initialized correctly. Additionally, the code assumes that the <code class="docutils literal notranslate"><span class="pre">Colors</span></code> dictionary is defined with the desired color values.</p>
</div>
<div class="section" id="closing-operation">
<h3><span class="section-number">7.3.2. </span>Closing Operation<a class="headerlink" href="#closing-operation" title="Permalink to this headline">#</a></h3>
<p>It is obtained by the dilation of an image followed by an erosion.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{close} ( \texttt{src} , \texttt{element} )= \mathrm{erode} ( \mathrm{dilate} ( \texttt{src} , \texttt{element} ))\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Closing&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Closing Operation&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Closing Operation</span>

<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Closing Operation&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8c336f73065f9c9ea015688674b5bfcedf1bbf4d3f90fef587845a5e05aee5d4.png" src="_images/8c336f73065f9c9ea015688674b5bfcedf1bbf4d3f90fef587845a5e05aee5d4.png" />
</div>
</div>
<p>Let’s go through it step by step:</p>
<ol class="arabic simple">
<li><p>First, an image <code class="docutils literal notranslate"><span class="pre">Img</span></code> is created with dimensions (800, 1000, 3) and data type <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>. This image is initially filled with zeros, representing a black image.</p></li>
<li><p>The text to be displayed on the image is set as <code class="docutils literal notranslate"><span class="pre">TXT</span> <span class="pre">=</span> <span class="pre">'Closing'</span></code>.</p></li>
<li><p>The font properties such as font face, thickness, and scale are defined using the OpenCV constants. <code class="docutils literal notranslate"><span class="pre">FF</span> <span class="pre">=</span> <span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code> represents the font face, <code class="docutils literal notranslate"><span class="pre">thickness</span> <span class="pre">=</span> <span class="pre">8</span></code> sets the thickness of the text, and <code class="docutils literal notranslate"><span class="pre">FS</span> <span class="pre">=</span> <span class="pre">3</span></code> determines the font scale.</p></li>
<li><p>The size of the text is calculated using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code>. This function returns the size of the text string <code class="docutils literal notranslate"><span class="pre">TXT</span></code> when rendered with the specified font properties.</p></li>
<li><p>The text is rendered on the image using <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code>. Three instances of the text are added at different vertical positions on the image, each with a different color. The positions are calculated based on the image size and the text size.</p></li>
<li><p>The font properties and other variables (<code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">thickness</span></code>, <code class="docutils literal notranslate"><span class="pre">FS</span></code>, <code class="docutils literal notranslate"><span class="pre">label_width</span></code>, <code class="docutils literal notranslate"><span class="pre">label_height</span></code>) are deleted from memory to clean up.</p></li>
<li><p>A kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones((11,</span> <span class="pre">11),</span> <span class="pre">np.uint8)</span></code>. This kernel represents a square-shaped structuring element with a size of 11x11 pixels, filled with ones.</p></li>
<li><p>A circular region is created in the center of the kernel using <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The circle is filled with white color (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>) and has a radius of <code class="docutils literal notranslate"><span class="pre">min(kernel.shape)/2</span> <span class="pre">-</span> <span class="pre">min(kernel.shape)/10</span></code>, which is slightly smaller than half the size of the kernel. This circular region defines the morphology operation to be performed.</p></li>
<li><p>A matplotlib figure with three subplots is created using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>. The figure size is set to (18, 6), and the subplots are arranged in a single row.</p></li>
<li><p>The title of the figure is set as ‘Closing Operation’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>The original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) and the kernel are displayed in the first and second subplots, respectively, using <code class="docutils literal notranslate"><span class="pre">ax[i].imshow()</span></code>.</p></li>
<li><p>The closing operation is performed on the image using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx()</span></code> with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_CLOSE</span></code> flag. The result is stored in the <code class="docutils literal notranslate"><span class="pre">Out</span></code> variable.</p></li>
<li><p>The resulting image from the closing operation is displayed in the third subplot.</p></li>
<li><p>For each subplot, the aspect ratio is set to 1 and the axes are turned off using <code class="docutils literal notranslate"><span class="pre">ax[i].set_aspect(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">ax[i].axis('off')</span></code>.</p></li>
<li><p>Finally, the variables <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted to clean up memory.</p></li>
</ol>
<p>Overall, this code generates a figure showing the original image, the kernel used for the closing operation, and the resulting image after applying the closing operation.</p>
</div>
<div class="section" id="morphological-gradient">
<h3><span class="section-number">7.3.3. </span>Morphological Gradient<a class="headerlink" href="#morphological-gradient" title="Permalink to this headline">#</a></h3>
<p>It is the difference between the dilation and the erosion of an image.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{morph\_grad} ( \texttt{src} , \texttt{element} )= \mathrm{dilate} ( \texttt{src} , \texttt{element} )- \mathrm{erode} ( \texttt{src} , \texttt{element} )\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Morph. Gradient&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Morphological Gradient&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Morphological Gradient</span>

<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_GRADIENT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Morphological Gradient&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/20ab2882a410bcd19066adb073e22a8e8d92e13c89d9df7d22bf2c0074873a40.png" src="_images/20ab2882a410bcd19066adb073e22a8e8d92e13c89d9df7d22bf2c0074873a40.png" />
</div>
</div>
<p>Let’s go through it step by step:</p>
<ol class="arabic simple">
<li><p>First, an image <code class="docutils literal notranslate"><span class="pre">Img</span></code> is created with dimensions (800, 1000, 3) and data type <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>. This image is initially filled with zeros, representing a black image.</p></li>
<li><p>The text to be displayed on the image is set as <code class="docutils literal notranslate"><span class="pre">TXT</span> <span class="pre">=</span> <span class="pre">'Morph.</span> <span class="pre">Gradient'</span></code>.</p></li>
<li><p>The font properties such as font face, thickness, and scale are defined using the OpenCV constants. <code class="docutils literal notranslate"><span class="pre">FF</span> <span class="pre">=</span> <span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code> represents the font face, <code class="docutils literal notranslate"><span class="pre">thickness</span> <span class="pre">=</span> <span class="pre">8</span></code> sets the thickness of the text, and <code class="docutils literal notranslate"><span class="pre">FS</span> <span class="pre">=</span> <span class="pre">3</span></code> determines the font scale.</p></li>
<li><p>The size of the text is calculated using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code>. This function returns the size of the text string <code class="docutils literal notranslate"><span class="pre">TXT</span></code> when rendered with the specified font properties.</p></li>
<li><p>The text is rendered on the image using <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code>. Three instances of the text are added at different vertical positions on the image, each with a different color. The positions are calculated based on the image size and the text size.</p></li>
<li><p>The font properties and other variables (<code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">thickness</span></code>, <code class="docutils literal notranslate"><span class="pre">FS</span></code>, <code class="docutils literal notranslate"><span class="pre">label_width</span></code>, <code class="docutils literal notranslate"><span class="pre">label_height</span></code>) are deleted from memory to clean up.</p></li>
<li><p>A kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones((11,</span> <span class="pre">11),</span> <span class="pre">np.uint8)</span></code>. This kernel represents a square-shaped structuring element with a size of 11x11 pixels, filled with ones.</p></li>
<li><p>A circular region is created in the center of the kernel using <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The circle is filled with white color (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>) and has a radius of <code class="docutils literal notranslate"><span class="pre">min(kernel.shape)/2</span> <span class="pre">-</span> <span class="pre">min(kernel.shape)/10</span></code>, which is slightly smaller than half the size of the kernel. This circular region defines the morphology operation to be performed.</p></li>
<li><p>A matplotlib figure with three subplots is created using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>. The figure size is set to (18, 6), and the subplots are arranged in a single row.</p></li>
<li><p>The title of the figure is set as ‘Morphological Gradient’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>The original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) and the kernel are displayed in the first and second subplots, respectively, using <code class="docutils literal notranslate"><span class="pre">ax[i].imshow()</span></code>.</p></li>
<li><p>The morphological gradient operation is performed on the image using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx()</span></code> with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_GRADIENT</span></code> flag. The result is stored in the <code class="docutils literal notranslate"><span class="pre">Out</span></code> variable.</p></li>
<li><p>The resulting image from the morphological gradient operation is displayed in the third subplot.</p></li>
<li><p>For each subplot, the aspect ratio is set to 1, and the axes are turned off using <code class="docutils literal notranslate"><span class="pre">ax[i].set_aspect(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">ax[i].axis('off')</span></code>.</p></li>
<li><p>Finally, the variable <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted to clean up memory.</p></li>
</ol>
<p>Overall, this code generates a figure showing the original image, the kernel used for the morphological gradient operation, and the resulting image after applying the morphological gradient operation.</p>
</div>
<div class="section" id="top-hat">
<h3><span class="section-number">7.3.4. </span>Top Hat<a class="headerlink" href="#top-hat" title="Permalink to this headline">#</a></h3>
<p>It is the difference between an input image and its opening.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{tophat} ( \texttt{src} , \texttt{element} )= \texttt{src} - \mathrm{open} ( \texttt{src} , \texttt{element} )\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Top Hat&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Top Hat&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Top Hat</span>

<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top Hat&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/961371a98c8efb93c19d73e07c04176db34c94e7fae027092428d6a2aa08eace.png" src="_images/961371a98c8efb93c19d73e07c04176db34c94e7fae027092428d6a2aa08eace.png" />
</div>
</div>
<p>Let’s break it down step by step:</p>
<ol class="arabic simple">
<li><p>An image <code class="docutils literal notranslate"><span class="pre">Img</span></code> is created with dimensions (800, 1000, 3) and data type <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>. This image is initially filled with zeros, representing a black image.</p></li>
<li><p>The text to be displayed on the image is set as <code class="docutils literal notranslate"><span class="pre">TXT</span> <span class="pre">=</span> <span class="pre">'Top</span> <span class="pre">Hat'</span></code>.</p></li>
<li><p>The font properties such as font face, thickness, and scale are defined using the OpenCV constants. <code class="docutils literal notranslate"><span class="pre">FF</span> <span class="pre">=</span> <span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code> represents the font face, <code class="docutils literal notranslate"><span class="pre">thickness</span> <span class="pre">=</span> <span class="pre">8</span></code> sets the thickness of the text, and <code class="docutils literal notranslate"><span class="pre">FS</span> <span class="pre">=</span> <span class="pre">3</span></code> determines the font scale.</p></li>
<li><p>The size of the text is calculated using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code>. This function returns the size of the text string <code class="docutils literal notranslate"><span class="pre">TXT</span></code> when rendered with the specified font properties.</p></li>
<li><p>The text is rendered on the image using <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code>. Three instances of the text are added at different vertical positions on the image, each with a different color. The positions are calculated based on the image size and the text size.</p></li>
<li><p>The font properties and other variables (<code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">thickness</span></code>, <code class="docutils literal notranslate"><span class="pre">FS</span></code>, <code class="docutils literal notranslate"><span class="pre">label_width</span></code>, <code class="docutils literal notranslate"><span class="pre">label_height</span></code>) are deleted from memory to clean up.</p></li>
<li><p>A kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones((11,</span> <span class="pre">11),</span> <span class="pre">np.uint8)</span></code>. This kernel represents a square-shaped structuring element with a size of 11x11 pixels, filled with ones.</p></li>
<li><p>A circular region is created in the center of the kernel using <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The circle is filled with white color (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>) and has a radius of <code class="docutils literal notranslate"><span class="pre">min(kernel.shape)/2</span> <span class="pre">-</span> <span class="pre">min(kernel.shape)/10</span></code>, which is slightly smaller than half the size of the kernel. This circular region defines the morphology operation to be performed.</p></li>
<li><p>A matplotlib figure with three subplots is created using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>. The figure size is set to (18, 6), and the subplots are arranged in a single row.</p></li>
<li><p>The title of the figure is set as ‘Top Hat’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>The original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) and the kernel are displayed in the first and second subplots, respectively, using <code class="docutils literal notranslate"><span class="pre">ax[i].imshow()</span></code>.</p></li>
<li><p>The top hat operation is performed on the image using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx()</span></code> with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_TOPHAT</span></code> flag. The result is stored in the <code class="docutils literal notranslate"><span class="pre">Out</span></code> variable.</p></li>
<li><p>The resulting image from the top hat operation is displayed in the third subplot.</p></li>
<li><p>For each subplot, the aspect ratio is set to 1, and the axes are turned off using <code class="docutils literal notranslate"><span class="pre">ax[i].set_aspect(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">ax[i].axis('off')</span></code>.</p></li>
<li><p>Finally, the variable <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted to clean up memory.</p></li>
</ol>
<p>In summary, this code generates a figure showing the original image, the kernel used for the top hat operation, and the resulting image after applying the top hat operation.</p>
</div>
<div class="section" id="black-hat">
<h3><span class="section-number">7.3.5. </span>Black Hat<a class="headerlink" href="#black-hat" title="Permalink to this headline">#</a></h3>
<p>It is the difference between the closing of the input image and input image.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{blackhat} ( \texttt{src} , \texttt{element} )= \mathrm{close} ( \texttt{src} , \texttt{element} )- \texttt{src}\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Black Hat&#39;</span>
<span class="c1">#### FontFace</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>
<span class="c1">#### Font thickness</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#### Font Scale</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="n">FS</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">TXT</span><span class="p">,</span> <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">label_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span> <span class="o">=</span> <span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span><span class="p">)</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Black Hat&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">## Black Hat</span>

<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Black Hat&#39;</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">del</span> <span class="n">i</span>
<span class="k">del</span> <span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0deacb5c3e72e7eceb17bcfb4606909b12da9e9e367cf9bfac0ab94eed60a8b7.png" src="_images/0deacb5c3e72e7eceb17bcfb4606909b12da9e9e367cf9bfac0ab94eed60a8b7.png" />
</div>
</div>
<p>Let’s go through it step by step:</p>
<ol class="arabic simple">
<li><p>An image <code class="docutils literal notranslate"><span class="pre">Img</span></code> is created with dimensions (800, 1000, 3) and data type <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>. Initially, the image is filled with zeros, representing a black image.</p></li>
<li><p>The text to be displayed on the image is set as <code class="docutils literal notranslate"><span class="pre">TXT</span> <span class="pre">=</span> <span class="pre">'Black</span> <span class="pre">Hat'</span></code>.</p></li>
<li><p>The font properties such as font face, thickness, and scale are defined using the OpenCV constants. <code class="docutils literal notranslate"><span class="pre">FF</span> <span class="pre">=</span> <span class="pre">cv2.FONT_HERSHEY_TRIPLEX</span></code> represents the font face, <code class="docutils literal notranslate"><span class="pre">thickness</span> <span class="pre">=</span> <span class="pre">8</span></code> sets the thickness of the text, and <code class="docutils literal notranslate"><span class="pre">FS</span> <span class="pre">=</span> <span class="pre">3</span></code> determines the font scale.</p></li>
<li><p>The size of the text is calculated using <code class="docutils literal notranslate"><span class="pre">cv2.getTextSize()</span></code>. This function returns the size of the text string <code class="docutils literal notranslate"><span class="pre">TXT</span></code> when rendered with the specified font properties.</p></li>
<li><p>The text is rendered on the image using <code class="docutils literal notranslate"><span class="pre">cv2.putText()</span></code>. Three instances of the text are added at different vertical positions on the image, each with a different color. The positions are calculated based on the image size and the text size.</p></li>
<li><p>The font properties and other variables (<code class="docutils literal notranslate"><span class="pre">FF</span></code>, <code class="docutils literal notranslate"><span class="pre">thickness</span></code>, <code class="docutils literal notranslate"><span class="pre">FS</span></code>, <code class="docutils literal notranslate"><span class="pre">label_width</span></code>, <code class="docutils literal notranslate"><span class="pre">label_height</span></code>) are deleted from memory to clean up.</p></li>
<li><p>A kernel is created using <code class="docutils literal notranslate"><span class="pre">np.ones((11,</span> <span class="pre">11),</span> <span class="pre">np.uint8)</span></code>. This kernel represents a square-shaped structuring element with a size of 11x11 pixels, filled with ones.</p></li>
<li><p>A circular region is created in the center of the kernel using <code class="docutils literal notranslate"><span class="pre">cv2.circle()</span></code>. The circle is filled with white color (<code class="docutils literal notranslate"><span class="pre">Colors['White']</span></code>) and has a radius of <code class="docutils literal notranslate"><span class="pre">min(kernel.shape)/2</span> <span class="pre">-</span> <span class="pre">min(kernel.shape)/10</span></code>, which is slightly smaller than half the size of the kernel. This circular region defines the morphology operation to be performed.</p></li>
<li><p>A matplotlib figure with three subplots is created using <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>. The figure size is set to (18, 6), and the subplots are arranged in a single row.</p></li>
<li><p>The title of the figure is set as ‘Black Hat’ using <code class="docutils literal notranslate"><span class="pre">fig.suptitle()</span></code>.</p></li>
<li><p>The original image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) and the kernel are displayed in the first and second subplots, respectively, using <code class="docutils literal notranslate"><span class="pre">ax[i].imshow()</span></code>.</p></li>
<li><p>The black hat operation is performed on the image using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx()</span></code> with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_BLACKHAT</span></code> flag. The result is stored in the <code class="docutils literal notranslate"><span class="pre">Out</span></code> variable.</p></li>
<li><p>The resulting image from the black hat operation is displayed in the third subplot.</p></li>
<li><p>For each subplot, the aspect ratio is set to 1, and the axes are turned off using <code class="docutils literal notranslate"><span class="pre">ax[i].set_aspect(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">ax[i].axis('off')</span></code>.</p></li>
<li><p>Finally, the variable <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">Img</span></code>, <code class="docutils literal notranslate"><span class="pre">Out</span></code>, <code class="docutils literal notranslate"><span class="pre">ax</span></code>, and <code class="docutils literal notranslate"><span class="pre">fig</span></code> are deleted to clean up memory.</p></li>
</ol>
<p>In summary, this code generates a figure showing the original image, the kernel used for the black hat operation, and the resulting image after applying the black hat operation.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="refrences">
<h2><span class="section-number">7.4. </span>Refrences<a class="headerlink" href="#refrences" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://docs.opencv.org/2.4/index.html">OpenCV documentation</a></p></li>
<li><p><a class="reference external" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_morphological_ops/py_morphological_ops.html#morphological-transformations">Morphological Transformations</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Structuring_element">Structuring element</a></p></li>
</ol>
<hr class="docutils" />
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Image_Filtering.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Image Filtering</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dilation">7.1. Dilation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#erosion">7.2. Erosion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphologyex">7.3. morphologyEx</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-operation">7.3.1. Opening Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-operation">7.3.2. Closing Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morphological-gradient">7.3.3. Morphological Gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#top-hat">7.3.4. Top Hat</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#black-hat">7.3.5. Black Hat</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refrences">7.4. Refrences</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>