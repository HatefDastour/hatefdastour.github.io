

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6. Morphological Transformations &#8212; Computer Vision</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'CV_C6';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. References" href="References.html" />
    <link rel="prev" title="5. Image Filtering" href="CV_C5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Getting_Started.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computer Vision - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Computer Vision - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="CV_C1.html">1. Getting Started with OpenCV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CV_C2.html">2. Geometric Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="CV_C3.html">3. Drawing Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="CV_C4.html">4. Image Thresholding</a></li>
<li class="toctree-l1"><a class="reference internal" href="CV_C5.html">5. Image Filtering</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Morphological Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html">7. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Morphological Transformations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dilation">6.1. Dilation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphologyex">6.2. morphologyEx</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-operation">6.2.1. Opening Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-operation">6.2.2. Closing Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morphological-gradient">6.2.3. Morphological Gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#top-hat">6.2.4. Top Hat</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#black-hat">6.2.5. Black Hat</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="morphological-transformations">
<h1><span class="section-number">6. </span>Morphological Transformations<a class="headerlink" href="#morphological-transformations" title="Permalink to this heading">#</a></h1>
<p>Morphological operations are image processing techniques that involve the use of a structuring element to analyze the relationship between shapes in an image. The two fundamental morphological operations are erosion and dilation, which can be used for various purposes including:</p>
<ol class="arabic simple">
<li><p>Noise reduction: Erosion can help in reducing noise or small artifacts in an image by shrinking the boundaries of regions and smoothing out irregularities. It removes isolated pixels or small clusters that do not match the shape of the structuring element.</p></li>
<li><p>Isolation of individual elements and joining disparate elements: Dilation expands the boundaries of regions in an image, which can be useful for joining broken or disconnected parts of an object. It can help in closing small gaps between objects or filling in missing regions.</p></li>
<li><p>Detection of intensity bumps or holes: By performing erosion and dilation operations in combination, morphological operations can be used to detect and analyze the presence of intensity bumps or holes in an image. Erosion followed by dilation (closing operation) can fill in small holes or gaps, while dilation followed by erosion (opening operation) can separate or isolate individual intensity bumps.</p></li>
</ol>
<p>These morphological operations play a significant role in various image processing tasks, including image enhancement, segmentation, feature extraction, and object recognition. They provide a powerful set of tools for modifying and analyzing the structure of images based on the shapes and relationships within them.</p>
<div class="section" id="dilation">
<h2><span class="section-number">6.1. </span>Dilation<a class="headerlink" href="#dilation" title="Permalink to this heading">#</a></h2>
<p>Dilation is a fundamental operation in morphological image processing, involving the application of a kernel or structuring element to an image. This kernel, represented as a small matrix, has a designated anchor point, typically located at its center <span id="id1">[<a class="reference internal" href="References.html#id25" title="G. Bradski. The OpenCV Library. Dr. Dobb's Journal of Software Tools, 2000.">Bradski, 2000</a>, <a class="reference internal" href="References.html#id26" title="OpenCV Developers. Opencv documentation. https://docs.opencv.org/4.x/index.html, 2023. [Online; accessed 01-August-2023].">OpenCV Developers, 2023</a>]</span>.</p>
<p>During dilation, the kernel’s center is placed on each pixel of the input image, and the kernel’s values are compared to the corresponding pixels in the local neighborhood around the anchor point. The output pixel value is determined by selecting the maximum value among the kernel elements that overlap with this neighborhood.</p>
<p>The result of dilation is the expansion or “growth” of regions within the image, as the maximum pixel value within the neighborhood becomes the new value for the central pixel. This process enhances or enlarges bright areas or regions in the image. Dilation is often used alongside other morphological operations like erosion to achieve specific image processing effects, enabling manipulation of object shapes and sizes within the image.</p>
<p>Dilation serves a crucial role in various applications, including image enhancement, edge detection, feature extraction, and object recognition. It is particularly useful for tasks such as filling small gaps, connecting fragmented parts, and thickening or enlarging object boundaries within an image.</p>
<p>In the context of OpenCV, image dilation can be performed using the <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/filtering.html?highlight=cv2.erode#dilate">dilate</a> function. This function dilates the source image using a specified structuring element, defining the shape of the pixel neighborhood. The maximum value is determined based on the following equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-65fe763e-eb91-4c03-bd06-bb2df04e24cb">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-65fe763e-eb91-4c03-bd06-bb2df04e24cb" title="Permalink to this equation">#</a></span>\[\begin{equation}
\texttt{dst} (x, y) = \max _{(x', y'): \, \texttt{element} (x', y') \ne0 } \texttt{src} (x + x', y + y')
\end{equation}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cv2.dilate</span></code> function in Python is part of the OpenCV library and is used for image dilation, which is a morphological operation that enlarges the white regions (foreground) in a binary image. Here’s a refined explanation of the function signature <span id="id2">[<a class="reference internal" href="References.html#id25" title="G. Bradski. The OpenCV Library. Dr. Dobb's Journal of Software Tools, 2000.">Bradski, 2000</a>, <a class="reference internal" href="References.html#id26" title="OpenCV Developers. Opencv documentation. https://docs.opencv.org/4.x/index.html, 2023. [Online; accessed 01-August-2023].">OpenCV Developers, 2023</a>]</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cv2.dilate(src, kernel[, dst[, anchor[, iterations[, borderType[, borderValue]]]]]) → dst
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: This is the input image, which should be a binary image with white (255) and black (0) regions. It’s the image on which the dilation operation will be performed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernel</span></code>: This is the structuring element used for dilation. It defines the shape and size of the neighborhood around each pixel in the source image. The dilation operation will use this kernel to determine how the white regions are expanded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst</span></code>: This is the output image, which will contain the result of the dilation operation. It has the same size and type as the input image.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anchor</span></code>: This is a reference point within the kernel. The default value (-1, -1) indicates that the anchor is at the center of the kernel. This point is used to align the kernel with the source image during the dilation operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterations</span></code>: This parameter specifies the number of times the dilation operation will be applied. Each iteration further expands the white regions in the image.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">borderType</span></code>: This parameter determines how the border pixels are handled. Common border types include <code class="docutils literal notranslate"><span class="pre">cv2.BORDER_CONSTANT</span></code>, <code class="docutils literal notranslate"><span class="pre">cv2.BORDER_REPLICATE</span></code>, <code class="docutils literal notranslate"><span class="pre">cv2.BORDER_REFLECT</span></code>, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">borderValue</span></code>: If the borderType is <code class="docutils literal notranslate"><span class="pre">cv2.BORDER_CONSTANT</span></code>, this parameter sets the value to be used for border pixels.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">→</span> <span class="pre">dst</span></code>: This indicates that the function returns the output image (<code class="docutils literal notranslate"><span class="pre">dst</span></code>) after applying the dilation operation.</p></li>
</ul>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">import</span> <span class="nn">inflect</span>

<span class="c1"># Set global font properties for Matplotlib plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>

<span class="c1"># Define color dictionary</span>
<span class="n">Colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;White&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="s1">&#39;Black&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Red&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Green&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Blue&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)}</span>

<span class="c1"># Create a blank sample image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Dilation&#39;</span>

<span class="c1"># Define font parameters</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>  <span class="c1"># FontFace</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Font thickness</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Font Scale</span>

<span class="c1"># Measure text size for positioning</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay text in different colors and positions on the image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up variables</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1"># Create a kernel for dilation</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1"># Set up subplots for visualization</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Dilate&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Perform image dilation and visualize the results</span>
<span class="n">IT</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Number of dilation iterations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IT</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
    <span class="c1"># Set titles for each dilation iteration</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iteration&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iterations&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1d7bb02339a76b298a0edb65eabf9b81ffd663b543bd598366dcea6a29154203.png" src="_images/1d7bb02339a76b298a0edb65eabf9b81ffd663b543bd598366dcea6a29154203.png" />
</div>
</div>
<p>This code demonstrates the concept of image dilation using OpenCV and Matplotlib for visualization. Here’s a brief overview of what the code does:</p>
<ol class="arabic simple">
<li><p><strong>Importing Libraries</strong>: The code imports necessary libraries, including NumPy, OpenCV (cv2), Matplotlib (plt), a font manager for text rendering, and an inflection library (inflect) for converting numbers to words.</p></li>
<li><p><strong>Setting Plot Font Properties</strong>: Adjusts global font properties for Matplotlib plots, setting the font family to Calibri and the title size to 16.</p></li>
<li><p><strong>Sample Image</strong>: Creates a blank sample image (800x1000 pixels) and defines color values in a dictionary named “Colors.” The sample image is initialized as a black image.</p></li>
<li><p><strong>Text Overlay</strong>: Adds the text “Dilation” to the sample image in three different colors (Red, Green, and Blue) with variations in positioning and sizes. This demonstrates text overlay using OpenCV.</p></li>
<li><p><strong>Kernel Creation</strong>: Defines a kernel for dilation as a 2D array of ones with a specified size (11x11). A circular region is carved out in the center of the kernel, creating a circular structuring element.</p></li>
<li><p><strong>Plots</strong>: Prepares a 3x2 grid of subplots using Matplotlib for visualizing the following:</p>
<ul class="simple">
<li><p>The original image with overlaid text (in different colors).</p></li>
<li><p>The kernel used for dilation.</p></li>
</ul>
</li>
<li><p><strong>Dilation Visualization</strong>: Performs image dilation on the original image using the created kernel. The code iteratively shows the result of dilation after different numbers of iterations (1 to 4), each time updating the subplot.</p></li>
<li><p><strong>Plot Settings</strong>: Adjusts plot aspects (aspect ratio) and turns off axis labels for better visualization.</p></li>
</ol>
<p>Erosion is a fundamental morphological operation used in image processing. It involves the application of a small matrix called a kernel or structuring element to the input image. This kernel has an anchor point, typically at its center, and is convolved over the image.</p>
<p>During the erosion operation:</p>
<ul class="simple">
<li><p>The kernel’s center is placed on each pixel in the input image.</p></li>
<li><p>The values of the kernel are compared to the corresponding pixels in the neighborhood around the current pixel.</p></li>
<li><p>The output pixel value is determined by finding the minimum value among the kernel elements that overlap with the neighborhood.</p></li>
</ul>
<p>This process causes regions in the image to shrink or erode, as the minimum pixel value in the neighborhood becomes the new value for the central pixel. Erosion is useful for:</p>
<ul class="simple">
<li><p>Removing small details and noise from an image.</p></li>
<li><p>Smoothing boundaries and separating or breaking apart connected regions.</p></li>
<li><p>Preparing images for further processing or analysis.</p></li>
</ul>
<p>The <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/filtering.html?highlight=cv2.erode#erode">erode</a> function in OpenCV performs erosion using a specified structuring element, which defines the shape of the pixel neighborhood for minimum value extraction. It operates according to the following equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8091b2de-e080-4276-af06-ccd18c9cb354">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-8091b2de-e080-4276-af06-ccd18c9cb354" title="Permalink to this equation">#</a></span>\[\begin{equation}
\texttt{dst}(x, y) = \min_{(x', y'): \, \texttt{element}(x', y') \neq 0} \texttt{src}(x + x', y + y')
\end{equation}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\texttt{dst}(x, y)\)</span> is the output pixel value.</p></li>
<li><p><span class="math notranslate nohighlight">\(\texttt{element}(x', y')\)</span> represents the structuring element’s value at position <span class="math notranslate nohighlight">\((x', y')\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\texttt{src}(x + x', y + y')\)</span> denotes the corresponding pixel value in the neighborhood of the current pixel.</p></li>
</ul>
<p>This function is an essential tool for various image processing tasks, including noise reduction, object segmentation, feature extraction, and image analysis. It complements other morphological operations like dilation, providing valuable control over the shape and size of objects within an image.</p>
<p>The Python function “cv2.erode()” is used for image erosion, a fundamental operation in computer vision and image processing. This function modifies an input image by removing the outer boundaries of objects within the image. The erosion process is achieved by convolving the input image with a specified kernel or structuring element.</p>
<p>Here’s a refined explanation of the function and its parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cv2.erode(src, kernel[, dst[, anchor[, iterations[, borderType[, borderValue]]]]]) → dst
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: The input image (source image) on which the erosion operation will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernel</span></code>: The structuring element used for the erosion. This defines the shape and size of the neighborhood around each pixel. It specifies the pattern used for removing pixels based on their local arrangement.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst</span></code> (optional): The output image where the result of the erosion operation will be stored. If not provided, the function creates a new image for the result.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anchor</span></code> (optional): The anchor point within the kernel. It indicates which pixel of the kernel corresponds to the central pixel of the neighborhood being processed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterations</span></code> (optional): The number of times the erosion operation is applied. If not specified, it defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">borderType</span></code> (optional): Specifies how to handle pixels near the border of the image. Common values include cv2.BORDER_CONSTANT, cv2.BORDER_REPLICATE, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">borderValue</span></code> (optional): The value assigned to the pixels in the border area if the “borderType” is set to cv2.BORDER_CONSTANT.</p></li>
</ul>
<p>The function returns the resulting image after applying the erosion operation. The erosion operation reduces the size of the foreground objects and eliminates small details while preserving the overall structure of the objects in the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">import</span> <span class="nn">inflect</span>

<span class="c1"># Set global font properties for Matplotlib plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>

<span class="c1"># Define color dictionary</span>
<span class="n">Colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;White&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="s1">&#39;Black&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Red&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Green&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Blue&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)}</span>

<span class="c1"># Create a blank sample image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Dilation&#39;</span>

<span class="c1"># Define font parameters</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>  <span class="c1"># FontFace</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Font thickness</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Font Scale</span>

<span class="c1"># Measure text size for positioning</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay text in different colors and positions on the image</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up variables</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1"># Create a kernel for dilation</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1"># Set up subplots for visualization</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Dilate&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Perform image dilation and visualize the results</span>
<span class="n">IT</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Number of dilation iterations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IT</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
    <span class="c1"># Set titles for each dilation iteration</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iteration&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dilation after </span><span class="si">%s</span><span class="s1"> iterations&#39;</span> <span class="o">%</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span><span class="o">.</span><span class="n">number_to_words</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                              <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1d7bb02339a76b298a0edb65eabf9b81ffd663b543bd598366dcea6a29154203.png" src="_images/1d7bb02339a76b298a0edb65eabf9b81ffd663b543bd598366dcea6a29154203.png" />
</div>
</div>
<p>This code is a concise explanation of how to use image processing operations, particularly dilation, with the help of Python libraries like OpenCV and Matplotlib. Here’s a breakdown of what each section does:</p>
<ol class="arabic simple">
<li><p><strong>Import Libraries:</strong> The code begins by importing the necessary libraries: <code class="docutils literal notranslate"><span class="pre">numpy</span></code> (for numerical operations), <code class="docutils literal notranslate"><span class="pre">cv2</span></code> (OpenCV for image processing), <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> (for visualization), <code class="docutils literal notranslate"><span class="pre">FontProperties</span></code> from <code class="docutils literal notranslate"><span class="pre">matplotlib.font_manager</span></code> (for controlling font properties), and <code class="docutils literal notranslate"><span class="pre">inflect</span></code> (for converting numbers to words).</p></li>
<li><p><strong>Set Font Properties:</strong> The code updates global font properties for Matplotlib plots, ensuring that the chosen font family and title size are consistent across the entire visualization.</p></li>
<li><p><strong>Define Color Dictionary:</strong> A dictionary called <code class="docutils literal notranslate"><span class="pre">Colors</span></code> is defined, mapping color names to RGB values.</p></li>
<li><p><strong>Create Sample Image:</strong> A blank image (<code class="docutils literal notranslate"><span class="pre">Img</span></code>) is created with dimensions 800x1000 and 3 channels (for RGB).</p></li>
<li><p><strong>Overlay Text on Image:</strong> The text “Dilation” is overlaid on the image with different colors and positions using OpenCV’s <code class="docutils literal notranslate"><span class="pre">putText</span></code> function. This creates a visual representation for the concept of dilation.</p></li>
<li><p><strong>Cleanup Variables:</strong> Temporary variables used for text positioning are deleted to free up memory.</p></li>
<li><p><strong>Create Dilation Kernel:</strong> A square kernel (11x11) with a circular white region in the center is created. This kernel will be used for the dilation operation. The circular region makes the dilation effect more visually intuitive.</p></li>
<li><p><strong>Set Up Subplots:</strong> Matplotlib subplots are prepared to display the original image, the dilation kernel, and the results of the dilation operation. The layout consists of three rows and two columns.</p></li>
<li><p><strong>Set Main Title:</strong> The entire figure is given a title “Dilate” using Matplotlib’s <code class="docutils literal notranslate"><span class="pre">suptitle</span></code> function.</p></li>
<li><p><strong>Display Original Image:</strong> The original image with the overlaid text is displayed in the first subplot.</p></li>
<li><p><strong>Display Kernel:</strong> The dilation kernel is shown in grayscale in the second subplot.</p></li>
<li><p><strong>Perform Dilation and Visualize Results:</strong> The code performs the dilation operation using OpenCV’s <code class="docutils literal notranslate"><span class="pre">dilate</span></code> function. The results of dilation after each iteration (up to 4 iterations) are displayed in subsequent subplots. The titles for each subplot describe the number of iterations.</p></li>
<li><p><strong>Adjust Subplot Appearance:</strong> The aspect ratio is set to 1 (to prevent distortion) and axis labels are turned off for all subplots.</p></li>
</ol>
</div>
<div class="section" id="morphologyex">
<h2><span class="section-number">6.2. </span>morphologyEx<a class="headerlink" href="#morphologyex" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">morphologyEx</span></code> function in OpenCV is a flexible tool that enables the application of diverse morphological operations to an image. This function empowers us to execute operations such as erosion, dilation, opening, closing, and others, utilizing a wide range of structuring elements or kernels.</p>
<p>Morphological operations are fundamental image processing techniques that focus on the shape and structure of objects within an image. These operations are particularly useful for tasks like noise reduction, edge enhancement, and object segmentation.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">morphologyEx</span></code> function, you can choose from various types of morphological operations and specify the structuring element that defines the local neighborhood around each pixel, determining the effect of the operation. This flexibility makes the function a valuable asset in various computer vision applications, enabling image enhancement and feature extraction.</p>
<p>Refine “cv.MorphologyEx” in Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cv.MorphologyEx(src, dst, temp, element, operation, iterations=1) → None
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cv.MorphologyEx</span></code> function in Python is part of the OpenCV library, which is widely used for computer vision and image processing tasks. This function is used to perform various morphological operations on an input image (<code class="docutils literal notranslate"><span class="pre">src</span></code>) and produce the result in the output image (<code class="docutils literal notranslate"><span class="pre">dst</span></code>). Morphological operations involve the manipulation of the shape and structure of objects within an image.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: The source image on which the morphological operation is to be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst</span></code>: The output image where the result of the morphological operation will be stored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">temp</span></code>: A temporary image used for intermediate calculations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span></code>: The structuring element used for the morphological operation. It defines the neighborhood around each pixel that is considered for the operation. This element can be created using functions like <code class="docutils literal notranslate"><span class="pre">cv.getStructuringElement</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operation</span></code>: The type of morphological operation to be performed. This can be one of the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_ERODE</span></code>: Erosion operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_DILATE</span></code>: Dilation operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_OPEN</span></code>: Opening operation (erosion followed by dilation).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_CLOSE</span></code>: Closing operation (dilation followed by erosion).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_GRADIENT</span></code>: Morphological gradient.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_TOPHAT</span></code>: Top-hat operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv.MORPH_BLACKHAT</span></code>: Black-hat operation.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterations</span></code>: The number of times the morphological operation is applied. Default is 1.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">cv.MorphologyEx</span></code> function is a powerful tool for enhancing or reducing certain features within an image, such as noise removal, edge detection, and object segmentation. It’s commonly used in various computer vision applications including image preprocessing, object detection, and image segmentation.</p>
<div class="section" id="opening-operation">
<h3><span class="section-number">6.2.1. </span>Opening Operation<a class="headerlink" href="#opening-operation" title="Permalink to this heading">#</a></h3>
<p>The “opening” operation is derived from the sequential application of erosion followed by dilation on an image.</p>
<p>Mathematically, the “opening” operation (<span class="math notranslate nohighlight">\( \text{dst} = \text{open}(\text{src}, \text{element}) \)</span>) can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-24ec0813-0e8a-44d9-b50a-79868794ebee">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-24ec0813-0e8a-44d9-b50a-79868794ebee" title="Permalink to this equation">#</a></span>\[\begin{equation}
\texttt{dst} = \mathrm{open} ( \texttt{src} , \texttt{element} )= \mathrm{dilate} ( \mathrm{erode} ( \texttt{src} , \texttt{element} ))
\end{equation} \]</div>
<p>The opening operation is particularly valuable for the elimination of small objects within an image. This process involves the initial erosion of the image, which reduces the size of foreground objects, followed by a dilation that slightly enlarges the objects while still keeping the removed small components eliminated during the erosion step. Consequently, the “opening” operation can effectively remove noise and minor variations from an image while preserving the larger, more significant structures.</p>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="c1"># Create a blank image with dimensions 800x1000 and 3 channels (RGB)</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Opening&#39;</span>

<span class="c1">#### FontFace</span>
<span class="c1"># Choose the font face for the text</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>

<span class="c1">#### Font thickness</span>
<span class="c1"># Set the thickness of the font</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1">#### Font Scale</span>
<span class="c1"># Choose the scale of the font</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Measure the text size for positioning</span>
<span class="c1"># (label_width, label_height) stores the size of the text</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay the text in different colors and positions on the image</span>
<span class="c1"># Color: Red</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Green</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Blue</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up font-related variables to free up memory</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="c1"># Create a square kernel with a circular white region in the center</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>
<span class="c1"># Set up subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Opening Operation&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1">## Opening Operation</span>
<span class="c1"># Perform the opening operation using the morphologyEx function with cv2.MORPH_OPEN</span>
<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_OPEN</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Display the result of the opening operation in the third subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Opening Operation&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8aafa326656bd0d8df63130ef4fa438d261f40addc321a817f0b4afc18bfda8a.png" src="_images/8aafa326656bd0d8df63130ef4fa438d261f40addc321a817f0b4afc18bfda8a.png" />
</div>
</div>
<p>This code snippet performs the “opening” morphological operation on a blank sample image with some text, and it visualizes the process using matplotlib subplots. Here’s a brief explanation:</p>
<ol class="arabic simple">
<li><p><strong>Sample Image:</strong> A blank image with dimensions 800x1000 and 3 channels (RGB) is created.</p></li>
<li><p><strong>Text Overlay:</strong> The text “Opening” is overlaid on the image in different colors (Red, Green, Blue) and positions.</p></li>
<li><p><strong>Kernel:</strong> A kernel (structured element) is created. It’s a square matrix with dimensions 11x11, and it has a circular white region in the center.</p></li>
<li><p><strong>Plots:</strong> Subplots are set up for visualization, with the original image displayed in the first subplot and the kernel shown in grayscale in the second subplot. The main title for the figure is set as “Opening Operation.”</p></li>
<li><p><strong>Opening Operation:</strong> The “opening” morphological operation is performed using <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx</span></code> with <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_OPEN</span></code>. The result is displayed in the third subplot.</p></li>
<li><p><strong>Aspect Ratio and Axis Labels:</strong> Aspect ratio is set to 1, and axis labels are turned off for all subplots.</p></li>
</ol>
</div>
<div class="section" id="closing-operation">
<h3><span class="section-number">6.2.2. </span>Closing Operation<a class="headerlink" href="#closing-operation" title="Permalink to this heading">#</a></h3>
<p>It is obtained by the dilation of an image followed by an erosion.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{close} ( \texttt{src} , \texttt{element} )= \mathrm{erode} ( \mathrm{dilate} ( \texttt{src} , \texttt{element} ))\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="c1"># Create a blank image with dimensions 800x1000 and 3 channels (RGB)</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Closing&#39;</span>

<span class="c1">#### FontFace</span>
<span class="c1"># Choose the font face for the text</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>

<span class="c1">#### Font thickness</span>
<span class="c1"># Set the thickness of the font</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1">#### Font Scale</span>
<span class="c1"># Choose the scale of the font</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Measure the text size for positioning</span>
<span class="c1"># (label_width, label_height) stores the size of the text</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay the text in different colors and positions on the image</span>
<span class="c1"># Color: Red</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Green</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Blue</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up font-related variables to free up memory</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1">## Kernel</span>
<span class="c1"># Create a square kernel with a circular white region in the center</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1">## Plots</span>
<span class="c1"># Set up subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Closing Operation&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1">## Closing Operation</span>
<span class="c1"># Perform the closing operation using the morphologyEx function with cv2.MORPH_CLOSE</span>
<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Display the result of the closing operation in the third subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Closing Operation&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f7b351de28df8cdb992d0b4c19029fc218220062bef81db7df704ce2c264eeda.png" src="_images/f7b351de28df8cdb992d0b4c19029fc218220062bef81db7df704ce2c264eeda.png" />
</div>
</div>
<p>This code is a Python script that uses the OpenCV library to demonstrate the “closing” operation in morphological image processing. The code also uses NumPy for array manipulation and Matplotlib for visualization. Here’s a brief explanation of each part of the code:</p>
<ol class="arabic simple">
<li><p><strong>Image Initialization:</strong> A blank image (black) is created with dimensions 800x1000 pixels and 3 channels (RGB).</p></li>
<li><p><strong>Text Overlay:</strong> The script specifies a text string (“Closing”) to be overlaid on the image. The font face, thickness, and scale for the text are defined.</p></li>
<li><p><strong>Text Measurement:</strong> The size of the text is measured to determine its dimensions for proper positioning.</p></li>
<li><p><strong>Text Overlay in Different Colors:</strong> The script overlays the same text at three different positions on the image, each with a different color (Red, Green, and Blue). The positions are above, at, and below the center of the image.</p></li>
<li><p><strong>Kernel Creation:</strong> A square kernel is created with a circular white region in the center. The size of the kernel is 11x11 pixels.</p></li>
<li><p><strong>Visualization:</strong> The code sets up a visual display with three subplots using Matplotlib. The first subplot shows the original image with the overlaid text. The second subplot shows the created kernel in grayscale. The third subplot shows the result of the closing operation using the created kernel.</p></li>
<li><p><strong>Closing Operation:</strong> The closing operation is performed on the original image using the <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx</span></code> function with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_CLOSE</span></code> operation and the created kernel.</p></li>
<li><p><strong>Display Result:</strong> The result of the closing operation is displayed in the third subplot.</p></li>
<li><p><strong>Aspect Ratio and Axis Labels:</strong> Aspect ratio is set to 1 for all subplots, and axis labels are turned off for better visualization.</p></li>
</ol>
</div>
<div class="section" id="morphological-gradient">
<h3><span class="section-number">6.2.3. </span>Morphological Gradient<a class="headerlink" href="#morphological-gradient" title="Permalink to this heading">#</a></h3>
<p>The “Morphological Gradient” is a valuable concept in image processing, obtained by calculating the difference between the dilation and the erosion of an image using a specified structuring element.</p>
<p>Mathematically, the “Morphological Gradient” operation (<span class="math notranslate nohighlight">\( \text{dst} = \text{morph_grad}(\text{src}, \text{element}) \)</span>) can be defined as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1585cbc6-c04b-4ffd-a9d2-b07e996bc4c0">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-1585cbc6-c04b-4ffd-a9d2-b07e996bc4c0" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{dst} = \text{dilate}(\text{src}, \text{element}) - \text{erode}(\text{src}, \text{element})
\end{equation}\]</div>
<p>This operation provides insight into the edges and boundaries within an image. By taking the difference between the dilated and eroded versions of the image, the “Morphological Gradient” highlights regions of significant intensity variation, essentially emphasizing the edges of objects in the image.</p>
<p>The morphological gradient can be especially useful in tasks such as edge detection, image enhancement, and feature extraction. It enhances the visibility of edges while minimizing the impact of noise and small details in the image. The structuring element (( \text{element} )) plays a crucial role in determining the size and shape of the neighborhood around each pixel, influencing the sensitivity of the gradient operation to the image’s details.</p>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="c1"># Create a blank image with dimensions 800x1000 and 3 channels (RGB)</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Morph. Gradient&#39;</span>

<span class="c1"># FontFace</span>
<span class="c1"># Choose the font face for the text</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>

<span class="c1"># Font thickness</span>
<span class="c1"># Set the thickness of the font</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Font Scale</span>
<span class="c1"># Choose the scale of the font</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Measure the text size for positioning</span>
<span class="c1"># (label_width, label_height) stores the size of the text</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay the text in different colors and positions on the image</span>
<span class="c1"># Color: Red</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Green</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Blue</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up font-related variables to free up memory</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1"># Kernel</span>
<span class="c1"># Create a square kernel with a circular white region in the center</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1"># Plots</span>
<span class="c1"># Set up subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Morphological Gradient&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Morphological Gradient</span>
<span class="c1"># Perform the morphological gradient operation using morphologyEx function with cv2.MORPH_GRADIENT</span>
<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_GRADIENT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Display the result of the morphological gradient operation in the third subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Morphological Gradient&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af8e8d0c518aa2a041c70cabd77041e29cee23c0d51935b4b6f35c810ec7d4fc.png" src="_images/af8e8d0c518aa2a041c70cabd77041e29cee23c0d51935b4b6f35c810ec7d4fc.png" />
</div>
</div>
<p>This code demonstrates the concept of the “Morphological Gradient” using Python with the OpenCV and Matplotlib libraries. Let’s break down what each section does:</p>
<ol class="arabic simple">
<li><p><strong>Image Initialization:</strong> A blank image with dimensions 800x1000 and 3 channels (RGB) is created. This image will serve as the canvas for the demonstration.</p></li>
<li><p><strong>Text Overlay:</strong> The script specifies a text string (“Morph. Gradient”) to be overlaid on the image. The font face, thickness, and scale for the text are defined.</p></li>
<li><p><strong>Text Measurement:</strong> The size of the text is measured to determine its dimensions for proper positioning.</p></li>
<li><p><strong>Text Overlay in Different Colors:</strong> The script overlays the same text at three different vertical positions on the image, each with a different color (Red, Green, and Blue). This creates a gradient effect.</p></li>
<li><p><strong>Clean Up:</strong> Font-related variables are deleted to free up memory.</p></li>
<li><p><strong>Kernel Creation:</strong> A square kernel is created with a circular white region in the center. The size of the kernel is 11x11 pixels.</p></li>
<li><p><strong>Visualization:</strong> The code sets up a visual display with three subplots using Matplotlib. The first subplot shows the original image with the overlaid text. The second subplot shows the created kernel in grayscale. The third subplot will show the result of the morphological gradient operation.</p></li>
<li><p><strong>Morphological Gradient:</strong> The morphological gradient operation is performed on the original image using the <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx</span></code> function with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_GRADIENT</span></code> operation and the created kernel. This operation highlights the edges and boundaries of objects in the image.</p></li>
<li><p><strong>Display Result:</strong> The result of the morphological gradient operation is displayed in the third subplot.</p></li>
<li><p><strong>Aspect Ratio and Axis Labels:</strong> Aspect ratio is set to 1 for all subplots, and axis labels are turned off for better visualization.</p></li>
</ol>
</div>
<div class="section" id="top-hat">
<h3><span class="section-number">6.2.4. </span>Top Hat<a class="headerlink" href="#top-hat" title="Permalink to this heading">#</a></h3>
<p>It is the difference between an input image and its opening.</p>
<div class="math notranslate nohighlight">
\[\texttt{dst} = \mathrm{tophat} ( \texttt{src} , \texttt{element} )= \texttt{src} - \mathrm{open} ( \texttt{src} , \texttt{element} )\]</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="c1"># Create a blank image with dimensions 800x1000 and 3 channels (RGB)</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Top Hat&#39;</span>

<span class="c1"># FontFace</span>
<span class="c1"># Choose the font face for the text</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>

<span class="c1"># Font thickness</span>
<span class="c1"># Set the thickness of the font</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Font Scale</span>
<span class="c1"># Choose the scale of the font</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Measure the text size for positioning</span>
<span class="c1"># (label_width, label_height) stores the size of the text</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay the text in different colors and positions on the image</span>
<span class="c1"># Color: Red</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Green</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Blue</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up font-related variables to free up memory</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1"># Kernel</span>
<span class="c1"># Create a square kernel with a circular white region in the center</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1"># Plots</span>
<span class="c1"># Set up subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Top Hat&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Top Hat</span>
<span class="c1"># Perform the top hat operation using morphologyEx function with cv2.MORPH_TOPHAT</span>
<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Display the result of the top hat operation in the third subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top Hat&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8820daf86f99b1cc2a94d9ef8e5ce7731946ba575b7aedc2e98196a328604da9.png" src="_images/8820daf86f99b1cc2a94d9ef8e5ce7731946ba575b7aedc2e98196a328604da9.png" />
</div>
</div>
<p>This code demonstrates the concept of the “Top Hat” morphological operation using Python with the OpenCV and Matplotlib libraries. Here’s a brief explanation of each part:</p>
<ol class="arabic simple">
<li><p><strong>Image Initialization:</strong> A blank image with dimensions 800x1000 and 3 channels (RGB) is created. This image will serve as the canvas for the demonstration.</p></li>
<li><p><strong>Text Overlay:</strong> The script specifies a text string (“Top Hat”) to be overlaid on the image. The font face, thickness, and scale for the text are defined.</p></li>
<li><p><strong>Text Measurement:</strong> The size of the text is measured to determine its dimensions for proper positioning.</p></li>
<li><p><strong>Text Overlay in Different Colors:</strong> The script overlays the same text at three different vertical positions on the image, each with a different color (Red, Green, and Blue). This creates a gradient effect.</p></li>
<li><p><strong>Clean Up:</strong> Font-related variables are deleted to free up memory.</p></li>
<li><p><strong>Kernel Creation:</strong> A square kernel is created with a circular white region in the center. The size of the kernel is 11x11 pixels.</p></li>
<li><p><strong>Visualization:</strong> The code sets up a visual display with three subplots using Matplotlib. The first subplot shows the original image with the overlaid text. The second subplot shows the created kernel in grayscale. The third subplot will show the result of the top hat operation.</p></li>
<li><p><strong>Top Hat Operation:</strong> The top hat operation is performed on the original image using the <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx</span></code> function with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_TOPHAT</span></code> operation and the created kernel. This operation highlights the bright structures (objects) in the image that are smaller than the kernel size.</p></li>
<li><p><strong>Display Result:</strong> The result of the top hat operation is displayed in the third subplot.</p></li>
<li><p><strong>Aspect Ratio and Axis Labels:</strong> Aspect ratio is set to 1 for all subplots, and axis labels are turned off for better visualization.</p></li>
</ol>
</div>
<div class="section" id="black-hat">
<h3><span class="section-number">6.2.5. </span>Black Hat<a class="headerlink" href="#black-hat" title="Permalink to this heading">#</a></h3>
<p>The “Black Hat” operation is a significant concept in morphological image processing, achieved by computing the difference between the closing of the input image and the original input image itself, using a specified structuring element.</p>
<p>Mathematically, the “Black Hat” operation (<span class="math notranslate nohighlight">\( \text{dst} = \text{blackhat}(\text{src}, \text{element}) \)</span>) can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-571f2d90-76ae-4b03-89fe-bc04fd315792">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-571f2d90-76ae-4b03-89fe-bc04fd315792" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{dst} = \text{close}(\text{src}, \text{element}) - \text{src}
\end{equation}\]</div>
<p>The “Black Hat” operation is particularly useful for highlighting and extracting small, dark regions or features within an image. By performing a closing operation on the input image, which consists of dilation followed by erosion, the “Black Hat” operation effectively removes the larger structures, leaving behind the smaller, darker structures that were present in the original image but were affected by the closing process.</p>
<p>This operation is commonly used for detecting small objects or details in an image, such as text in documents or small lesions in medical images. The structuring element (<span class="math notranslate nohighlight">\( \text{element} \)</span>) determines the size and shape of the neighborhood around each pixel, influencing the sensitivity of the “Black Hat” operation to the image’s details.</p>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Image</span>
<span class="c1"># Create a blank image with dimensions 800x1000 and 3 channels (RGB)</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Text to overlay on the image</span>
<span class="n">TXT</span> <span class="o">=</span> <span class="s1">&#39;Black Hat&#39;</span>

<span class="c1"># FontFace</span>
<span class="c1"># Choose the font face for the text</span>
<span class="n">FF</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span>

<span class="c1"># Font thickness</span>
<span class="c1"># Set the thickness of the font</span>
<span class="n">thickness</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Font Scale</span>
<span class="c1"># Choose the scale of the font</span>
<span class="n">FS</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Measure the text size for positioning</span>
<span class="c1"># (label_width, label_height) stores the size of the text</span>
<span class="p">(</span><span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Overlay the text in different colors and positions on the image</span>
<span class="c1"># Color: Red</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">),</span>
                   <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Green</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Color: Blue</span>
<span class="n">Img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">TXT</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">label_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">),</span>
                  <span class="n">fontFace</span><span class="o">=</span><span class="n">FF</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;Blue&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>

<span class="c1"># Clean up font-related variables to free up memory</span>
<span class="k">del</span> <span class="n">FF</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">label_width</span><span class="p">,</span> <span class="n">label_height</span>

<span class="c1"># Kernel</span>
<span class="c1"># Create a square kernel with a circular white region in the center</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
               <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Colors</span><span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lineType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>

<span class="c1"># Plots</span>
<span class="c1"># Set up subplots for visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="c1"># Set main title for the entire figure</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Black Hat&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># Display the original image in the first subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Img</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Display the kernel in grayscale in the second subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kernel&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Black Hat</span>
<span class="c1"># Perform the black hat operation using morphologyEx function with cv2.MORPH_BLACKHAT</span>
<span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Display the result of the black hat operation in the third subplot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Black Hat&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Set aspect ratio and turn off axis labels for all subplots</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ab2045683b412e9680a9ac9a43748080c87fa734d29c38eacf107a48c1b9f9b.png" src="_images/3ab2045683b412e9680a9ac9a43748080c87fa734d29c38eacf107a48c1b9f9b.png" />
</div>
</div>
<p>This code demonstrates the “Black Hat” morphological operation using Python with the OpenCV and Matplotlib libraries. Here’s a brief explanation of each part:</p>
<ol class="arabic simple">
<li><p><strong>Image Initialization:</strong> A blank image with dimensions 800x1000 and 3 channels (RGB) is created. This image will serve as the canvas for the demonstration.</p></li>
<li><p><strong>Text Overlay:</strong> The script specifies a text string (“Black Hat”) to be overlaid on the image. The font face, thickness, and scale for the text are defined.</p></li>
<li><p><strong>Text Measurement:</strong> The size of the text is measured to determine its dimensions for proper positioning.</p></li>
<li><p><strong>Text Overlay in Different Colors:</strong> The script overlays the same text at three different vertical positions on the image, each with a different color (Red, Green, and Blue). This creates a gradient effect.</p></li>
<li><p><strong>Clean Up:</strong> Font-related variables are deleted to free up memory.</p></li>
<li><p><strong>Kernel Creation:</strong> A square kernel is created with a circular white region in the center. The size of the kernel is 11x11 pixels.</p></li>
<li><p><strong>Visualization:</strong> The code sets up a visual display with three subplots using Matplotlib. The first subplot shows the original image with the overlaid text. The second subplot shows the created kernel in grayscale. The third subplot will show the result of the black hat operation.</p></li>
<li><p><strong>Black Hat Operation:</strong> The black hat operation is performed on the original image using the <code class="docutils literal notranslate"><span class="pre">cv2.morphologyEx</span></code> function with the <code class="docutils literal notranslate"><span class="pre">cv2.MORPH_BLACKHAT</span></code> operation and the created kernel. This operation highlights the darker structures (objects) in the image that are smaller than the kernel size.</p></li>
<li><p><strong>Display Result:</strong> The result of the black hat operation is displayed in the third subplot.</p></li>
<li><p><strong>Aspect Ratio and Axis Labels:</strong> Aspect ratio is set to 1 for all subplots, and axis labels are turned off for better visualization.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CV_C5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Image Filtering</p>
      </div>
    </a>
    <a class="right-next"
       href="References.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dilation">6.1. Dilation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphologyex">6.2. morphologyEx</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-operation">6.2.1. Opening Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-operation">6.2.2. Closing Operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#morphological-gradient">6.2.3. Morphological Gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#top-hat">6.2.4. Top Hat</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#black-hat">6.2.5. Black Hat</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>