

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiple Linear Regression &#8212; Introduction to Digital Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_09/ENGG_680_C09S3_V0';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_01/ReadMe.html">1. Introduction to Python Programming</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S1.html">1.1. Variable names, Expressions and statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S2.html">1.2. Fundamental Concepts and Operations in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S3.html">1.3. Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_02/ReadMe.html">2. Control Flow: Conditionals, Recursion, and Iteration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S1.html">2.1. Conditionals and recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S2.html">2.2. Iteration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_03/ReadMe.html">3. Data Structures and File Handling in Python</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S1.html">3.1. Strings in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S2.html">3.2. Python Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S3.html">3.3. Python Dictionaries: Key-Value Pairs in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S4.html">3.4. Python Tuples: Immutable Sequences in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S5.html">3.5. Python Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S6.html">3.6. Files in Python (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_04/ReadMe.html">4. Classes and Objects</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S1.html">4.1. Introduction to Classes and Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S2.html">4.2. Inheritance and Polymorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S3.html">4.3. Encapsulation and Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S4.html">4.4. Copying Objects (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S5.html">4.5. Magic Methods (Dunder Methods) in Python (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S6.html">4.6. Examples of Classes (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_05/ReadMe.html">5. Introduction to NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S1.html">5.1. Basics of Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S2.html">5.2. NumPy Function Reference and Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S3.html">5.3. Advanced Numpy Concepts (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_06/ReadMe.html">6. Working with Data using Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S1.html">6.1. An Introduction to Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S2.html">6.2. DataFrame and Series Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S3.html">6.3. Pandas Data Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S4.html">6.4. Handling Missing Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S5.html">6.5. Combining Datasets using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S6.html">6.6. Aggregation and Grouping in Pandas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_07/ReadMe.html">7. Data Visualization using Python</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S1.html">7.1. Getting started with Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S2.html">7.2. Matplotlib Styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S3.html">7.3. Matplotlib interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S4.html">7.4. Adjusting the Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S5.html">7.5. Seaborn plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S6.html">7.6. Python Plotting Guide</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_08/ReadMe.html">8. An Introduction to Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S1.html">8.1. Getting Started with OpenCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S2.html">8.2. Geometric Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S3.html">8.3. Image Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S4.html">8.4. Image Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S5.html">8.5. Drawing Functions (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/ENGG_680_C08S6.html">8.6. Morphological Transformations (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ReadMe.html">9. An Introduction to Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S1.html">9.1. Prologue: Statistical Metrics and Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S2.html">9.2. An Introduction to Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S3.html">9.3. Multiple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S4.html">9.4. Logistic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S5.html">9.5. K-Nearest Neighbors (K-NN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S6.html">9.6. Resampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C09S7.html">9.7. Support Vector Machines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_10/ReadMe.html">10. Tree-Based Methods</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S1.html">10.1. Fundamental Structure of Decision Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S2.html">10.2. Regression Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S3.html">10.3. Classification Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S4.html">10.4. Regression Trees and Linear Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S5.html">10.5. Enhancing Decision Trees with Bagging: An Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S6.html">10.6. Random Forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_10/ENGG_680_C10S7.html">10.7. Gradient Boosting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_11/ReadMe.html">11. Dimensionality Reduction and Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S1.html">11.1. Introduction to Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S2.html">11.2. Principal Components Analysis (PCA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S3.html">11.3. t-Distributed Stochastic Neighbor Embedding (t-SNE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S4.html">11.4. Linear and Quadratic Discriminant Analyses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S5.html">11.5. Recursive Feature Elimination (RFE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_11/ENGG_680_C11S6.html">11.6. Practical Considerations in Dimensionality Reduction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_12/ReadMe.html">12. Introduction to Deep Learning</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S1.html">12.1. Understanding Deep Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S2.html">12.2. Fundamentals of Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S3.html">12.3. Tensors and Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S4.html">12.4. Building a linear Regression Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S5.html">12.5. Building a Logistic Regression Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S6.html">12.6. Multilayer Perceptron (MLP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S7.html">12.7. Image classification with TensorFlow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_12/ENGG_680_C12S8.html">12.8. Image Augmentations with TensorFlow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../appendixes/ReadMe.html">13. Appendices</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendixes/SampleQuestions_1.html">13.1. Sample Questions 1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">14. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Multiple Linear Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qualitative-predictors-with-only-two-levels">Qualitative Predictors with Only Two Levels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qualitative-predictors-with-more-than-two-levels">Qualitative Predictors with More than Two Levels</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="multiple-linear-regression">
<h1>Multiple Linear Regression<a class="headerlink" href="#multiple-linear-regression" title="Permalink to this headline">#</a></h1>
<p>For conducting multiple linear regression through the least squares method in Python, you can leverage the <code class="docutils literal notranslate"><span class="pre">ModelSpec()</span></code> function from suitable libraries like <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> or <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>. This function aids in crafting the model matrix and response variables crucial for regression analysis. In the present illustration, we’ll delve into a multiple linear regression model incorporating two predictor variables: <code class="docutils literal notranslate"><span class="pre">lstat</span></code> and <code class="docutils literal notranslate"><span class="pre">age</span></code> <span id="id1">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>Below outlines the procedure using the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recall Boston Dataset</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">_url</span> <span class="o">=</span> <span class="s2">&quot;http://lib.stat.cmu.edu/datasets/boston&quot;</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span> <span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>

<span class="n">Boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span> <span class="n">_url</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
                 <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1">#Flatten all the values into a single long list and remove the nulls</span>
<span class="n">values_w_nulls</span> <span class="o">=</span> <span class="n">Boston</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">all_values</span> <span class="o">=</span> <span class="n">values_w_nulls</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">values_w_nulls</span><span class="p">)]</span>

<span class="c1">#Reshape the values to have 14 columns and make a new df out of them</span>
<span class="n">Boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">all_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)),</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>

<span class="c1"># Also recall our fancy dataframe for OLS Reression results</span>
<span class="k">def</span> <span class="nf">Reg_Result</span><span class="p">(</span><span class="n">Inp</span><span class="p">):</span>
    <span class="n">Temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">Inp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_html</span><span class="p">(),</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Temp</span><span class="o">.</span><span class="n">style</span>\
    <span class="o">.</span><span class="n">format</span><span class="p">({</span><span class="s1">&#39;coef&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.4e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;P&gt;|t|&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.4e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;std err&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.4e}</span><span class="s1">&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Lime&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;std err&#39;</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;DimGray&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;White&#39;</span><span class="p">}))</span>

<span class="c1"># Step 1: Prepare the predictor variables and target variable</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">Boston</span><span class="p">[[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">]]</span>  <span class="c1"># Predictor variables</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Boston</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>          <span class="c1"># Target variable</span>

<span class="c1"># Step 2: Add a constant term to the predictor variables (intercept)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Step 3: Fit the multiple linear regression model using ordinary least squares (OLS)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">Results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Step 4: Print the summary of the regression results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   MEDV   R-squared:                       0.551
Model:                            OLS   Adj. R-squared:                  0.549
Method:                 Least Squares   F-statistic:                     309.0
Date:                Thu, 12 Oct 2023   Prob (F-statistic):           2.98e-88
Time:                        20:15:47   Log-Likelihood:                -1637.5
No. Observations:                 506   AIC:                             3281.
Df Residuals:                     503   BIC:                             3294.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         33.2228      0.731     45.458      0.000      31.787      34.659
LSTAT         -1.0321      0.048    -21.416      0.000      -1.127      -0.937
AGE            0.0345      0.012      2.826      0.005       0.011       0.059
==============================================================================
Omnibus:                      124.288   Durbin-Watson:                   0.945
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              244.026
Skew:                           1.362   Prob(JB):                     1.02e-53
Kurtosis:                       5.038   Cond. No.                         201.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_d9fdd_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 3.0%, Lime 3.0%, Lime 100.0%, transparent 100.0%);
}
#T_d9fdd_row0_col1, #T_d9fdd_row1_col1, #T_d9fdd_row2_col1 {
  background-color: DimGray;
  color: White;
}
#T_d9fdd_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 3.0%, transparent 3.0%);
}
#T_d9fdd_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 3.0%, Lime 3.0%, Lime 3.1%, transparent 3.1%);
}
</style>
<table id="T_d9fdd">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_d9fdd_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_d9fdd_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_d9fdd_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_d9fdd_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_d9fdd_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_d9fdd_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d9fdd_level0_row0" class="row_heading level0 row0" >const</th>
      <td id="T_d9fdd_row0_col0" class="data row0 col0" >3.3223e+01</td>
      <td id="T_d9fdd_row0_col1" class="data row0 col1" >7.3100e-01</td>
      <td id="T_d9fdd_row0_col2" class="data row0 col2" >45.458000</td>
      <td id="T_d9fdd_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_d9fdd_row0_col4" class="data row0 col4" >31.787000</td>
      <td id="T_d9fdd_row0_col5" class="data row0 col5" >34.659000</td>
    </tr>
    <tr>
      <th id="T_d9fdd_level0_row1" class="row_heading level0 row1" >LSTAT</th>
      <td id="T_d9fdd_row1_col0" class="data row1 col0" >-1.0321e+00</td>
      <td id="T_d9fdd_row1_col1" class="data row1 col1" >4.8000e-02</td>
      <td id="T_d9fdd_row1_col2" class="data row1 col2" >-21.416000</td>
      <td id="T_d9fdd_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_d9fdd_row1_col4" class="data row1 col4" >-1.127000</td>
      <td id="T_d9fdd_row1_col5" class="data row1 col5" >-0.937000</td>
    </tr>
    <tr>
      <th id="T_d9fdd_level0_row2" class="row_heading level0 row2" >AGE</th>
      <td id="T_d9fdd_row2_col0" class="data row2 col0" >3.4500e-02</td>
      <td id="T_d9fdd_row2_col1" class="data row2 col1" >1.2000e-02</td>
      <td id="T_d9fdd_row2_col2" class="data row2 col2" >2.826000</td>
      <td id="T_d9fdd_row2_col3" class="data row2 col3" >5.0000e-03</td>
      <td id="T_d9fdd_row2_col4" class="data row2 col4" >0.011000</td>
      <td id="T_d9fdd_row2_col5" class="data row2 col5" >0.059000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The provided output is a summary of the results from an Ordinary Least Squares (OLS) regression analysis. This analysis aims to model the relationship between the dependent variable (<code class="docutils literal notranslate"><span class="pre">MEDV</span></code>, in this case) and two independent variables (<code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> and <code class="docutils literal notranslate"><span class="pre">AGE</span></code>).</p>
<p>Let’s break down the different components of the summary:</p>
<ol class="arabic simple">
<li><p>Dependent Variable: <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>
The dependent variable is the target variable in the regression analysis. It represents the variable we are trying to predict or explain.</p></li>
<li><p>R-squared: 0.551
The R-squared value, also known as the coefficient of determination, measures the proportion of the variance in the dependent variable that is explained by the independent variables. In this case, the R-squared is 0.551, indicating that approximately 55.1% of the variance in <code class="docutils literal notranslate"><span class="pre">MEDV</span></code> can be explained by the predictor variables <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> and <code class="docutils literal notranslate"><span class="pre">AGE</span></code>.</p></li>
<li><p>Model: OLS
The model used for the regression analysis is the Ordinary Least Squares (OLS) model, which is a common method for estimating the coefficients of a linear regression model.</p></li>
<li><p>Adj. R-squared: 0.549
The adjusted R-squared adjusts the R-squared value for the number of predictor variables in the model. It penalizes the R-squared for including unnecessary predictors and provides a more appropriate measure of the model’s goodness of fit. In this case, the adjusted R-squared is 0.549.</p></li>
<li><p>Method: Least Squares
The method used to estimate the regression coefficients is the method of least squares, which minimizes the sum of the squared differences between the observed and predicted values.</p></li>
<li><p>F-statistic: 309.0
The F-statistic is a measure of the overall significance of the regression model. It assesses whether the model as a whole is statistically significant in explaining the variance in the dependent variable. In this case, the F-statistic is 309.0, and the associated probability (Prob (F-statistic)) is very low (2.98e-88), indicating that the model is statistically significant.</p></li>
<li><p>Date, Time, No. Observations, Df Residuals, Df Model, Covariance Type
These are additional information about the analysis, including the date and time of the analysis, the number of observations (506), the degrees of freedom for the residuals (503), the degrees of freedom for the model (2), and the covariance type (nonrobust).</p></li>
<li><p>Coefficients and Associated Statistics:
The table displays the estimated coefficients for the intercept (<code class="docutils literal notranslate"><span class="pre">const</span></code>) and the predictor variables (<code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> and <code class="docutils literal notranslate"><span class="pre">AGE</span></code>). For each coefficient, the summary provides its estimated value (<code class="docutils literal notranslate"><span class="pre">coef</span></code>), standard error (<code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code>), t-statistic (<code class="docutils literal notranslate"><span class="pre">t</span></code>), probability (P&gt;|t|), and the 95% confidence interval (<code class="docutils literal notranslate"><span class="pre">[0.025</span> <span class="pre">0.975]</span></code>). The t-statistic assesses the significance of each coefficient, and the associated probability (P&gt;|t|) is a two-tailed test p-value. If the p-value is small (typically less than 0.05), the coefficient is considered statistically significant.</p></li>
</ol>
<p><font color='Blue'><b>Example</b></font>: Next, we explore the <strong>ISLR Advertising dataset</strong> <span id="id2">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>, which provides valuable insights into the sales performance of a product across 200 diverse markets. The dataset is accompanied by corresponding advertising budgets for the product, categorized into three different media channels: TV, radio, and newspaper.</p>
<p>Our objective, through the analysis of this dataset, is to discern how advertising expenditures across various media channels impact the product’s sales in diverse markets. This dataset serves as an excellent entry point for gaining practical experience in data analysis and regression modeling.</p>
<p>You can access the dataset through the following link: <a class="reference external" href="https://www.statlearning.com/resources-python">statlearning.com/resources-python</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the Advertising dataset from the provided link using wget</span>
<span class="c1"># https://www.statlearning.com/s/Advertising.csv</span>

<span class="c1"># Import the necessary libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the Advertising dataset into a pandas DataFrame</span>
<span class="n">Advertising</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Advertising.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Rename the columns to have consistent capitalization for &#39;TV&#39;</span>
<span class="c1"># The loop iterates through the column names and replaces &#39;Tv&#39; with &#39;TV&#39; while preserving the rest of the title case</span>
<span class="n">Advertising</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Tv&#39;</span><span class="p">,</span> <span class="s1">&#39;TV&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Advertising</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="c1"># Display the first 10 rows</span>
<span class="n">display</span><span class="p">(</span><span class="n">Advertising</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TV</th>
      <th>Radio</th>
      <th>Newspaper</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>230.1</td>
      <td>37.8</td>
      <td>69.2</td>
      <td>22.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>44.5</td>
      <td>39.3</td>
      <td>45.1</td>
      <td>10.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17.2</td>
      <td>45.9</td>
      <td>69.3</td>
      <td>9.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>151.5</td>
      <td>41.3</td>
      <td>58.5</td>
      <td>18.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>180.8</td>
      <td>10.8</td>
      <td>58.4</td>
      <td>12.9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.7</td>
      <td>48.9</td>
      <td>75.0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>57.5</td>
      <td>32.8</td>
      <td>23.5</td>
      <td>11.8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>120.2</td>
      <td>19.6</td>
      <td>11.6</td>
      <td>13.2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8.6</td>
      <td>2.1</td>
      <td>1.0</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>199.8</td>
      <td>2.6</td>
      <td>21.2</td>
      <td>10.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Within the multiple linear regression model, we encounter a dependent variable, denoted as <span class="math notranslate nohighlight">\(Y\)</span>, alongside multiple predictor variables: <span class="math notranslate nohighlight">\(X_1\)</span> (representing TV advertising), <span class="math notranslate nohighlight">\(X_2\)</span> (for radio advertising), and <span class="math notranslate nohighlight">\(X_3\)</span> (pertaining to newspaper advertising). The primary objective of this model is to predict the value of the dependent variable, <span class="math notranslate nohighlight">\(Y\)</span>, based on the values of these predictor variables.</p>
<p>The model’s equation is articulated as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ee5ef234-ae42-4ff2-9160-d8e8ced23358">
<span class="eqno">()<a class="headerlink" href="#equation-ee5ef234-ae42-4ff2-9160-d8e8ced23358" title="Permalink to this equation">#</a></span>\[\begin{equation}Y = \beta_0 + \beta_1 \times X_1 + \beta_2 \times X_2 + \beta_3 \times X_3 + \epsilon.\end{equation}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y\)</span> denotes the dependent variable (e.g., sales, in this instance).</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> signifies the intercept term, representing the value of <span class="math notranslate nohighlight">\(Y\)</span> when all predictor variables (<span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, and <span class="math notranslate nohighlight">\(X_3\)</span>) are zero.</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span>, <span class="math notranslate nohighlight">\(\beta_2\)</span>, and <span class="math notranslate nohighlight">\(\beta_3\)</span> denote the regression coefficients linked to the predictor variables <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, and <span class="math notranslate nohighlight">\(X_3\)</span>, respectively. These coefficients signify the average change in <span class="math notranslate nohighlight">\(Y\)</span> resulting from a one-unit increase in each predictor variable, while holding all other predictors constant.</p></li>
<li><p><span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, and <span class="math notranslate nohighlight">\(X_3\)</span> represent the values of the predictor variables (TV, radio, and newspaper) for a specific data point.</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> represents the error term, accounting for the variability in <span class="math notranslate nohighlight">\(Y\)</span> not explicable by the predictor variables. It captures the effects of other unobserved factors or random variations.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">Results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV + Radio + Newspaper&#39;</span><span class="p">,</span> <span class="n">Advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Sales   R-squared:                       0.897
Model:                            OLS   Adj. R-squared:                  0.896
Method:                 Least Squares   F-statistic:                     570.3
Date:                Thu, 12 Oct 2023   Prob (F-statistic):           1.58e-96
Time:                        20:15:47   Log-Likelihood:                -386.18
No. Observations:                 200   AIC:                             780.4
Df Residuals:                     196   BIC:                             793.6
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      2.9389      0.312      9.422      0.000       2.324       3.554
TV             0.0458      0.001     32.809      0.000       0.043       0.049
Radio          0.1885      0.009     21.893      0.000       0.172       0.206
Newspaper     -0.0010      0.006     -0.177      0.860      -0.013       0.011
==============================================================================
Omnibus:                       60.414   Durbin-Watson:                   2.084
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              151.241
Skew:                          -1.327   Prob(JB):                     1.44e-33
Kurtosis:                       6.332   Cond. No.                         454.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_0a263_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 100.0%, transparent 100.0%);
}
#T_0a263_row0_col1, #T_0a263_row1_col1, #T_0a263_row2_col1, #T_0a263_row3_col1 {
  background-color: DimGray;
  color: White;
}
#T_0a263_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 1.6%, transparent 1.6%);
}
#T_0a263_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 6.4%, transparent 6.4%);
}
#T_0a263_row3_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.0%, transparent 0.0%);
}
</style>
<table id="T_0a263">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_0a263_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_0a263_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_0a263_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_0a263_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_0a263_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_0a263_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_0a263_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_0a263_row0_col0" class="data row0 col0" >2.9389e+00</td>
      <td id="T_0a263_row0_col1" class="data row0 col1" >3.1200e-01</td>
      <td id="T_0a263_row0_col2" class="data row0 col2" >9.422000</td>
      <td id="T_0a263_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_0a263_row0_col4" class="data row0 col4" >2.324000</td>
      <td id="T_0a263_row0_col5" class="data row0 col5" >3.554000</td>
    </tr>
    <tr>
      <th id="T_0a263_level0_row1" class="row_heading level0 row1" >TV</th>
      <td id="T_0a263_row1_col0" class="data row1 col0" >4.5800e-02</td>
      <td id="T_0a263_row1_col1" class="data row1 col1" >1.0000e-03</td>
      <td id="T_0a263_row1_col2" class="data row1 col2" >32.809000</td>
      <td id="T_0a263_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_0a263_row1_col4" class="data row1 col4" >0.043000</td>
      <td id="T_0a263_row1_col5" class="data row1 col5" >0.049000</td>
    </tr>
    <tr>
      <th id="T_0a263_level0_row2" class="row_heading level0 row2" >Radio</th>
      <td id="T_0a263_row2_col0" class="data row2 col0" >1.8850e-01</td>
      <td id="T_0a263_row2_col1" class="data row2 col1" >9.0000e-03</td>
      <td id="T_0a263_row2_col2" class="data row2 col2" >21.893000</td>
      <td id="T_0a263_row2_col3" class="data row2 col3" >0.0000e+00</td>
      <td id="T_0a263_row2_col4" class="data row2 col4" >0.172000</td>
      <td id="T_0a263_row2_col5" class="data row2 col5" >0.206000</td>
    </tr>
    <tr>
      <th id="T_0a263_level0_row3" class="row_heading level0 row3" >Newspaper</th>
      <td id="T_0a263_row3_col0" class="data row3 col0" >-1.0000e-03</td>
      <td id="T_0a263_row3_col1" class="data row3 col1" >6.0000e-03</td>
      <td id="T_0a263_row3_col2" class="data row3 col2" >-0.177000</td>
      <td id="T_0a263_row3_col3" class="data row3 col3" >8.6000e-01</td>
      <td id="T_0a263_row3_col4" class="data row3 col4" >-0.013000</td>
      <td id="T_0a263_row3_col5" class="data row3 col5" >0.011000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, let’s interpret the results for each predictor variable:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Intercept</span></code>: The coefficient for the intercept term represents the estimated value of the dependent variable when all predictor variables (TV, Radio, and Newspaper) are zero. In this case, the intercept is approximately 2.9389.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TV</span></code>: The coefficient for the TV predictor variable is approximately 0.0458. It indicates that, on average, for every one unit increase in TV advertising budget (in whatever units the data measures TV advertising), the dependent variable (sales or another outcome) is estimated to increase by 0.0458 units, holding all other predictors constant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Radio</span></code>: The coefficient for the Radio predictor variable is approximately 0.1885. It suggests that, on average, for every one unit increase in Radio advertising budget, the dependent variable is estimated to increase by 0.1885 units, holding all other predictors constant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Newspaper</span></code>: The coefficient for the Newspaper predictor variable is approximately -0.0010. It indicates that, on average, for every one unit increase in Newspaper advertising budget, the dependent variable is estimated to decrease by 0.0010 units. However, it’s important to note that the p-value for this coefficient is quite high (0.860), which means that this variable is not statistically significant at the conventional significance level (0.05). This suggests that the relationship between Newspaper advertising and the dependent variable is not well-supported by the data in this particular model.</p></li>
</ol>
<p>As can be seen from the coefficient estimates of the multiple linear regression model:</p>
<ol class="arabic simple">
<li><p><strong>Radio Advertising Effect</strong>: For a fixed amount of TV and newspaper advertising, increasing the radio advertising budget by $1,000 is associated with an estimated increase in sales by approximately 189 units. This implies that investing more in radio advertising has a significant positive impact on sales, even after accounting for the effects of TV and newspaper advertising.</p></li>
<li><p><strong>TV Advertising Effect</strong>: For a fixed amount of radio and newspaper advertising, increasing the TV advertising budget by $1,000 is associated with an estimated increase in sales by approximately 46 units. This suggests that allocating more resources to TV advertising can result in a considerable positive effect on sales, while controlling for the influence of radio and newspaper advertising.</p></li>
<li><p><strong>Newspaper Advertising Effect</strong>: In contrast to TV and radio advertising, the coefficient estimate for newspaper advertising is very close to zero, and the corresponding p-value is insignificant (higher than the conventional significance level of 0.05). This indicates that, in this particular model, there is no strong evidence to support a significant relationship between newspaper advertising and sales. In other words, spending more on newspaper advertising may not have a substantial impact on sales when considering the effects of TV and radio advertising.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RSS with regression coefficients</span>
<span class="n">RSS</span> <span class="o">=</span> <span class="p">((</span><span class="n">Advertising</span><span class="o">.</span><span class="n">Sales</span> <span class="o">-</span> <span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Advertising</span><span class="o">.</span><span class="n">TV</span>
                             <span class="o">+</span> <span class="n">Results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Advertising</span><span class="o">.</span><span class="n">Radio</span>
                             <span class="o">+</span> <span class="n">Results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Advertising</span><span class="o">.</span><span class="n">Newspaper</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RSS with regression coefficients = </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">RSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RSS with regression coefficients = 4.8304
</pre></div>
</div>
</div>
</div>
<p>Note that the value of RSS gives an indication of how well the regression model fits the data. A smaller RSS indicates a better fit, as it means that the model’s predictions are closer to the actual values of the dependent variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_ef9fd_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 100.0%, transparent 100.0%);
}
#T_ef9fd_row0_col1, #T_ef9fd_row1_col1, #T_ef9fd_row2_col1, #T_ef9fd_row3_col1 {
  background-color: DimGray;
  color: White;
}
#T_ef9fd_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 1.6%, transparent 1.6%);
}
#T_ef9fd_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.0%, Lime 0.0%, Lime 6.4%, transparent 6.4%);
}
#T_ef9fd_row3_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.0%, transparent 0.0%);
}
</style>
<table id="T_ef9fd">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_ef9fd_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_ef9fd_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_ef9fd_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_ef9fd_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_ef9fd_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_ef9fd_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ef9fd_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_ef9fd_row0_col0" class="data row0 col0" >2.9389e+00</td>
      <td id="T_ef9fd_row0_col1" class="data row0 col1" >3.1200e-01</td>
      <td id="T_ef9fd_row0_col2" class="data row0 col2" >9.422000</td>
      <td id="T_ef9fd_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_ef9fd_row0_col4" class="data row0 col4" >2.324000</td>
      <td id="T_ef9fd_row0_col5" class="data row0 col5" >3.554000</td>
    </tr>
    <tr>
      <th id="T_ef9fd_level0_row1" class="row_heading level0 row1" >TV</th>
      <td id="T_ef9fd_row1_col0" class="data row1 col0" >4.5800e-02</td>
      <td id="T_ef9fd_row1_col1" class="data row1 col1" >1.0000e-03</td>
      <td id="T_ef9fd_row1_col2" class="data row1 col2" >32.809000</td>
      <td id="T_ef9fd_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_ef9fd_row1_col4" class="data row1 col4" >0.043000</td>
      <td id="T_ef9fd_row1_col5" class="data row1 col5" >0.049000</td>
    </tr>
    <tr>
      <th id="T_ef9fd_level0_row2" class="row_heading level0 row2" >Radio</th>
      <td id="T_ef9fd_row2_col0" class="data row2 col0" >1.8850e-01</td>
      <td id="T_ef9fd_row2_col1" class="data row2 col1" >9.0000e-03</td>
      <td id="T_ef9fd_row2_col2" class="data row2 col2" >21.893000</td>
      <td id="T_ef9fd_row2_col3" class="data row2 col3" >0.0000e+00</td>
      <td id="T_ef9fd_row2_col4" class="data row2 col4" >0.172000</td>
      <td id="T_ef9fd_row2_col5" class="data row2 col5" >0.206000</td>
    </tr>
    <tr>
      <th id="T_ef9fd_level0_row3" class="row_heading level0 row3" >Newspaper</th>
      <td id="T_ef9fd_row3_col0" class="data row3 col0" >-1.0000e-03</td>
      <td id="T_ef9fd_row3_col1" class="data row3 col1" >6.0000e-03</td>
      <td id="T_ef9fd_row3_col2" class="data row3 col2" >-0.177000</td>
      <td id="T_ef9fd_row3_col3" class="data row3 col3" >8.6000e-01</td>
      <td id="T_ef9fd_row3_col4" class="data row3 col4" >-0.013000</td>
      <td id="T_ef9fd_row3_col5" class="data row3 col5" >0.011000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><font color='Blue'><b>Example</b></font>: Let’s consider the correlation between variables in forming the linear model.</p>
<p><strong>Correlation matrix for the advertising dataset:</strong></p>
<p>The code provided is used to display the correlation matrix of the Advertising dataset using a heatmap visualization with color gradients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">Advertising</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_e6c82_row0_col0, #T_e6c82_row1_col1, #T_e6c82_row2_col2, #T_e6c82_row3_col3 {
  background-color: #053061;
  color: #f1f1f1;
}
#T_e6c82_row0_col1, #T_e6c82_row0_col2, #T_e6c82_row1_col0, #T_e6c82_row2_col0, #T_e6c82_row2_col3 {
  background-color: #67001f;
  color: #f1f1f1;
}
#T_e6c82_row0_col3 {
  background-color: #84bcd9;
  color: #000000;
}
#T_e6c82_row1_col2 {
  background-color: #f5ac8b;
  color: #000000;
}
#T_e6c82_row1_col3 {
  background-color: #fae9df;
  color: #000000;
}
#T_e6c82_row2_col1 {
  background-color: #f6af8e;
  color: #000000;
}
#T_e6c82_row3_col0 {
  background-color: #59a1ca;
  color: #f1f1f1;
}
#T_e6c82_row3_col1 {
  background-color: #e3edf3;
  color: #000000;
}
#T_e6c82_row3_col2 {
  background-color: #cf5246;
  color: #f1f1f1;
}
</style>
<table id="T_e6c82">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_e6c82_level0_col0" class="col_heading level0 col0" >TV</th>
      <th id="T_e6c82_level0_col1" class="col_heading level0 col1" >Radio</th>
      <th id="T_e6c82_level0_col2" class="col_heading level0 col2" >Newspaper</th>
      <th id="T_e6c82_level0_col3" class="col_heading level0 col3" >Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e6c82_level0_row0" class="row_heading level0 row0" >TV</th>
      <td id="T_e6c82_row0_col0" class="data row0 col0" >1.00</td>
      <td id="T_e6c82_row0_col1" class="data row0 col1" >0.05</td>
      <td id="T_e6c82_row0_col2" class="data row0 col2" >0.06</td>
      <td id="T_e6c82_row0_col3" class="data row0 col3" >0.78</td>
    </tr>
    <tr>
      <th id="T_e6c82_level0_row1" class="row_heading level0 row1" >Radio</th>
      <td id="T_e6c82_row1_col0" class="data row1 col0" >0.05</td>
      <td id="T_e6c82_row1_col1" class="data row1 col1" >1.00</td>
      <td id="T_e6c82_row1_col2" class="data row1 col2" >0.35</td>
      <td id="T_e6c82_row1_col3" class="data row1 col3" >0.58</td>
    </tr>
    <tr>
      <th id="T_e6c82_level0_row2" class="row_heading level0 row2" >Newspaper</th>
      <td id="T_e6c82_row2_col0" class="data row2 col0" >0.06</td>
      <td id="T_e6c82_row2_col1" class="data row2 col1" >0.35</td>
      <td id="T_e6c82_row2_col2" class="data row2 col2" >1.00</td>
      <td id="T_e6c82_row2_col3" class="data row2 col3" >0.23</td>
    </tr>
    <tr>
      <th id="T_e6c82_level0_row3" class="row_heading level0 row3" >Sales</th>
      <td id="T_e6c82_row3_col0" class="data row3 col0" >0.78</td>
      <td id="T_e6c82_row3_col1" class="data row3 col1" >0.58</td>
      <td id="T_e6c82_row3_col2" class="data row3 col2" >0.23</td>
      <td id="T_e6c82_row3_col3" class="data row3 col3" >1.00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The table provided represents a correlation matrix, where each row and column correspond to a variable in the dataset. The numbers in the cells of the matrix represent the correlation coefficients between pairs of variables. Correlation coefficients measure the strength and direction of the linear relationship between two variables. The correlation coefficient ranges from -1 to +1, where -1 indicates a perfect negative linear relationship, +1 indicates a perfect positive linear relationship, and 0 indicates no linear relationship.</p>
<p>Let’s interpret the correlation matrix:</p>
<ul class="simple">
<li><p><strong>TV vs. TV</strong>: The correlation coefficient of 1.00 (at the top-left corner) represents the correlation of ‘TV’ with itself. As expected, the correlation of a variable with itself is always 1, as it perfectly correlates with itself.</p></li>
<li><p><strong>TV vs. Radio</strong>: The correlation coefficient between ‘TV’ and ‘Radio’ is 0.05. This indicates a very weak positive linear relationship between the two variables. The low correlation suggests that there is little or no linear association between TV advertising spending and radio advertising spending in the dataset.</p></li>
<li><p><strong>TV vs. Newspaper</strong>: The correlation coefficient between ‘TV’ and ‘Newspaper’ is 0.06. Like the previous case, this also indicates a very weak positive linear relationship between TV advertising spending and newspaper advertising spending.</p></li>
<li><p><strong>TV vs. Sales</strong>: The correlation coefficient between ‘TV’ and ‘Sales’ is 0.78. This suggests a moderately strong positive linear relationship between TV advertising spending and sales. A higher correlation coefficient indicates that TV advertising spending and sales tend to increase together, and the correlation is relatively stronger compared to the other pairs.</p></li>
<li><p><strong>Radio vs. Radio</strong>: As with ‘TV’, the correlation of ‘Radio’ with itself is 1.00.</p></li>
<li><p><strong>Radio vs. Newspaper</strong>: The correlation coefficient between ‘Radio’ and ‘Newspaper’ is 0.35. This indicates a moderate positive linear relationship between radio advertising spending and newspaper advertising spending.</p></li>
<li><p><strong>Radio vs. Sales</strong>: The correlation coefficient between ‘Radio’ and ‘Sales’ is 0.58. This indicates a moderately strong positive linear relationship between radio advertising spending and sales.</p></li>
<li><p><strong>Newspaper vs. Newspaper</strong>: Again, the correlation of ‘Newspaper’ with itself is 1.00.</p></li>
<li><p><strong>Newspaper vs. Sales</strong>: The correlation coefficient between ‘Newspaper’ and ‘Sales’ is 0.23. This indicates a weak positive linear relationship between newspaper advertising spending and sales.</p></li>
<li><p><strong>Sales vs. Sales</strong>: As expected, the correlation of ‘Sales’ with itself is 1.00.</p></li>
</ul>
<p>The correlation matrix reveals that there is a positive correlation of approximately 0.35 between the ‘Radio’ and ‘Newspaper’ advertising variables. This indicates a tendency to spend more on newspaper advertising in markets where more is spent on radio advertising. However, it’s important to note that correlation does not imply causation; it only indicates a statistical relationship between the two variables.</p>
<p>Since the p-value for the ‘Newspaper’ advertising coefficient is insignificant, suggesting that it is not statistically significant in the multiple linear regression model, we can consider a simplified 3D model without the ‘Newspaper’ variable. The simplified model can be represented as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-dac5e24f-3ce0-48a9-8d8e-0d46486e2535">
<span class="eqno">()<a class="headerlink" href="#equation-dac5e24f-3ce0-48a9-8d8e-0d46486e2535" title="Permalink to this equation">#</a></span>\[\begin{equation}sales = \beta_0 + \beta_1 \times TV + \beta_2 \times \text{Radio}\end{equation}\]</div>
<p>where:</p>
<ul class="simple">
<li><p>‘sales’ represents the dependent variable (e.g., sales).</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> is the intercept term, representing the estimated value of ‘sales’ when both ‘TV’ and ‘Radio’ advertising budgets are zero.</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span> and <span class="math notranslate nohighlight">\(\beta_2\)</span> are the regression coefficients associated with ‘TV’ and ‘Radio’, respectively. They represent the average change in ‘sales’ for a one-unit increase in the corresponding advertising variable, while holding the other variable fixed.</p></li>
</ul>
<p>Using this simplified model, we can create a 3D diagram to visualize the relationship between ‘sales’, ‘TV’, and ‘Radio’ advertising data. A 3D plot allows us to explore the sales outcome based on different combinations of ‘TV’ and ‘Radio’ advertising expenditures.</p>
<p>It’s important to keep in mind that a simplified model may not capture all the nuances and potential interactions between variables that a more complex model could. The decision to include or exclude variables from the model should be based on careful analysis, statistical significance, and domain knowledge.</p>
<p>If you have the dataset and the necessary libraries (e.g., <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">mpl_toolkits.mplot3d</span></code>) in Python, you can create a 3D plot using the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;../mystyle.mplstyle&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AdvertisingPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">plot_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TV&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Radio&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span>
                   <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;TV Advertising&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Radio Advertising&#39;</span><span class="p">)</span>
        
        <span class="c1"># Rotate the plot to better view the z-axis label</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
        
        <span class="c1"># Set the z-axis label after adjusting the view</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span>
        
        <span class="c1"># Set the title for the plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;3D Scatter Plot of Advertising Data&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Assuming you have data stored in a pandas DataFrame named &#39;Advertising&#39;</span>
<span class="n">advertising_data</span> <span class="o">=</span> <span class="n">AdvertisingPlotter</span><span class="p">(</span><span class="n">Advertising</span><span class="p">)</span>
<span class="n">advertising_data</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/41959994850f4c0cbe6104865d136725a0bf1bc6e371e831161d71d9dacfed2f.png" src="../_images/41959994850f4c0cbe6104865d136725a0bf1bc6e371e831161d71d9dacfed2f.png" />
</div>
</div>
<p>In this plot, ‘TV Advertising’ and ‘Radio Advertising’ are represented on the X and Y axes, respectively, and ‘Sales’ is represented on the Z axis. Each point in the 3D space corresponds to a data point with specific values for ‘TV’, ‘Radio’, and ‘Sales’. The plot helps visualize how ‘TV’ and ‘Radio’ advertising budgets relate to the sales outcome in the 3D space.</p>
<p>In linear regression modeling, we have the flexibility to define our linear model in various ways, including adding interaction terms between predictor variables. In the provided example, we are considering a linear model that uses ‘Radio’, ‘TV’, and an interaction term between the two (‘Radio’ multiplied by ‘TV’) to predict ‘Sales’. The model can be expressed in two equivalent forms:</p>
<ol class="arabic simple">
<li><p><strong>Additive Model Form</strong>:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-2fefab47-97b2-43e3-80fc-d73a5552ab1e">
<span class="eqno">()<a class="headerlink" href="#equation-2fefab47-97b2-43e3-80fc-d73a5552ab1e" title="Permalink to this equation">#</a></span>\[\begin{equation}Sales = \beta_0 + \beta_1 \times TV + \beta_2 \times \text{Radio} + \beta_3 \times (\text{Radio} \times \text{TV}) + \epsilon\end{equation}\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Multiplicative Model Form</strong>:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-01ffdcf2-a9c8-4063-98e7-d7a4d0ff99a4">
<span class="eqno">()<a class="headerlink" href="#equation-01ffdcf2-a9c8-4063-98e7-d7a4d0ff99a4" title="Permalink to this equation">#</a></span>\[\begin{equation}Sales = \beta_0 + (\beta_1 + \beta_3 \times \text{Radio}) \times \text{TV} + \beta_2 \times \text{Radio} + \epsilon\end{equation}\]</div>
<p>Both forms of the model yield the same predictions for ‘Sales’ based on the values of ‘TV’ and ‘Radio’. The difference lies in how the model parameters (<span class="math notranslate nohighlight">\(\beta_0\)</span>, <span class="math notranslate nohighlight">\(\beta_1\)</span>, <span class="math notranslate nohighlight">\(\beta_2\)</span>, and <span class="math notranslate nohighlight">\(\beta_3\)</span>) are interpreted in each form:</p>
<ul class="simple">
<li><p>In the additive model form, <span class="math notranslate nohighlight">\(\beta_1\)</span> represents the effect of ‘TV’ on ‘Sales’, <span class="math notranslate nohighlight">\(\beta_2\)</span> represents the effect of ‘Radio’ on ‘Sales’, and <span class="math notranslate nohighlight">\(\beta_3\)</span> represents the additional effect on ‘Sales’ due to the interaction between ‘TV’ and ‘Radio’.</p></li>
<li><p>In the multiplicative model form, <span class="math notranslate nohighlight">\(\beta_1 + \beta_3 \times \text{Radio}\)</span> represents the combined effect of ‘TV’ and the interaction term (<span class="math notranslate nohighlight">\(\text{Radio} \times \text{TV}\)</span>) on ‘Sales’, while <span class="math notranslate nohighlight">\(\beta_2\)</span> still represents the effect of ‘Radio’ on ‘Sales’.</p></li>
</ul>
<p>Both forms allow us to examine the contributions of ‘TV’, ‘Radio’, and their interaction to the prediction of ‘Sales’. The decision to include interaction terms depends on the nature of the data and the research question at hand. Interaction terms are used when there is reason to believe that the combined effect of two predictor variables is not simply the sum of their individual effects.</p>
<p>In summary, both the additive and multiplicative forms of the linear model are valid representations of the same underlying relationship between the predictor variables and the outcome. The choice between the two forms depends on the specific context of the analysis and the hypotheses being tested.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV + Radio + TV*Radio&#39;</span><span class="p">,</span> <span class="n">Advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Sales   R-squared:                       0.968
Model:                            OLS   Adj. R-squared:                  0.967
Method:                 Least Squares   F-statistic:                     1963.
Date:                Thu, 12 Oct 2023   Prob (F-statistic):          6.68e-146
Time:                        20:15:48   Log-Likelihood:                -270.14
No. Observations:                 200   AIC:                             548.3
Df Residuals:                     196   BIC:                             561.5
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      6.7502      0.248     27.233      0.000       6.261       7.239
TV             0.0191      0.002     12.699      0.000       0.016       0.022
Radio          0.0289      0.009      3.241      0.001       0.011       0.046
TV:Radio       0.0011   5.24e-05     20.727      0.000       0.001       0.001
==============================================================================
Omnibus:                      128.132   Durbin-Watson:                   2.224
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1183.719
Skew:                          -2.323   Prob(JB):                    9.09e-258
Kurtosis:                      13.975   Cond. No.                     1.80e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.8e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_bf15e_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 100.0%, transparent 100.0%);
}
#T_bf15e_row0_col1, #T_bf15e_row1_col1, #T_bf15e_row2_col1, #T_bf15e_row3_col1 {
  background-color: DimGray;
  color: White;
}
#T_bf15e_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.3%, transparent 0.3%);
}
#T_bf15e_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.4%, transparent 0.4%);
}
#T_bf15e_row3_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.0%, transparent 0.0%);
}
</style>
<table id="T_bf15e">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_bf15e_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_bf15e_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_bf15e_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_bf15e_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_bf15e_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_bf15e_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_bf15e_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_bf15e_row0_col0" class="data row0 col0" >6.7502e+00</td>
      <td id="T_bf15e_row0_col1" class="data row0 col1" >2.4800e-01</td>
      <td id="T_bf15e_row0_col2" class="data row0 col2" >27.233000</td>
      <td id="T_bf15e_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_bf15e_row0_col4" class="data row0 col4" >6.261000</td>
      <td id="T_bf15e_row0_col5" class="data row0 col5" >7.239000</td>
    </tr>
    <tr>
      <th id="T_bf15e_level0_row1" class="row_heading level0 row1" >TV</th>
      <td id="T_bf15e_row1_col0" class="data row1 col0" >1.9100e-02</td>
      <td id="T_bf15e_row1_col1" class="data row1 col1" >2.0000e-03</td>
      <td id="T_bf15e_row1_col2" class="data row1 col2" >12.699000</td>
      <td id="T_bf15e_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_bf15e_row1_col4" class="data row1 col4" >0.016000</td>
      <td id="T_bf15e_row1_col5" class="data row1 col5" >0.022000</td>
    </tr>
    <tr>
      <th id="T_bf15e_level0_row2" class="row_heading level0 row2" >Radio</th>
      <td id="T_bf15e_row2_col0" class="data row2 col0" >2.8900e-02</td>
      <td id="T_bf15e_row2_col1" class="data row2 col1" >9.0000e-03</td>
      <td id="T_bf15e_row2_col2" class="data row2 col2" >3.241000</td>
      <td id="T_bf15e_row2_col3" class="data row2 col3" >1.0000e-03</td>
      <td id="T_bf15e_row2_col4" class="data row2 col4" >0.011000</td>
      <td id="T_bf15e_row2_col5" class="data row2 col5" >0.046000</td>
    </tr>
    <tr>
      <th id="T_bf15e_level0_row3" class="row_heading level0 row3" >TV:Radio</th>
      <td id="T_bf15e_row3_col0" class="data row3 col0" >1.1000e-03</td>
      <td id="T_bf15e_row3_col1" class="data row3 col1" >5.2400e-05</td>
      <td id="T_bf15e_row3_col2" class="data row3 col2" >20.727000</td>
      <td id="T_bf15e_row3_col3" class="data row3 col3" >0.0000e+00</td>
      <td id="T_bf15e_row3_col4" class="data row3 col4" >0.001000</td>
      <td id="T_bf15e_row3_col5" class="data row3 col5" >0.001000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can achieve the same using scikit-learn as well. It’s important to note that you don’t have to use a class definition to complete this task.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="k">def</span> <span class="nf">generate_regression_surface</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">Radio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">TV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Radio</span><span class="p">,</span> <span class="n">TV</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">B1</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;Radio&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">B2</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;TV&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">B1</span> <span class="o">*</span> <span class="n">B2</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;TV:Radio&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">Z</span>

<span class="k">def</span> <span class="nf">plot_3d</span><span class="p">(</span><span class="n">Results</span><span class="p">,</span> <span class="n">Advertising</span><span class="p">):</span>
    
    <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">generate_regression_surface</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Regression: Sales ~ TV + Radio + TV * Radio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

    <span class="c1"># Customize this part if you have the original data points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">Advertising</span><span class="o">.</span><span class="n">Radio</span><span class="p">,</span> <span class="n">Advertising</span><span class="o">.</span><span class="n">TV</span><span class="p">,</span> <span class="n">Advertising</span><span class="o">.</span><span class="n">Sales</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radio&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;TV&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_3d</span><span class="p">(</span><span class="n">Results</span><span class="p">,</span> <span class="n">Advertising</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d3e47f7ad7c03c8b3a48cf430bcf96e1d979ce0ecbd15c7d10e63be625299281.png" src="../_images/d3e47f7ad7c03c8b3a48cf430bcf96e1d979ce0ecbd15c7d10e63be625299281.png" />
</div>
</div>
<p>We can achieve the same using scikit-learn as well. It’s important to note that you don’t have to use a class definition to complete this task.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="k">class</span> <span class="nc">LinearRegression3DPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ratio_TV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Radio&#39;</span><span class="p">]</span><span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TV&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Radio&#39;</span><span class="p">,</span> <span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="s1">&#39;Ratio_TV&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Sales</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">fit_linear_regression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">coef_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">intercept_</span>

    <span class="k">def</span> <span class="nf">get_regression_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">coef_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Radio: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, TV: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, Ratio_TV: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">coef_str</span>

    <span class="k">def</span> <span class="nf">generate_regression_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Radio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">TV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Radio</span><span class="p">,</span> <span class="n">TV</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TV</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">Radio</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
            <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">+</span> <span class="n">B1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">B2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>\
                       <span class="o">+</span> <span class="n">B1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span><span class="n">B2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">B1</span> <span class="o">=</span> <span class="n">B1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B2</span> <span class="o">=</span> <span class="n">B2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span>

    <span class="k">def</span> <span class="nf">plot_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Regression: Sales ~ Radio + TV + Ratio * TV&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Radio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Sales</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Radio&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;TV&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Example usage:</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Assuming you have data stored in a pandas DataFrame named &#39;Advertising&#39;</span>
    <span class="n">advertising_data</span> <span class="o">=</span> <span class="n">LinearRegression3DPlotter</span><span class="p">(</span><span class="n">Advertising</span><span class="p">)</span>
    <span class="n">advertising_data</span><span class="o">.</span><span class="n">fit_linear_regression</span><span class="p">()</span>
    <span class="n">coef_str</span> <span class="o">=</span> <span class="n">advertising_data</span><span class="o">.</span><span class="n">get_regression_results</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficients:&quot;</span><span class="p">,</span> <span class="n">coef_str</span><span class="p">)</span>
    <span class="n">advertising_data</span><span class="o">.</span><span class="n">generate_regression_surface</span><span class="p">()</span>
    <span class="n">advertising_data</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Coefficients: Radio: 0.02886034, TV: 0.01910107, Ratio_TV: 0.00108649
</pre></div>
</div>
<img alt="../_images/5b1efe5118c39a4a24f17ae1ed229ec7216f216c34f6d77e9032acc99058a9ae.png" src="../_images/5b1efe5118c39a4a24f17ae1ed229ec7216f216c34f6d77e9032acc99058a9ae.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library in Python offers a function that facilitates the visualization of the influence of individual data points, particularly valuable in the context of multivariable regressions. To comprehend this topic, let’s delve into the key components:</p>
<ol class="arabic simple">
<li><p><strong>Studentized Residuals:</strong> Residuals denote the disparities between the actual values of the dependent variable and the values predicted by the regression model. Studentized residuals are these residuals that have been normalized by dividing them by their estimated standard deviation. This normalization standardizes the residuals, rendering them comparable, and assists in the identification of outliers or atypical data points that might wield a significant influence on the outcomes of the regression analysis.</p></li>
<li><p><strong>Leverage:</strong> Leverage gauges the extent to which the independent variables of a data point deviate from the average values of the independent variables. Leverage provides insight into the impact that a specific data point wields on the computed coefficients of the regression model.</p></li>
<li><p><strong>Influence Plot:</strong> An influence plot takes the form of a graphical representation that illustrates the interrelation between the studentized residuals and the leverage of each individual data point within a regression analysis. This visual representation offers a means to detect data points with substantial influence on the regression model. In simpler terms, the plot facilitates the identification of data points whose removal would bring about significant alterations in the outcomes of the regression analysis.</p></li>
</ol>
<p>When considering all these elements collectively, the explanation provided pertains to the generation of a plot using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. This plot showcases studentized residuals, indicating the extent of each data point’s deviation from the regression line in standardized units, on the vertical axis. Simultaneously, it displays the leverage, indicating how far a data point’s predictor values differ from the mean, on the horizontal axis. This graphical representation aids in identifying data points that possess substantial influence, potentially impacting the regression model’s parameters and predictions. As a diagnostic tool, it furnishes a means to comprehend the individual data points’ effects on the overall regression analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">influence_plot</span><span class="p">(</span><span class="n">Results</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1f5b0cd8b963d000e9422e7aefb5ea9815a7d8d23cbd87eff11f7114835a19e7.png" src="../_images/1f5b0cd8b963d000e9422e7aefb5ea9815a7d8d23cbd87eff11f7114835a19e7.png" />
</div>
</div>
<p><font color='Blue'><b>Example</b></font>:
We will explore the <strong>ISLR Credit dataset</strong> <span id="id3">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>. The dataset contains information on the average credit card debt (balance) for a number of individuals, along with several quantitative predictors:</p>
<ol class="arabic simple">
<li><p><strong>Age</strong>: The age of the individuals.</p></li>
<li><p><strong>Cards</strong>: The number of credit cards held by each individual.</p></li>
<li><p><strong>Education</strong>: The number of years of education for each individual.</p></li>
<li><p><strong>Income</strong>: The income of each individual in thousands of dollars.</p></li>
<li><p><strong>Limit</strong>: The credit limit for each individual.</p></li>
<li><p><strong>Rating</strong>: The credit rating of each individual.</p></li>
</ol>
<p>The dataset provides valuable insights into the relationship between credit card debt and the various predictor variables. It can be used for various statistical analyses, predictive modeling, and machine learning tasks.</p>
<p>To access the dataset, you can follow the provided link <a class="reference external" href="https://www.statlearning.com/resources-python">here</a>. The link will direct you to the relevant resources for accessing and working with the ISLR Credit dataset using Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the Credit dataset from the provided link using wget (You may need to install wget first)</span>
<span class="c1"># https://www.statlearning.com/s/Credit.csv</span>

<span class="c1"># Import the necessary libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the Credit dataset into a pandas DataFrame</span>
<span class="n">Credit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Credit.csv&#39;</span><span class="p">)</span>

<span class="c1"># Display the first 10 rows</span>
<span class="n">display</span><span class="p">(</span><span class="n">Credit</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Income</th>
      <th>Limit</th>
      <th>Rating</th>
      <th>Cards</th>
      <th>Age</th>
      <th>Education</th>
      <th>Own</th>
      <th>Student</th>
      <th>Married</th>
      <th>Region</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.891</td>
      <td>3606</td>
      <td>283</td>
      <td>2</td>
      <td>34</td>
      <td>11</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>South</td>
      <td>333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>106.025</td>
      <td>6645</td>
      <td>483</td>
      <td>3</td>
      <td>82</td>
      <td>15</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>West</td>
      <td>903</td>
    </tr>
    <tr>
      <th>2</th>
      <td>104.593</td>
      <td>7075</td>
      <td>514</td>
      <td>4</td>
      <td>71</td>
      <td>11</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>West</td>
      <td>580</td>
    </tr>
    <tr>
      <th>3</th>
      <td>148.924</td>
      <td>9504</td>
      <td>681</td>
      <td>3</td>
      <td>36</td>
      <td>11</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>West</td>
      <td>964</td>
    </tr>
    <tr>
      <th>4</th>
      <td>55.882</td>
      <td>4897</td>
      <td>357</td>
      <td>2</td>
      <td>68</td>
      <td>16</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
      <td>South</td>
      <td>331</td>
    </tr>
    <tr>
      <th>5</th>
      <td>80.180</td>
      <td>8047</td>
      <td>569</td>
      <td>4</td>
      <td>77</td>
      <td>10</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>South</td>
      <td>1151</td>
    </tr>
    <tr>
      <th>6</th>
      <td>20.996</td>
      <td>3388</td>
      <td>259</td>
      <td>2</td>
      <td>37</td>
      <td>12</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>East</td>
      <td>203</td>
    </tr>
    <tr>
      <th>7</th>
      <td>71.408</td>
      <td>7114</td>
      <td>512</td>
      <td>2</td>
      <td>87</td>
      <td>9</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>West</td>
      <td>872</td>
    </tr>
    <tr>
      <th>8</th>
      <td>15.125</td>
      <td>3300</td>
      <td>266</td>
      <td>5</td>
      <td>66</td>
      <td>13</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>South</td>
      <td>279</td>
    </tr>
    <tr>
      <th>9</th>
      <td>71.061</td>
      <td>6819</td>
      <td>491</td>
      <td>3</td>
      <td>41</td>
      <td>19</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>East</td>
      <td>1350</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sns.pairplot</span></code> function generates a grid of scatterplots and histograms to visualize the relationships between the selected variables in the “Credit” dataset. The selected variables are: ‘Limit’, ‘Cards’, ‘Age’, ‘Education’, ‘Own’, ‘Student’, ‘Married’, ‘Region’, and ‘Balance’. Let’s explain the results of this pair plot:</p>
<ol class="arabic simple">
<li><p><strong>Scatterplots</strong>: The off-diagonal panels (those not on the main diagonal) display scatterplots that show the relationships between pairs of quantitative variables. For example, the scatterplot in the row corresponding to ‘Balance’ and the column corresponding to ‘Age’ shows how the ‘Balance’ (average credit card debt) changes with ‘Age’. Similarly, the scatterplot in the row corresponding to ‘Age’ and the column corresponding to ‘Cards’ displays how the number of credit cards (‘Cards’) changes with age.</p></li>
<li><p><strong>Histograms</strong>: The diagonal panels display histograms for each individual variable. These histograms show the distribution of each variable. For instance, the histogram in the ‘Balance’ row and ‘Balance’ column shows the distribution of credit card balances in the dataset.</p></li>
<li><p><strong>Qualitative Variables</strong>: The pair plot can also handle qualitative variables by using color or markers to distinguish different categories. For example, the ‘Own’, ‘Student’, ‘Married’, and ‘Region’ variables are qualitative, and the pair plot may use different colors or markers to represent different categories within these variables. This allows us to visually explore how qualitative variables relate to quantitative variables or each other.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="c1"># Create a pair plot to visualize the relationships between selected variables using seaborn</span>
<span class="c1"># The pair plot displays scatter plots for all combinations of the selected variables and histograms along the diagonal</span>
<span class="c1"># The variables &#39;Limit&#39;, &#39;Cards&#39;, &#39;Age&#39;, &#39;Education&#39;, &#39;Balance&#39;, and &#39;Student&#39; are selected for the analysis</span>
<span class="c1"># The &#39;Student&#39; variable is used as the hue (color) to distinguish different student statuses</span>
<span class="c1"># The corner parameter is set to True to display only the lower triangle of the pair plot to avoid redundancy</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">Credit</span><span class="p">[[</span><span class="s1">&#39;Income&#39;</span><span class="p">,</span><span class="s1">&#39;Limit&#39;</span><span class="p">,</span> <span class="s1">&#39;Cards&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Balance&#39;</span><span class="p">,</span> <span class="s1">&#39;Student&#39;</span><span class="p">]],</span>
                 <span class="n">palette</span> <span class="o">=</span> <span class="s1">&#39;bright&#39;</span><span class="p">,</span>
                 <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Student&quot;</span><span class="p">,</span>
                 <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">height</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Use KDE (Kernel Density Estimation) plots for the lower triangle of the pair plot</span>
<span class="c1"># This overlays smoothed contour plots on the scatterplots to visualize the distribution better</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.1&quot;</span><span class="p">)</span>

<span class="c1"># Display the pair plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\hatef\anaconda3\envs\jbook\lib\site-packages\seaborn\axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
</pre></div>
</div>
<img alt="../_images/1f74b4caed53215007878b6f917849f576a8677460a06d3ee116405aebc26f5f.png" src="../_images/1f74b4caed53215007878b6f917849f576a8677460a06d3ee116405aebc26f5f.png" />
</div>
</div>
<p>In this code, we first import the necessary libraries (<code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>). Then, we load the Credit dataset into a pandas DataFrame named <code class="docutils literal notranslate"><span class="pre">credit</span></code>. Note that you should replace <code class="docutils literal notranslate"><span class="pre">'Credit.csv'</span></code> with the appropriate file path if you haven’t loaded the dataset yet.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sns.pairplot</span></code> function is used to create a pair plot, which displays scatter plots for all combinations of the selected variables (‘Limit’, ‘Cards’, ‘Age’, ‘Education’, ‘Balance’, and ‘Student’) and histograms along the diagonal. The ‘Student’ variable is used as the hue (color) parameter to distinguish different student statuses. The corner parameter is set to True to display only the lower triangle of the pair plot to avoid redundancy, making the plot less cluttered.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">g.map_lower(sns.kdeplot,</span> <span class="pre">levels=4,</span> <span class="pre">color=&quot;.2&quot;)</span></code> line overlays KDE plots (Kernel Density Estimation) on the lower triangle of the pair plot, which provides smoothed contour plots to visualize the distribution of the variables better.</p>
<p>Finally, we use <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> to display the pair plot in the output. The plot will show scatter plots of each variable against every other variable (limited to the lower triangle), histograms along the diagonal for each individual variable, and KDE plots for the lower triangle. The different colors of the scatter plots and KDE plots represent different student statuses, allowing us to explore the relationship between student status and the other selected variables.</p>
<div class="section" id="qualitative-predictors-with-only-two-levels">
<h2>Qualitative Predictors with Only Two Levels<a class="headerlink" href="#qualitative-predictors-with-only-two-levels" title="Permalink to this headline">#</a></h2>
<p>When dealing with predictors that have only two levels (binary variables), we can create indicator or dummy variables to represent these levels numerically.</p>
<p>For example, to handle the predictor variable “Married,” which has two levels (Married and not Married), we can create a binary indicator or dummy variable to represent these levels numerically.</p>
<p>Let’s create a new binary variable, denoted as <span class="math notranslate nohighlight">\(x_i\)</span>, that takes the following form <span id="id4">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a88cd94d-0ff0-43cf-a071-807568f037bf">
<span class="eqno">()<a class="headerlink" href="#equation-a88cd94d-0ff0-43cf-a071-807568f037bf" title="Permalink to this equation">#</a></span>\[\begin{equation}
x_i = \begin{cases}
1, &amp; \text{if the $i$th person is Married}, \\
0, &amp; \text{if the $i$th person is not Married}.
\end{cases}
\end{equation}\]</div>
<p>The regression equation involving this binary variable would be:</p>
<div class="amsmath math notranslate nohighlight" id="equation-cbaf631b-dae8-42ea-8aa4-7cab16a1c025">
<span class="eqno">()<a class="headerlink" href="#equation-cbaf631b-dae8-42ea-8aa4-7cab16a1c025" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_i = \beta_0 + \beta_1 x_i + \epsilon_i = \begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if the $i$th person is Married}, \\
\beta_0 + \epsilon_i, &amp; \text{if the $i$th person is not Married}.
\end{cases}
\end{equation}\]</div>
<p>In this regression equation, <span class="math notranslate nohighlight">\(\beta_0\)</span> represents the intercept, <span class="math notranslate nohighlight">\(\beta_1\)</span> represents the coefficient associated with the binary variable <span class="math notranslate nohighlight">\(x_i\)</span>, and <span class="math notranslate nohighlight">\(\epsilon_i\)</span> is the error term for the <span class="math notranslate nohighlight">\(i\)</span>th observation. When <span class="math notranslate nohighlight">\(x_i = 1\)</span>, indicating that the <span class="math notranslate nohighlight">\(i\)</span>th person is Married, the equation becomes <span class="math notranslate nohighlight">\(y_i = \beta_0 + \beta_1 + \epsilon_i\)</span>. On the other hand, when <span class="math notranslate nohighlight">\(x_i = 0\)</span>, indicating that the <span class="math notranslate nohighlight">\(i\)</span>th person is not Married, the equation becomes <span class="math notranslate nohighlight">\(y_i = \beta_0 + \epsilon_i\)</span> <span id="id5">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>By using binary variables for predictors with two levels, we can incorporate categorical information into regression models and study how the presence or absence of a particular category influences the response variable. This approach allows us to handle categorical predictors effectively in linear regression models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">_MyCountPlot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># Create a figure and axes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">))</span>

    <span class="c1"># Create a count plot with a specified color palette</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s1">&#39;pastel&#39;</span><span class="p">)</span>

    <span class="c1"># Set labels and title</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Countplot for </span><span class="si">%s</span><span class="s1"> category&#39;</span> <span class="o">%</span> <span class="n">col</span><span class="p">)</span>

    <span class="c1"># Add count values on top of each bar</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">),</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>

    <span class="c1"># Limit x-axis range</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">)</span>

    <span class="c1"># Add grid lines only if &#39;grid&#39; is True</span>
    <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_MyCountPlot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;Married&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Credit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/254cbdd1439cbbf3796c3477bdf58bdefc50a734eb82ccaaccde654e92b149fd.png" src="../_images/254cbdd1439cbbf3796c3477bdf58bdefc50a734eb82ccaaccde654e92b149fd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ C(Married)&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                Balance   R-squared:                       0.000
Model:                            OLS   Adj. R-squared:                 -0.002
Method:                 Least Squares   F-statistic:                   0.01281
Date:                Thu, 12 Oct 2023   Prob (F-statistic):              0.910
Time:                        20:15:57   Log-Likelihood:                -3019.3
No. Observations:                 400   AIC:                             6043.
Df Residuals:                     398   BIC:                             6051.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
Intercept           523.2903     36.974     14.153      0.000     450.601     595.980
C(Married)[T.Yes]    -5.3475     47.244     -0.113      0.910     -98.227      87.532
==============================================================================
Omnibus:                       28.640   Durbin-Watson:                   1.945
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               27.347
Skew:                           0.582   Prob(JB):                     1.15e-06
Kurtosis:                       2.464   Cond. No.                         2.97
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_66ee8_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 1.0%, Lime 1.0%, Lime 100.0%, transparent 100.0%);
}
#T_66ee8_row0_col1, #T_66ee8_row1_col1 {
  background-color: DimGray;
  color: White;
}
#T_66ee8_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 1.0%, transparent 1.0%);
}
</style>
<table id="T_66ee8">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_66ee8_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_66ee8_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_66ee8_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_66ee8_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_66ee8_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_66ee8_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_66ee8_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_66ee8_row0_col0" class="data row0 col0" >5.2329e+02</td>
      <td id="T_66ee8_row0_col1" class="data row0 col1" >3.6974e+01</td>
      <td id="T_66ee8_row0_col2" class="data row0 col2" >14.153000</td>
      <td id="T_66ee8_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_66ee8_row0_col4" class="data row0 col4" >450.601000</td>
      <td id="T_66ee8_row0_col5" class="data row0 col5" >595.980000</td>
    </tr>
    <tr>
      <th id="T_66ee8_level0_row1" class="row_heading level0 row1" >C(Married)[T.Yes]</th>
      <td id="T_66ee8_row1_col0" class="data row1 col0" >-5.3475e+00</td>
      <td id="T_66ee8_row1_col1" class="data row1 col1" >4.7244e+01</td>
      <td id="T_66ee8_row1_col2" class="data row1 col2" >-0.113000</td>
      <td id="T_66ee8_row1_col3" class="data row1 col3" >9.1000e-01</td>
      <td id="T_66ee8_row1_col4" class="data row1 col4" >-98.227000</td>
      <td id="T_66ee8_row1_col5" class="data row1 col5" >87.532000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="qualitative-predictors-with-more-than-two-levels">
<h2>Qualitative Predictors with More than Two Levels<a class="headerlink" href="#qualitative-predictors-with-more-than-two-levels" title="Permalink to this headline">#</a></h2>
<p>When dealing with qualitative predictors that have more than two levels, a single dummy variable cannot represent all possible values. In this situation, we can create additional dummy variables, one for each level of the qualitative predictor. Let’s take the “region” variable as an example, which has three levels: South, West, and East.</p>
<p>We create two dummy variables as follows <span id="id6">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(x_{i1}\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_{i1} = 1\)</span> if the <span class="math notranslate nohighlight">\(i\)</span>th person is from the South</p></li>
<li><p><span class="math notranslate nohighlight">\(x_{i1} = 0\)</span> if the <span class="math notranslate nohighlight">\(i\)</span>th person is not from the South</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(x_{i2}\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_{i2} = 1\)</span> if the <span class="math notranslate nohighlight">\(i\)</span>th person is from the West</p></li>
<li><p><span class="math notranslate nohighlight">\(x_{i2} = 0\)</span> if the <span class="math notranslate nohighlight">\(i\)</span>th person is not from the West</p></li>
</ul>
</li>
</ol>
<p>Then both of these variables can be used in the regression equation to obtain the model:</p>
<div class="amsmath math notranslate nohighlight" id="equation-efc6b26f-e592-45fa-bec0-5ec114ec0b44">
<span class="eqno">()<a class="headerlink" href="#equation-efc6b26f-e592-45fa-bec0-5ec114ec0b44" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \epsilon_i =
\begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if the $i$th person is from the South}, \\
\beta_0 + \beta_2 + \epsilon_i, &amp; \text{if the $i$th person is from the West}, \\
\beta_0 + \epsilon_i, &amp; \text{if the $i$th person is not from the West}.
\end{cases}
\end{equation}\]</div>
<p>Now, <span class="math notranslate nohighlight">\(\beta_0\)</span> can be interpreted as the average credit card balance for individuals from the East (baseline), <span class="math notranslate nohighlight">\(\beta_1\)</span> can be interpreted as the difference in the average balance between people from the South versus the East, and <span class="math notranslate nohighlight">\(\beta_2\)</span> can be interpreted as the difference in the average balance between those from the West versus the East <span id="id7">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>In general, when we have a qualitative predictor with <span class="math notranslate nohighlight">\(k\)</span> levels, we create <span class="math notranslate nohighlight">\(k-1\)</span> dummy variables. The level with no dummy variable (in this case, “East”) is known as the baseline, against which the other levels are compared. This approach allows us to include qualitative predictors with multiple levels in regression models and understand how each level influences the response variable in comparison to the baseline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_MyCountPlot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Credit</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/90b0572a81c752123bbcb0165bef316c0d213230577c97ac75fb79aeaf05bd06.png" src="../_images/90b0572a81c752123bbcb0165bef316c0d213230577c97ac75fb79aeaf05bd06.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ C(Region)&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                Balance   R-squared:                       0.000
Model:                            OLS   Adj. R-squared:                 -0.005
Method:                 Least Squares   F-statistic:                   0.04344
Date:                Thu, 12 Oct 2023   Prob (F-statistic):              0.957
Time:                        20:15:57   Log-Likelihood:                -3019.3
No. Observations:                 400   AIC:                             6045.
Df Residuals:                     397   BIC:                             6057.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
======================================================================================
                         coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------------
Intercept            531.0000     46.319     11.464      0.000     439.939     622.061
C(Region)[T.South]   -12.5025     56.681     -0.221      0.826    -123.935      98.930
C(Region)[T.West]    -18.6863     65.021     -0.287      0.774    -146.515     109.142
==============================================================================
Omnibus:                       28.829   Durbin-Watson:                   1.946
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               27.395
Skew:                           0.581   Prob(JB):                     1.13e-06
Kurtosis:                       2.460   Cond. No.                         4.39
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_80e8b_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 3.4%, Lime 3.4%, Lime 100.0%, transparent 100.0%);
}
#T_80e8b_row0_col1, #T_80e8b_row1_col1, #T_80e8b_row2_col1 {
  background-color: DimGray;
  color: White;
}
#T_80e8b_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 1.1%, Lime 1.1%, Lime 3.4%, transparent 3.4%);
}
#T_80e8b_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 3.4%, transparent 3.4%);
}
</style>
<table id="T_80e8b">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_80e8b_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_80e8b_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_80e8b_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_80e8b_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_80e8b_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_80e8b_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_80e8b_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_80e8b_row0_col0" class="data row0 col0" >5.3100e+02</td>
      <td id="T_80e8b_row0_col1" class="data row0 col1" >4.6319e+01</td>
      <td id="T_80e8b_row0_col2" class="data row0 col2" >11.464000</td>
      <td id="T_80e8b_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_80e8b_row0_col4" class="data row0 col4" >439.939000</td>
      <td id="T_80e8b_row0_col5" class="data row0 col5" >622.061000</td>
    </tr>
    <tr>
      <th id="T_80e8b_level0_row1" class="row_heading level0 row1" >C(Region)[T.South]</th>
      <td id="T_80e8b_row1_col0" class="data row1 col0" >-1.2502e+01</td>
      <td id="T_80e8b_row1_col1" class="data row1 col1" >5.6681e+01</td>
      <td id="T_80e8b_row1_col2" class="data row1 col2" >-0.221000</td>
      <td id="T_80e8b_row1_col3" class="data row1 col3" >8.2600e-01</td>
      <td id="T_80e8b_row1_col4" class="data row1 col4" >-123.935000</td>
      <td id="T_80e8b_row1_col5" class="data row1 col5" >98.930000</td>
    </tr>
    <tr>
      <th id="T_80e8b_level0_row2" class="row_heading level0 row2" >C(Region)[T.West]</th>
      <td id="T_80e8b_row2_col0" class="data row2 col0" >-1.8686e+01</td>
      <td id="T_80e8b_row2_col1" class="data row2 col1" >6.5021e+01</td>
      <td id="T_80e8b_row2_col2" class="data row2 col2" >-0.287000</td>
      <td id="T_80e8b_row2_col3" class="data row2 col3" >7.7400e-01</td>
      <td id="T_80e8b_row2_col4" class="data row2 col4" >-146.515000</td>
      <td id="T_80e8b_row2_col5" class="data row2 col5" >109.142000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><font color='Blue'><b>Example</b></font>: In the previous example, we considered the concept of interactions in the context of the Credit dataset. We wanted to predict the credit card balance (response variable) using income (quantitative) and student status (qualitative) variables.</p>
<p>Without an interaction term, the model takes the form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-670c9d0e-2152-4eb9-86c0-8c46a0f83584">
<span class="eqno">()<a class="headerlink" href="#equation-670c9d0e-2152-4eb9-86c0-8c46a0f83584" title="Permalink to this equation">#</a></span>\[\begin{align}
\text{balance}_i &amp; \approx \beta_0 + \beta_1 \times \text{income}_i + \begin{cases}
\beta_2, &amp; \text{if the $i$th person is a student}, \\
0, &amp; \text{if the $i$th person is not a student}.
\end{cases}
\notag \\
&amp; = \begin{cases}
\beta_1 \times \text{income}_i + (\beta_0 + \beta_2), &amp; \text{if the $i$th person is a student}, \\
\beta_1 \times \text{income}_i + \beta_0, &amp; \text{if the $i$th person is not a student}.
\end{cases}
\end{align}\]</div>
<p>As shown in the left-hand panel of Figure 3.7, this model fits two parallel lines to the data, one for students and one for non-students. The lines have different intercepts, <span class="math notranslate nohighlight">\(\beta_0 + \beta_2\)</span> versus <span class="math notranslate nohighlight">\(\beta_0\)</span>, but the same slope, <span class="math notranslate nohighlight">\(\beta_1\)</span>. This implies that the average effect on credit card balance of a one-unit increase in income does not depend on whether or not the individual is a student. However, in reality, a change in income may have a different effect on the credit card balance of a student versus a non-student <span id="id8">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>To address this limitation, we add an interaction variable by multiplying income with the dummy variable for student. The new model becomes:</p>
<div class="math notranslate nohighlight" id="equation-eq-student">
<span class="eqno">()<a class="headerlink" href="#equation-eq-student" title="Permalink to this equation">#</a></span>\[\begin{split}\text{balance}_i &amp; \approx \beta_0 + \beta_1 \times \text{income}_i + \begin{cases}
\beta_2 + \beta_3 \times \text{income}_i, &amp; \text{if the $i$th person is a student}, 
\\
0, &amp; \text{if the $i$th person is not a student}.
\end{cases}
\notag \\
&amp; = \begin{cases}
(\beta_0 + \beta_2) + (\beta_1 + \beta_3) \times \text{income}_i, &amp; \text{if the $i$th person is a student}, \\
\beta_0 + \beta_1 \times \text{income}_i, &amp; \text{if the $i$th person is not a student}.
\end{cases}\end{split}\]</div>
<p>As illustrated in the right-hand panel of Figure 3.7, this model also fits two regression lines for students and non-students. The lines have different intercepts, <span class="math notranslate nohighlight">\(\beta_0 + \beta_2\)</span> versus <span class="math notranslate nohighlight">\(\beta_0\)</span>, as well as different slopes, <span class="math notranslate nohighlight">\(\beta_1 + \beta_3\)</span> versus <span class="math notranslate nohighlight">\(\beta_1\)</span>. This allows for the possibility that changes in income may affect the credit card balances of students and non-students differently.</p>
<p>Adding an interaction term enables the model to capture varying effects of income on credit card balances based on student status, making it more flexible and accurate in representing the data. The interaction term allows us to account for potential differences in the relationship between income and credit card balance between students and non-students.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_MyCountPlot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Credit</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eba9987ad392253a2cea79adaadf1d7af0e37af88f4163fcee7673371fefa353.png" src="../_images/eba9987ad392253a2cea79adaadf1d7af0e37af88f4163fcee7673371fefa353.png" />
</div>
</div>
<p><strong>Regression 1 - without interaction term:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results1</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ Income + Student&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg1</span> <span class="o">=</span> <span class="n">Results1</span><span class="o">.</span><span class="n">params</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                Balance   R-squared:                       0.277
Model:                            OLS   Adj. R-squared:                  0.274
Method:                 Least Squares   F-statistic:                     76.22
Date:                Thu, 12 Oct 2023   Prob (F-statistic):           9.64e-29
Time:                        20:15:57   Log-Likelihood:                -2954.4
No. Observations:                 400   AIC:                             5915.
Df Residuals:                     397   BIC:                             5927.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept        211.1430     32.457      6.505      0.000     147.333     274.952
Student[T.Yes]   382.6705     65.311      5.859      0.000     254.272     511.069
Income             5.9843      0.557     10.751      0.000       4.890       7.079
==============================================================================
Omnibus:                      119.719   Durbin-Watson:                   1.951
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               23.617
Skew:                           0.252   Prob(JB):                     7.44e-06
Kurtosis:                       1.922   Cond. No.                         192.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_807d4_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 55.2%, transparent 55.2%);
}
#T_807d4_row0_col1, #T_807d4_row1_col1, #T_807d4_row2_col1 {
  background-color: DimGray;
  color: White;
}
#T_807d4_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 100.0%, transparent 100.0%);
}
#T_807d4_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 1.6%, transparent 1.6%);
}
</style>
<table id="T_807d4">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_807d4_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_807d4_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_807d4_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_807d4_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_807d4_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_807d4_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_807d4_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_807d4_row0_col0" class="data row0 col0" >2.1114e+02</td>
      <td id="T_807d4_row0_col1" class="data row0 col1" >3.2457e+01</td>
      <td id="T_807d4_row0_col2" class="data row0 col2" >6.505000</td>
      <td id="T_807d4_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_807d4_row0_col4" class="data row0 col4" >147.333000</td>
      <td id="T_807d4_row0_col5" class="data row0 col5" >274.952000</td>
    </tr>
    <tr>
      <th id="T_807d4_level0_row1" class="row_heading level0 row1" >Student[T.Yes]</th>
      <td id="T_807d4_row1_col0" class="data row1 col0" >3.8267e+02</td>
      <td id="T_807d4_row1_col1" class="data row1 col1" >6.5311e+01</td>
      <td id="T_807d4_row1_col2" class="data row1 col2" >5.859000</td>
      <td id="T_807d4_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_807d4_row1_col4" class="data row1 col4" >254.272000</td>
      <td id="T_807d4_row1_col5" class="data row1 col5" >511.069000</td>
    </tr>
    <tr>
      <th id="T_807d4_level0_row2" class="row_heading level0 row2" >Income</th>
      <td id="T_807d4_row2_col0" class="data row2 col0" >5.9843e+00</td>
      <td id="T_807d4_row2_col1" class="data row2 col1" >5.5700e-01</td>
      <td id="T_807d4_row2_col2" class="data row2 col2" >10.751000</td>
      <td id="T_807d4_row2_col3" class="data row2 col3" >0.0000e+00</td>
      <td id="T_807d4_row2_col4" class="data row2 col4" >4.890000</td>
      <td id="T_807d4_row2_col5" class="data row2 col5" >7.079000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Regression 2 - with interaction term:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ Income + Income*Student&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg2</span> <span class="o">=</span> <span class="n">Results2</span><span class="o">.</span><span class="n">params</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                Balance   R-squared:                       0.280
Model:                            OLS   Adj. R-squared:                  0.274
Method:                 Least Squares   F-statistic:                     51.30
Date:                Thu, 12 Oct 2023   Prob (F-statistic):           4.94e-28
Time:                        20:15:57   Log-Likelihood:                -2953.7
No. Observations:                 400   AIC:                             5915.
Df Residuals:                     396   BIC:                             5931.
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
=========================================================================================
                            coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------------
Intercept               200.6232     33.698      5.953      0.000     134.373     266.873
Student[T.Yes]          476.6758    104.351      4.568      0.000     271.524     681.827
Income                    6.2182      0.592     10.502      0.000       5.054       7.382
Income:Student[T.Yes]    -1.9992      1.731     -1.155      0.249      -5.403       1.404
==============================================================================
Omnibus:                      107.788   Durbin-Watson:                   1.952
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               22.158
Skew:                           0.228   Prob(JB):                     1.54e-05
Kurtosis:                       1.941   Cond. No.                         309.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_dbe01_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.4%, Lime 0.4%, Lime 42.3%, transparent 42.3%);
}
#T_dbe01_row0_col1, #T_dbe01_row1_col1, #T_dbe01_row2_col1, #T_dbe01_row3_col1 {
  background-color: DimGray;
  color: White;
}
#T_dbe01_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.4%, Lime 0.4%, Lime 100.0%, transparent 100.0%);
}
#T_dbe01_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 0.4%, Lime 0.4%, Lime 1.7%, transparent 1.7%);
}
#T_dbe01_row3_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 0.4%, transparent 0.4%);
}
</style>
<table id="T_dbe01">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_dbe01_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_dbe01_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_dbe01_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_dbe01_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_dbe01_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_dbe01_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_dbe01_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_dbe01_row0_col0" class="data row0 col0" >2.0062e+02</td>
      <td id="T_dbe01_row0_col1" class="data row0 col1" >3.3698e+01</td>
      <td id="T_dbe01_row0_col2" class="data row0 col2" >5.953000</td>
      <td id="T_dbe01_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_dbe01_row0_col4" class="data row0 col4" >134.373000</td>
      <td id="T_dbe01_row0_col5" class="data row0 col5" >266.873000</td>
    </tr>
    <tr>
      <th id="T_dbe01_level0_row1" class="row_heading level0 row1" >Student[T.Yes]</th>
      <td id="T_dbe01_row1_col0" class="data row1 col0" >4.7668e+02</td>
      <td id="T_dbe01_row1_col1" class="data row1 col1" >1.0435e+02</td>
      <td id="T_dbe01_row1_col2" class="data row1 col2" >4.568000</td>
      <td id="T_dbe01_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_dbe01_row1_col4" class="data row1 col4" >271.524000</td>
      <td id="T_dbe01_row1_col5" class="data row1 col5" >681.827000</td>
    </tr>
    <tr>
      <th id="T_dbe01_level0_row2" class="row_heading level0 row2" >Income</th>
      <td id="T_dbe01_row2_col0" class="data row2 col0" >6.2182e+00</td>
      <td id="T_dbe01_row2_col1" class="data row2 col1" >5.9200e-01</td>
      <td id="T_dbe01_row2_col2" class="data row2 col2" >10.502000</td>
      <td id="T_dbe01_row2_col3" class="data row2 col3" >0.0000e+00</td>
      <td id="T_dbe01_row2_col4" class="data row2 col4" >5.054000</td>
      <td id="T_dbe01_row2_col5" class="data row2 col5" >7.382000</td>
    </tr>
    <tr>
      <th id="T_dbe01_level0_row3" class="row_heading level0 row3" >Income:Student[T.Yes]</th>
      <td id="T_dbe01_row3_col0" class="data row3 col0" >-1.9992e+00</td>
      <td id="T_dbe01_row3_col1" class="data row3 col1" >1.7310e+00</td>
      <td id="T_dbe01_row3_col2" class="data row3 col2" >-1.155000</td>
      <td id="T_dbe01_row3_col3" class="data row3 col3" >2.4900e-01</td>
      <td id="T_dbe01_row3_col4" class="data row3 col4" >-5.403000</td>
      <td id="T_dbe01_row3_col5" class="data row3 col5" >1.404000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># x-axis (Income)</span>
<span class="n">Max_Income</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Credit</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">income</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Max_Income</span><span class="p">)</span>

<span class="c1"># y-axis (Balance without interaction term)</span>
<span class="n">st1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Student[T.Yes]&#39;</span><span class="p">],</span>
                  <span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Student[T.Yes]&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Max_Income</span><span class="o">*</span><span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">])</span>
<span class="n">non_st1</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">],</span> <span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Max_Income</span><span class="o">*</span><span class="n">reg1</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">])</span>

<span class="c1"># y-axis (Balance with interaction term)</span>
<span class="n">st2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Student[T.Yes]&#39;</span><span class="p">],</span>
                         <span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Student[T.Yes]&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">Max_Income</span><span class="o">*</span><span class="p">(</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Income:Student[T.Yes]&#39;</span><span class="p">]))</span>
<span class="n">non_st2</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">],</span> <span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">Max_Income</span><span class="o">*</span><span class="n">reg2</span><span class="p">[</span><span class="s1">&#39;Income&#39;</span><span class="p">])</span>

<span class="c1"># Create the plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Balance with and without interaction term&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">income</span><span class="p">,</span> <span class="n">st1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;OrangeRed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Student&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">income</span><span class="p">,</span> <span class="n">non_st1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;MidnightBlue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Non-Student&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">income</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;OrangeRed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">income</span><span class="p">,</span> <span class="n">non_st2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;MidnightBlue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Balance without interaction term&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Balance with interaction term&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Income&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Income&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Balance&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">))</span>
<span class="c1"># Fig setting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bee74ae21a1def3501575f3e180e18dd02fee1b3d94f1e89d74cf1b93c530d65.png" src="../_images/bee74ae21a1def3501575f3e180e18dd02fee1b3d94f1e89d74cf1b93c530d65.png" />
</div>
</div>
<p>The right-hand panel of the figure illustrates the estimated relationships between income and balance for students and non-students in the regression model <a class="reference internal" href="#equation-eq-student">()</a>.</p>
<p>We observe that the slope of the income-balance relationship for students (<span class="math notranslate nohighlight">\(\beta_1 + \beta_3\)</span>) is lower than the slope for non-students (<span class="math notranslate nohighlight">\(\beta_1\)</span>). This indicates that increases in income are associated with smaller increases in credit card balance among students compared to non-students <span id="id9">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>In other words, for each unit increase in income, the expected change in credit card balance for students is smaller than the expected change in credit card balance for non-students. The interaction term (<span class="math notranslate nohighlight">\(\beta_3\)</span>) captures the difference in the income-balance relationship between students and non-students, allowing us to model the unique effects of income on credit card balances based on student status <span id="id10">[<a class="reference internal" href="../References.html#id3" title="Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani, and Jonathan Taylor. An Introduction to Statistical Learning: with Applications in R. Springer Texts in Statistics. Springer Cham, 2023. ISBN 9783031391897. URL: https://link.springer.com/book/10.1007/978-3-031-38747-0.">James <em>et al.</em>, 2023</a>]</span>.</p>
<p>The presence of the interaction term enables the model to consider the varying effects of income on credit card balances for different groups, making it more flexible and accurate in representing the data. This information is crucial for understanding how income influences credit card balances differently for students and non-students.</p>
<p><font color='Blue'><b>Example:</b></font></p>
<p>In this example, we work on Auto MPG from <a class="reference external" href="http://archive.ics.uci.edu/dataset/9/auto+mpg">UCI Machine Learning Repository</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Provide the correct path to the dataset file you downloaded</span>
<span class="n">dataset_path</span> <span class="o">=</span> <span class="s1">&#39;auto-mpg.data&#39;</span>  <span class="c1"># Replace with the actual file path</span>

<span class="c1"># Define column names based on the dataset&#39;s description</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MPG&#39;</span><span class="p">,</span> <span class="s1">&#39;Cylinders&#39;</span><span class="p">,</span> <span class="s1">&#39;Displacement&#39;</span><span class="p">,</span> <span class="s1">&#39;Horsepower&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Acceleration&#39;</span><span class="p">,</span> <span class="s1">&#39;Model_Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;Car_Name&#39;</span><span class="p">]</span>

<span class="c1"># Read the dataset with column names</span>
<span class="n">auto_mpg_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">,</span>
                          <span class="n">na_values</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">auto_mpg_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="n">auto_mpg_df</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Car_Name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MPG</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Weight</th>
      <th>Acceleration</th>
      <th>Model_Year</th>
      <th>Origin</th>
      <th>Car_Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>chevrolet chevelle malibu</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693.0</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>buick skylark 320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436.0</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>plymouth satellite</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>amc rebel sst</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449.0</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>ford torino</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>393</th>
      <td>27.0</td>
      <td>4</td>
      <td>140.0</td>
      <td>86.0</td>
      <td>2790.0</td>
      <td>15.6</td>
      <td>82</td>
      <td>1</td>
      <td>ford mustang gl</td>
    </tr>
    <tr>
      <th>394</th>
      <td>44.0</td>
      <td>4</td>
      <td>97.0</td>
      <td>52.0</td>
      <td>2130.0</td>
      <td>24.6</td>
      <td>82</td>
      <td>2</td>
      <td>vw pickup</td>
    </tr>
    <tr>
      <th>395</th>
      <td>32.0</td>
      <td>4</td>
      <td>135.0</td>
      <td>84.0</td>
      <td>2295.0</td>
      <td>11.6</td>
      <td>82</td>
      <td>1</td>
      <td>dodge rampage</td>
    </tr>
    <tr>
      <th>396</th>
      <td>28.0</td>
      <td>4</td>
      <td>120.0</td>
      <td>79.0</td>
      <td>2625.0</td>
      <td>18.6</td>
      <td>82</td>
      <td>1</td>
      <td>ford ranger</td>
    </tr>
    <tr>
      <th>397</th>
      <td>31.0</td>
      <td>4</td>
      <td>119.0</td>
      <td>82.0</td>
      <td>2720.0</td>
      <td>19.4</td>
      <td>82</td>
      <td>1</td>
      <td>chevy s-10</td>
    </tr>
  </tbody>
</table>
<p>392 rows × 9 columns</p>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MPG             float64
Cylinders         int64
Displacement    float64
Horsepower      float64
Weight          float64
Acceleration    float64
Model_Year        int64
Origin            int64
Car_Name         object
dtype: object
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple">
<li><p><strong>MPG (Miles per Gallon):</strong> This column represents the fuel efficiency of the vehicle in miles per gallon. It indicates how many miles the vehicle can travel on one gallon of fuel. Higher MPG values signify better fuel efficiency.</p></li>
<li><p><strong>Cylinders:</strong> This column shows the number of cylinders in the engine. It is a measure of the engine’s capacity and power. Common values are 4, 6, and 8 cylinders, indicating four-cylinder, six-cylinder, and eight-cylinder engines, respectively.</p></li>
<li><p><strong>Displacement:</strong> Displacement refers to the engine’s total volume, typically measured in cubic inches (or cubic centimeters). It’s an indicator of the engine’s size and power. A higher displacement often correlates with more power.</p></li>
<li><p><strong>Horsepower:</strong> This column indicates the engine’s horsepower, which is a measure of the engine’s ability to perform work. Higher horsepower values usually mean a more powerful engine.</p></li>
<li><p><strong>Weight:</strong> Weight represents the vehicle’s mass, often in pounds or kilograms. It’s an important factor in fuel efficiency because lighter vehicles tend to have better MPG.</p></li>
<li><p><strong>Acceleration:</strong> This column shows the vehicle’s acceleration performance, typically measured in seconds to reach 60 miles per hour (or 100 kilometers per hour) from a standstill. Faster acceleration is often associated with sportier or high-performance vehicles.</p></li>
<li><p><strong>Model Year:</strong> This column specifies the year in which the vehicle model was manufactured. It can be used to track trends in fuel efficiency and technology over time.</p></li>
<li><p><strong>Origin:</strong> Origin typically refers to the country of origin or manufacturing of the vehicle. It’s often a categorical variable, and values may represent different countries or regions where the vehicle was produced.</p></li>
<li><p><strong>Car Name:</strong> This column provides the name or model of the car. It can be used for identification and categorization of different car models.</p></li>
</ol>
<p>The Auto MPG dataset contains these columns, and each column provides specific information about various aspects of the vehicles, including their performance, specifications, and characteristics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>


<span class="n">X</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;MPG&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;MPG&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of X_train = </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of y_train = </span><span class="si">{</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of X_test = </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of y_test = </span><span class="si">{</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 1. Converting data into dependent and independent variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;MPG&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_mpg_df</span><span class="p">[</span><span class="s1">&#39;MPG&#39;</span><span class="p">]</span>

<span class="c1"># 2. Split the data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 3. Create and train the linear regression model</span>
<span class="n">regressor</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 4. Evaluate the model</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Calculate model performance metrics</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared (R2): </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of X_train = (313, 7)
Shape of y_train = (313,)
Shape of X_test = (79, 7)
Shape of y_test = (79,)
Mean Squared Error (MSE): 9.63
R-squared (R2): 0.80
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MPG ~ Cylinders + Displacement + Horsepower + Weight + Acceleration + Model_Year + C(Origin)&#39;</span><span class="p">,</span> <span class="n">auto_mpg_df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">Reg_Result</span><span class="p">(</span><span class="n">Results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    MPG   R-squared:                       0.824
Model:                            OLS   Adj. R-squared:                  0.821
Method:                 Least Squares   F-statistic:                     224.5
Date:                Thu, 12 Oct 2023   Prob (F-statistic):          1.79e-139
Time:                        20:15:58   Log-Likelihood:                -1020.5
No. Observations:                 392   AIC:                             2059.
Df Residuals:                     383   BIC:                             2095.
Df Model:                           8                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept        -17.9546      4.677     -3.839      0.000     -27.150      -8.759
C(Origin)[T.2]     2.6300      0.566      4.643      0.000       1.516       3.744
C(Origin)[T.3]     2.8532      0.553      5.162      0.000       1.766       3.940
Cylinders         -0.4897      0.321     -1.524      0.128      -1.121       0.142
Displacement       0.0240      0.008      3.133      0.002       0.009       0.039
Horsepower        -0.0182      0.014     -1.326      0.185      -0.045       0.009
Weight            -0.0067      0.001    -10.243      0.000      -0.008      -0.005
Acceleration       0.0791      0.098      0.805      0.421      -0.114       0.272
Model_Year         0.7770      0.052     15.005      0.000       0.675       0.879
==============================================================================
Omnibus:                       23.395   Durbin-Watson:                   1.291
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               34.452
Skew:                           0.444   Prob(JB):                     3.30e-08
Kurtosis:                       4.150   Cond. No.                     8.70e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 8.7e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_59bc9_row0_col0 {
  width: 10em;
  background: linear-gradient(90deg, Lime 86.3%, transparent 86.3%);
}
#T_59bc9_row0_col1, #T_59bc9_row1_col1, #T_59bc9_row2_col1, #T_59bc9_row3_col1, #T_59bc9_row4_col1, #T_59bc9_row5_col1, #T_59bc9_row6_col1, #T_59bc9_row7_col1, #T_59bc9_row8_col1 {
  background-color: DimGray;
  color: White;
}
#T_59bc9_row1_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 98.9%, transparent 98.9%);
}
#T_59bc9_row2_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 100.0%, transparent 100.0%);
}
#T_59bc9_row3_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 83.9%, Lime 83.9%, Lime 86.3%, transparent 86.3%);
}
#T_59bc9_row4_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 86.4%, transparent 86.4%);
}
#T_59bc9_row5_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.2%, Lime 86.2%, Lime 86.3%, transparent 86.3%);
}
#T_59bc9_row6_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 86.3%, transparent 86.3%);
}
#T_59bc9_row7_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 86.7%, transparent 86.7%);
}
#T_59bc9_row8_col0 {
  width: 10em;
  background: linear-gradient(90deg, transparent 86.3%, Lime 86.3%, Lime 90.0%, transparent 90.0%);
}
</style>
<table id="T_59bc9">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_59bc9_level0_col0" class="col_heading level0 col0" >coef</th>
      <th id="T_59bc9_level0_col1" class="col_heading level0 col1" >std err</th>
      <th id="T_59bc9_level0_col2" class="col_heading level0 col2" >t</th>
      <th id="T_59bc9_level0_col3" class="col_heading level0 col3" >P>|t|</th>
      <th id="T_59bc9_level0_col4" class="col_heading level0 col4" >[0.025</th>
      <th id="T_59bc9_level0_col5" class="col_heading level0 col5" >0.975]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_59bc9_level0_row0" class="row_heading level0 row0" >Intercept</th>
      <td id="T_59bc9_row0_col0" class="data row0 col0" >-1.7955e+01</td>
      <td id="T_59bc9_row0_col1" class="data row0 col1" >4.6770e+00</td>
      <td id="T_59bc9_row0_col2" class="data row0 col2" >-3.839000</td>
      <td id="T_59bc9_row0_col3" class="data row0 col3" >0.0000e+00</td>
      <td id="T_59bc9_row0_col4" class="data row0 col4" >-27.150000</td>
      <td id="T_59bc9_row0_col5" class="data row0 col5" >-8.759000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row1" class="row_heading level0 row1" >C(Origin)[T.2]</th>
      <td id="T_59bc9_row1_col0" class="data row1 col0" >2.6300e+00</td>
      <td id="T_59bc9_row1_col1" class="data row1 col1" >5.6600e-01</td>
      <td id="T_59bc9_row1_col2" class="data row1 col2" >4.643000</td>
      <td id="T_59bc9_row1_col3" class="data row1 col3" >0.0000e+00</td>
      <td id="T_59bc9_row1_col4" class="data row1 col4" >1.516000</td>
      <td id="T_59bc9_row1_col5" class="data row1 col5" >3.744000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row2" class="row_heading level0 row2" >C(Origin)[T.3]</th>
      <td id="T_59bc9_row2_col0" class="data row2 col0" >2.8532e+00</td>
      <td id="T_59bc9_row2_col1" class="data row2 col1" >5.5300e-01</td>
      <td id="T_59bc9_row2_col2" class="data row2 col2" >5.162000</td>
      <td id="T_59bc9_row2_col3" class="data row2 col3" >0.0000e+00</td>
      <td id="T_59bc9_row2_col4" class="data row2 col4" >1.766000</td>
      <td id="T_59bc9_row2_col5" class="data row2 col5" >3.940000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row3" class="row_heading level0 row3" >Cylinders</th>
      <td id="T_59bc9_row3_col0" class="data row3 col0" >-4.8970e-01</td>
      <td id="T_59bc9_row3_col1" class="data row3 col1" >3.2100e-01</td>
      <td id="T_59bc9_row3_col2" class="data row3 col2" >-1.524000</td>
      <td id="T_59bc9_row3_col3" class="data row3 col3" >1.2800e-01</td>
      <td id="T_59bc9_row3_col4" class="data row3 col4" >-1.121000</td>
      <td id="T_59bc9_row3_col5" class="data row3 col5" >0.142000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row4" class="row_heading level0 row4" >Displacement</th>
      <td id="T_59bc9_row4_col0" class="data row4 col0" >2.4000e-02</td>
      <td id="T_59bc9_row4_col1" class="data row4 col1" >8.0000e-03</td>
      <td id="T_59bc9_row4_col2" class="data row4 col2" >3.133000</td>
      <td id="T_59bc9_row4_col3" class="data row4 col3" >2.0000e-03</td>
      <td id="T_59bc9_row4_col4" class="data row4 col4" >0.009000</td>
      <td id="T_59bc9_row4_col5" class="data row4 col5" >0.039000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row5" class="row_heading level0 row5" >Horsepower</th>
      <td id="T_59bc9_row5_col0" class="data row5 col0" >-1.8200e-02</td>
      <td id="T_59bc9_row5_col1" class="data row5 col1" >1.4000e-02</td>
      <td id="T_59bc9_row5_col2" class="data row5 col2" >-1.326000</td>
      <td id="T_59bc9_row5_col3" class="data row5 col3" >1.8500e-01</td>
      <td id="T_59bc9_row5_col4" class="data row5 col4" >-0.045000</td>
      <td id="T_59bc9_row5_col5" class="data row5 col5" >0.009000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row6" class="row_heading level0 row6" >Weight</th>
      <td id="T_59bc9_row6_col0" class="data row6 col0" >-6.7000e-03</td>
      <td id="T_59bc9_row6_col1" class="data row6 col1" >1.0000e-03</td>
      <td id="T_59bc9_row6_col2" class="data row6 col2" >-10.243000</td>
      <td id="T_59bc9_row6_col3" class="data row6 col3" >0.0000e+00</td>
      <td id="T_59bc9_row6_col4" class="data row6 col4" >-0.008000</td>
      <td id="T_59bc9_row6_col5" class="data row6 col5" >-0.005000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row7" class="row_heading level0 row7" >Acceleration</th>
      <td id="T_59bc9_row7_col0" class="data row7 col0" >7.9100e-02</td>
      <td id="T_59bc9_row7_col1" class="data row7 col1" >9.8000e-02</td>
      <td id="T_59bc9_row7_col2" class="data row7 col2" >0.805000</td>
      <td id="T_59bc9_row7_col3" class="data row7 col3" >4.2100e-01</td>
      <td id="T_59bc9_row7_col4" class="data row7 col4" >-0.114000</td>
      <td id="T_59bc9_row7_col5" class="data row7 col5" >0.272000</td>
    </tr>
    <tr>
      <th id="T_59bc9_level0_row8" class="row_heading level0 row8" >Model_Year</th>
      <td id="T_59bc9_row8_col0" class="data row8 col0" >7.7700e-01</td>
      <td id="T_59bc9_row8_col1" class="data row8 col1" >5.2000e-02</td>
      <td id="T_59bc9_row8_col2" class="data row8 col2" >15.005000</td>
      <td id="T_59bc9_row8_col3" class="data row8 col3" >0.0000e+00</td>
      <td id="T_59bc9_row8_col4" class="data row8 col4" >0.675000</td>
      <td id="T_59bc9_row8_col5" class="data row8 col5" >0.879000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">auto_mpg_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;MPG&#39;, &#39;Cylinders&#39;, &#39;Displacement&#39;, &#39;Horsepower&#39;, &#39;Weight&#39;,
       &#39;Acceleration&#39;, &#39;Model_Year&#39;, &#39;Origin&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;../mystyle.mplstyle&#39;</span><span class="p">)</span>

<span class="c1"># Create a figure and two subplots with different widths</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="c1"># Plot the boxplot on the first subplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">auto_mpg_df</span><span class="p">[</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;LawnGreen&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Boxplot for (Potential) Outliers Detection&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the histogram with KDE on the second subplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">auto_mpg_df</span><span class="p">[</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;aqua&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution Plot for Skewness&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Horsepower&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Adjust spacing between subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Horsepower&#39;</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7133943efd7f7ae749a0d45ce2a16d438472c7bac6c118236cffae1e92e6cfbd.png" src="../_images/7133943efd7f7ae749a0d45ce2a16d438472c7bac6c118236cffae1e92e6cfbd.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_09"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qualitative-predictors-with-only-two-levels">Qualitative Predictors with Only Two Levels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qualitative-predictors-with-more-than-two-levels">Qualitative Predictors with More than Two Levels</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>