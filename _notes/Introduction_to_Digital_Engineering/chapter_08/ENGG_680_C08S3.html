

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8.3. Image Thresholding &#8212; Introduction to Digital Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_08/ENGG_680_C08S3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.4. Image Filtering" href="ENGG_680_C08S4.html" />
    <link rel="prev" title="8.2. Geometric Transformations" href="ENGG_680_C08S2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Digital Engineering - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Digital Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_01/ReadMe.html">1. Introduction to Python Programming</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S1.html">1.1. Variable names, Expressions and statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S2.html">1.2. Fundamental Concepts and Operations in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S3.html">1.3. Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_02/ReadMe.html">2. Control Flow: Conditionals, Recursion, and Iteration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S1.html">2.1. Conditionals and recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S2.html">2.2. Iteration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_03/ReadMe.html">3. Data Structures and File Handling in Python</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S1.html">3.1. Strings in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S2.html">3.2. Python Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S3.html">3.3. Python Dictionaries: Key-Value Pairs in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S4.html">3.4. Python Tuples: Immutable Sequences in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S5.html">3.5. Python Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S6.html">3.6. Files in Python (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_04/ReadMe.html">4. Classes and Objects</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S1.html">4.1. Introduction to Classes and Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S2.html">4.2. Inheritance and Polymorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S3.html">4.3. Encapsulation and Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S4.html">4.4. Copying Objects (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S5.html">4.5. Magic Methods (Dunder Methods) in Python (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S6.html">4.6. Examples of Classes (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_05/ReadMe.html">5. Introduction to NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S1.html">5.1. Basics of Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S2.html">5.2. NumPy Function Reference and Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S3.html">5.3. Advanced Numpy Concepts (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_06/ReadMe.html">6. Working with Data using Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S1.html">6.1. An Introduction to Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S2.html">6.2. DataFrame and Series Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S3.html">6.3. Pandas Data Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S4.html">6.4. Handling Missing Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S5.html">6.5. Combining Datasets using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/ENGG_680_C06S6.html">6.6. Aggregation and Grouping in Pandas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_07/ReadMe.html">7. Data Visualization using Python</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S1.html">7.1. Getting started with Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S2.html">7.2. Matplotlib Styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S3.html">7.3. Matplotlib interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S4.html">7.4. Adjusting the Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S5.html">7.5. Seaborn plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/ENGG_680_C07S6.html">7.6. Python Plotting Guide</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ReadMe.html">8. An Introduction to Computer Vision</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C08S1.html">8.1. Getting Started with OpenCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C08S2.html">8.2. Geometric Transformations</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.3. Image Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C08S4.html">8.4. Image Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C08S5.html">8.5. Drawing Functions (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_09/ReadMe.html">9. An Introduction to Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_09/ENGG_680_C09S1.html">9.1. Prologue: Statistical Metrics and Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../appendixes/ReadMe.html">10. Appendices</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendixes/SampleQuestions_1.html">10.1. Sample Questions 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendixes/SampleQuestions_2.html">10.2. Sample Questions 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">11. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Image Thresholding</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-images">8.3.1. Sample Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-thresholding">8.3.2. Simple Thresholding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-thresholding-image-transformation">8.3.2.1. Binary Thresholding Image Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thresh-binary-inv-thresholding">8.3.2.2. THRESH_BINARY_INV Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#truncate-thresholding">8.3.2.3. Truncate Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-zero-thresholding">8.3.2.4. To-Zero Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-to-zero-thresholding">8.3.2.5. Inverse To-Zero Thresholding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptivethresholding-optional-content">8.3.3. AdaptiveThresholding (Optional Content)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">8.3.3.1. Binary Thresholding Image Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-binary-thresholding-image-transformation">8.3.3.2. Inverse Binary Thresholding Image Transformation</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="image-thresholding">
<h1><span class="section-number">8.3. </span>Image Thresholding<a class="headerlink" href="#image-thresholding" title="Permalink to this heading">#</a></h1>
<section id="sample-images">
<h2><span class="section-number">8.3.1. </span>Sample Images<a class="headerlink" href="#sample-images" title="Permalink to this heading">#</a></h2>
<p>In this section, we employ <code class="docutils literal notranslate"><span class="pre">Lunenburg.jpg</span></code> and <code class="docutils literal notranslate"><span class="pre">Varenna.jpg</span></code> from my personal image library. Both images were adjusted to a size of 2000 by 1500 to facilitate more straightforward calculations.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Lunenburg,_Nova_Scotia">Lunenburg</a> (a town in Nova Scotia, Canada) is known for its well-preserved colonial architecture and UNESCO World Heritage status.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Varenna">Varenna</a> features the picturesque village of Varenna on the shores of Lake Como, Italy, celebrated for its charming waterfront and stunning natural beauty.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">io</span>

<span class="c1"># Initialize empty list for storing images</span>
<span class="n">Images</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Define image names and their corresponding URLs</span>
<span class="n">Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lunenburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Varenna&#39;</span><span class="p">]</span>
<span class="n">Urls</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;https://raw.githubusercontent.com/HatefDastour/ENGG_680/main/Files/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.jpg&#39;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">Names</span><span class="p">]</span>

<span class="c1"># Load images from the specified URLs and create a dictionary with image names as keys</span>
<span class="n">Images</span> <span class="o">=</span> <span class="p">[</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">Urls</span><span class="p">]</span>
<span class="n">Images_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Names</span><span class="p">,</span> <span class="n">Images</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Import the plotting library</span>

<span class="c1"># Set font properties for plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>

<span class="c1"># Define a function to display images with titles and optional settings</span>
<span class="k">def</span> <span class="nf">ImShow</span><span class="p">(</span><span class="n">Images</span><span class="p">,</span> <span class="n">Names</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Images&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Display a pair of images side by side.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    Images (list): List of two images to be displayed.</span>
<span class="sd">    Names (list): List of two names or labels for the images.</span>
<span class="sd">    title (str, optional): Title for the figure. Defaults to &#39;Images&#39;.</span>
<span class="sd">    grayscale (bool, optional): If True, display images in grayscale. Defaults to False.</span>
<span class="sd">    figsize (tuple, optional): Figure size (width, height) in inches. Defaults to (9.5, 4.5).</span>

<span class="sd">    Returns:</span>
<span class="sd">    matplotlib.figure.Figure: The figure containing the displayed images.</span>
<span class="sd">    numpy.ndarray: The array of subplots for further manipulation.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Create a figure with two subplots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>  <span class="c1"># Create a figure with 1 row and 2 columns of subplots</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>  <span class="c1"># Flatten the subplots for easier manipulation</span>

    <span class="c1"># Iterate over the first two images</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="c1"># Display the image in grayscale if grayscale is True, otherwise in color</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span> <span class="k">if</span> <span class="n">grayscale</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Set aspect ratio to 1 (square aspect)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off axis</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">Names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>  <span class="c1"># Set image title with bold font</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="c1"># Set main title if provided</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout for better spacing</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="c1"># Display the original images</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">(</span><span class="n">Images</span><span class="p">,</span> <span class="n">Names</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sample Images&#39;</span><span class="p">)</span>  <span class="c1"># Call the ImShow function to display images</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/215100cdaf83e0dd66c1eae0ff33e6d4696d356fb1289656080368cbfa40c1ec.png" src="../_images/215100cdaf83e0dd66c1eae0ff33e6d4696d356fb1289656080368cbfa40c1ec.png" />
</div>
</div>
</section>
<section id="simple-thresholding">
<h2><span class="section-number">8.3.2. </span>Simple Thresholding<a class="headerlink" href="#simple-thresholding" title="Permalink to this heading">#</a></h2>
<p>The function “cv2.threshold” in Python is used to perform image thresholding, a common technique in image processing <span id="id1">[<a class="reference internal" href="../References.html#id25" title="G. Bradski. The OpenCV Library. Dr. Dobb's Journal of Software Tools, 2000.">Bradski, 2000</a>, <a class="reference internal" href="../References.html#id26" title="OpenCV Developers. Opencv documentation. https://docs.opencv.org/4.x/index.html, 2023. [Online; accessed 01-August-2023].">OpenCV Developers, 2023</a>]</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">thresh</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="nb">type</span><span class="p">[,</span> <span class="n">dst</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">retval</span><span class="p">,</span> <span class="n">dst</span>
</pre></div>
</div>
<p>This function takes an input image (src) and applies a thresholding operation to it, producing a binary image. The thresholding operation involves comparing each pixel value in the source image to a specified threshold value (thresh). Pixels with values greater than or equal to the threshold are set to a specified maximum value (maxval), while pixels with values less than the threshold are set to zero (or a minimum value, depending on the type of thresholding specified). The resulting binary image is returned as the destination image (dst).</p>
<p>The function also returns two values: “retval,” which is the threshold value used (this can be useful in adaptive thresholding), and “dst,” the resulting thresholded image.</p>
<p>The “type” parameter determines the type of thresholding to be applied, and it can take one of the following values:</p>
<ul class="simple">
<li><p>cv2.THRESH_BINARY: Binary thresholding, where pixels above the threshold are set to maxval, and pixels below are set to zero.</p></li>
<li><p>cv2.THRESH_BINARY_INV: Inverse binary thresholding, where pixels above the threshold are set to zero, and pixels below are set to maxval.</p></li>
<li><p>cv2.THRESH_TRUNC: Truncated thresholding, where pixels above the threshold are set to the threshold value, and pixels below remain unchanged.</p></li>
<li><p>cv2.THRESH_TOZERO: Thresholding to zero, where pixels above the threshold remain unchanged, and pixels below are set to zero.</p></li>
<li><p>cv2.THRESH_TOZERO_INV: Inverse thresholding to zero, where pixels above the threshold are set to zero, and pixels below remain unchanged.</p></li>
</ul>
<p>The optional “dst” parameter allows you to provide a pre-allocated output image to store the thresholded result. This parameter is useful when you want to reuse an existing image buffer instead of creating a new one.</p>
<div class="important admonition">
<p class="admonition-title">Remark</p>
<p>The function performs fixed-level thresholding on a single-channel array. It is primarily employed to obtain a binary image from a grayscale one (you can also achieve this using <code class="docutils literal notranslate"><span class="pre">compare()</span></code>) or to eliminate noise by filtering out pixels with values that are either too small or too large. The function offers various thresholding types, which are specified by the ‘type’ parameter.</p>
</div>
<section id="binary-thresholding-image-transformation">
<h3><span class="section-number">8.3.2.1. </span>Binary Thresholding Image Transformation<a class="headerlink" href="#binary-thresholding-image-transformation" title="Permalink to this heading">#</a></h3>
<p>In the context of image processing, “THRESH_BINARY” is a thresholding technique used to convert a grayscale image into a binary image. Here’s how it works:</p>
<ul class="simple">
<li><p>For each pixel at position <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> in the source grayscale image:</p>
<ul>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is greater than a specified threshold value, the corresponding pixel in the output binary image is set to the maximum value (usually 255).</p></li>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is less than or equal to the threshold value, the corresponding pixel in the output binary image is set to the minimum value (usually 0).</p></li>
</ul>
</li>
</ul>
<p>In mathematical terms, this can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-03a0ab6d-51f3-4084-82a5-c6150f3068cc">
<span class="eqno">(8.32)<a class="headerlink" href="#equation-03a0ab6d-51f3-4084-82a5-c6150f3068cc" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output}(x, y) = \begin{cases}
\text{Maximum Value} &amp; \text{if } \text{source}(x, y) &gt; \text{Threshold Value} \\
0 &amp; \text{otherwise}
\end{cases}
\end{equation}\]</div>
<p>This process effectively creates a binary image where pixels are classified into two categories based on their intensity: those above the threshold are set to the maximum value, and those below or equal to the threshold are set to the minimum value. This technique is commonly used for tasks such as object segmentation and feature extraction in computer vision and image analysis.</p>
<p>For more detailed information and examples, you can refer to the <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#threshold">OpenCV documentation on thresholding</a>.</p>
<p><font color='Blue'><b>Example - Binary Thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">img_filter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Perform image filtering by replacing masked areas with white (255) in each color channel.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    img (numpy.ndarray): The original image.</span>
<span class="sd">    mask (numpy.ndarray): A mask specifying areas to be replaced.</span>
<span class="sd">    value (int, optional): The value in the mask to be replaced with white (255). Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">    numpy.ndarray: The filtered image with masked areas replaced with white.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">img_filtered</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">img_filtered</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">255</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">img_filtered</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply thresholding to create a binary mask</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">)</span>

    <span class="c1"># Display the grayscale image and the binary mask</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Grayscale Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Threshold: 130, Max Value: 255&#39;</span><span class="p">],</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Example: Thresholding to Create Binary Representation&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Apply a filter using the binary mask</span>
    <span class="n">Img_Filtered</span> <span class="o">=</span> <span class="n">img_filter</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Display the original image and the filtered image</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img</span><span class="p">,</span> <span class="n">Img_Filtered</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Filtered Image Using the Thresholding&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6aeabed5d3c87401a64f2a0307c7c4af5f0a12e922bbb1880729718675e3cdeb.png" src="../_images/6aeabed5d3c87401a64f2a0307c7c4af5f0a12e922bbb1880729718675e3cdeb.png" />
<img alt="../_images/ef7799e7fb5ab51a9a634194b8732b3a2f0e131e0d9b7b840e2c45d9df2fab4e.png" src="../_images/ef7799e7fb5ab51a9a634194b8732b3a2f0e131e0d9b7b840e2c45d9df2fab4e.png" />
<img alt="../_images/43092b29f81b35ac39d80619d3e2df037dabe8612b78e29bfe8b3b0b13ff0f85.png" src="../_images/43092b29f81b35ac39d80619d3e2df037dabe8612b78e29bfe8b3b0b13ff0f85.png" />
<img alt="../_images/2fbbcfd3a432f07686e932aee9cd5230ac6d09c7d482f55506677e17f74e49eb.png" src="../_images/2fbbcfd3a432f07686e932aee9cd5230ac6d09c7d482f55506677e17f74e49eb.png" />
</div>
</div>
</section>
<section id="thresh-binary-inv-thresholding">
<h3><span class="section-number">8.3.2.2. </span>THRESH_BINARY_INV Thresholding<a class="headerlink" href="#thresh-binary-inv-thresholding" title="Permalink to this heading">#</a></h3>
<p>“THRESH_BINARY_INV” is a thresholding technique used in image processing to create a binary image from a grayscale image. In this technique:</p>
<ul class="simple">
<li><p>For each pixel at position <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> in the source grayscale image:</p>
<ul>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is greater than the specified threshold value, the corresponding pixel in the output binary image is set to 0 (usually 0).</p></li>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is less than or equal to the threshold value, the corresponding pixel in the output binary image is set to the maximum value (often 255).</p></li>
</ul>
</li>
</ul>
<p>In mathematical terms, this can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c6a33f97-7d2c-4900-89b3-23e8c87d7828">
<span class="eqno">(8.33)<a class="headerlink" href="#equation-c6a33f97-7d2c-4900-89b3-23e8c87d7828" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output}(x, y) = \begin{cases}
0 &amp; \text{if } \text{source}(x, y) &gt; \text{Threshold Value} \\
\text{Maximum Value} &amp; \text{otherwise}
\end{cases}
\end{equation}\]</div>
<p>In simple words, “THRESH_BINARY_INV” inverts the behavior of “THRESH_BINARY.” It results in a binary image where pixels above the threshold become black, and pixels equal to or below the threshold become white. This thresholding technique is useful in various image processing tasks, such as object segmentation and feature extraction, where objects of interest are typically darker than their background.</p>
<p>For a complete description of this technique and its usage, you can refer to the OpenCV documentation on <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#threshold">thresholding</a>.</p>
<p><font color='Blue'><b>Example - Inverse Binary Thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply inverse binary thresholding to create a binary mask</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY_INV</span><span class="p">)</span>

    <span class="c1"># Display the grayscale image and the binary mask</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Grayscale Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Threshold: 130, Max Value: 255&#39;</span><span class="p">],</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Example: Inverse Binary Thresholding&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Apply a filter using the binary mask</span>
    <span class="n">Img_Filtered</span> <span class="o">=</span> <span class="n">img_filter</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Display the original image and the filtered image</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img</span><span class="p">,</span> <span class="n">Img_Filtered</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Filtered Image Using the Thresholding&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e821b639a1c9ee8fe600109b347afde4badebf219f30bcc6556510db0d652376.png" src="../_images/e821b639a1c9ee8fe600109b347afde4badebf219f30bcc6556510db0d652376.png" />
<img alt="../_images/f478b87c2d1e4439783846eb597f2a08deb6ceec1c1203b4c7ca8fd3644b71ab.png" src="../_images/f478b87c2d1e4439783846eb597f2a08deb6ceec1c1203b4c7ca8fd3644b71ab.png" />
<img alt="../_images/90529c10fc10133cbab3b6a99a922abad02301823cf0bf48f80456a98ebaf258.png" src="../_images/90529c10fc10133cbab3b6a99a922abad02301823cf0bf48f80456a98ebaf258.png" />
<img alt="../_images/99470b94f59695c3a973071624b57a5f8dd56e0b729e5f326e017daee005d7dc.png" src="../_images/99470b94f59695c3a973071624b57a5f8dd56e0b729e5f326e017daee005d7dc.png" />
</div>
</div>
</section>
<section id="truncate-thresholding">
<h3><span class="section-number">8.3.2.3. </span>Truncate Thresholding<a class="headerlink" href="#truncate-thresholding" title="Permalink to this heading">#</a></h3>
<p>“THRESH_TRUNC” is a thresholding technique used in image processing to modify pixel values in a grayscale image based on a specified threshold value. In this technique:</p>
<ul class="simple">
<li><p>For each pixel at position <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> in the source grayscale image:</p>
<ul>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is greater than the specified threshold value, the corresponding pixel in the output image is set to the threshold value itself.</p></li>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is less than or equal to the threshold value, the corresponding pixel in the output image retains its original intensity value from the source image.</p></li>
</ul>
</li>
</ul>
<p>In mathematical terms, this can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6a3e6189-62ad-450d-b3b7-5d64023bd3d5">
<span class="eqno">(8.34)<a class="headerlink" href="#equation-6a3e6189-62ad-450d-b3b7-5d64023bd3d5" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output}(x, y) = \begin{cases}
\text{Threshold Value} &amp; \text{if } \text{source}(x, y) &gt; \text{Threshold Value} \\
\text{source}(x, y) &amp; \text{otherwise}
\end{cases}
\end{equation}\]</div>
<p>In simpler terms, “THRESH_TRUNC” modifies the pixel values such that any value in the source image above the threshold value is replaced with the threshold value, while values at or below the threshold remain unchanged. This thresholding technique can be used for various image enhancement and adjustment tasks in image processing.</p>
<p>For a comprehensive description and examples of “THRESH_TRUNC,” you can refer to the OpenCV documentation on <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#threshold">thresholding</a>.</p>
<p><font color='Blue'><b>Example - Truncate thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply truncation thresholding to create a binary mask (THRESH_TRUNC)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_TRUNC</span><span class="p">)</span>

    <span class="c1"># Display the grayscale image and the binary mask</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Grayscale Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Threshold: 130, Max Value: 255&#39;</span><span class="p">],</span>
               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Example: Truncate Thresholding Image Transformation&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/100a0651206f04abc419d3ebb6ec757918bf651e52464e3d5a687b1e903c85d6.png" src="../_images/100a0651206f04abc419d3ebb6ec757918bf651e52464e3d5a687b1e903c85d6.png" />
<img alt="../_images/4baa171aa637be0ad3ea694d48e103604f54ead8843cf7ea5379b52afb1620ed.png" src="../_images/4baa171aa637be0ad3ea694d48e103604f54ead8843cf7ea5379b52afb1620ed.png" />
</div>
</div>
</section>
<section id="to-zero-thresholding">
<h3><span class="section-number">8.3.2.4. </span>To-Zero Thresholding<a class="headerlink" href="#to-zero-thresholding" title="Permalink to this heading">#</a></h3>
<p>“THRESH_TOZERO” is a thresholding technique used in image processing to modify pixel values in a grayscale image based on a specified threshold value. In this technique:</p>
<ul class="simple">
<li><p>For each pixel at position <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> in the source grayscale image:</p>
<ul>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is greater than the specified threshold value, the corresponding pixel in the output image retains its original intensity value from the source image.</p></li>
<li><p>If the pixel’s intensity value at <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> is less than or equal to the threshold value, the corresponding pixel in the output image is set to 0.</p></li>
</ul>
</li>
</ul>
<p>In mathematical terms, this can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-62c31ebd-dcc2-464c-892e-0ba20ac43dc9">
<span class="eqno">(8.35)<a class="headerlink" href="#equation-62c31ebd-dcc2-464c-892e-0ba20ac43dc9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output}(x, y) = \begin{cases}
\text{source}(x, y) &amp; \text{if } \text{source}(x, y) &gt; \text{Threshold Value} \\
0 &amp; \text{otherwise}
\end{cases}
\end{equation}\]</div>
<p>In simpler terms, “THRESH_TOZERO” modifies the pixel values such that any value in the source image above the threshold value is preserved as is, while values at or below the threshold are set to 0. This thresholding technique can be used for various image processing tasks, such as emphasizing regions of interest or reducing noise in images.</p>
<p>For a comprehensive description and examples of “THRESH_TOZERO,” you can refer to the OpenCV documentation on <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#threshold">thresholding</a>.</p>
<p><font color='Blue'><b>Example - To-Zero thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply to-zero thresholding to create a binary mask (THRESH_TOZERO)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_TOZERO</span><span class="p">)</span>

    <span class="c1"># Display the grayscale image and the binary mask</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Grayscale Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Threshold: 130, Max Value: 255&#39;</span><span class="p">],</span>
               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Example: To-Zero Thresholding&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e5d29b87a856e443954c98ee9e5aa6d94781fd2901d402055f3c51cba0ffb296.png" src="../_images/e5d29b87a856e443954c98ee9e5aa6d94781fd2901d402055f3c51cba0ffb296.png" />
<img alt="../_images/6d6284992186efd8e9f9aeea27d52ea438fdeeacd5a048b47506d2d1fb32ff56.png" src="../_images/6d6284992186efd8e9f9aeea27d52ea438fdeeacd5a048b47506d2d1fb32ff56.png" />
</div>
</div>
</section>
<section id="inverse-to-zero-thresholding">
<h3><span class="section-number">8.3.2.5. </span>Inverse To-Zero Thresholding<a class="headerlink" href="#inverse-to-zero-thresholding" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cv2.THRESH_TOZERO_INV</span></code> thresholding operation is a method used in image processing to modify pixel values in a grayscale image based on a predefined threshold value. It is part of the OpenCV library, a powerful tool for computer vision tasks. This specific thresholding operation follows the formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-06ede31d-1523-4de0-a298-563aba71edda">
<span class="eqno">(8.36)<a class="headerlink" href="#equation-06ede31d-1523-4de0-a298-563aba71edda" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output}(x, y) = \begin{cases}
0 &amp; \text{if } \text{source}(x, y) &gt; \text{threshold value} \\
\text{source}(x, y) &amp; \text{otherwise}
\end{cases}
\end{equation}\]</div>
<ul class="simple">
<li><p>For each pixel in the source image, if its intensity value (brightness) is greater than the specified threshold value, it is set to 0 in the output image.</p></li>
<li><p>Conversely, if the pixel’s intensity is equal to or less than the threshold value, it retains its original intensity in the output image.</p></li>
</ul>
<p>This thresholding technique is particularly useful for enhancing certain features or removing noise in images where pixel values above a certain threshold are considered significant. Pixels below the threshold remain unchanged, while those above it are set to zero.</p>
<p>For more detailed information and examples of using <code class="docutils literal notranslate"><span class="pre">cv2.THRESH_TOZERO_INV</span></code>, you can refer to the <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#threshold">OpenCV documentation</a>.</p>
<p><font color='Blue'><b>Example - Inverse Inverse To-Zero thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply inverse to-zero thresholding to create a binary mask (THRESH_TOZERO_INV)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_TOZERO_INV</span><span class="p">)</span>

    <span class="c1"># Display the grayscale image and the binary mask</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Grayscale Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Threshold: 130, Max Value: 255&#39;</span><span class="p">],</span>
               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Example: Inverse To-Zero Thresholding&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/28c03a7032e59492041ca2c5fa7dcecf68c4a3ccb75c3b4f804a13f6e9223ab2.png" src="../_images/28c03a7032e59492041ca2c5fa7dcecf68c4a3ccb75c3b4f804a13f6e9223ab2.png" />
<img alt="../_images/e0011119265daf38f5d82ca75a6c0a29658499a2fed55cf5f79849badc557b8b.png" src="../_images/e0011119265daf38f5d82ca75a6c0a29658499a2fed55cf5f79849badc557b8b.png" />
</div>
</div>
</section>
</section>
<section id="adaptivethresholding-optional-content">
<h2><span class="section-number">8.3.3. </span>AdaptiveThresholding (Optional Content)<a class="headerlink" href="#adaptivethresholding-optional-content" title="Permalink to this heading">#</a></h2>
<p>The function “cv2.adaptiveThreshold” in Python is a part of the OpenCV library, which is used for image processing. It performs adaptive thresholding on a source image, producing a binary (grayscale) image based on the local properties of the input image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">maxValue</span><span class="p">,</span> <span class="n">adaptiveMethod</span><span class="p">,</span> <span class="n">thresholdType</span><span class="p">,</span> <span class="n">blockSize</span><span class="p">,</span> <span class="n">C</span><span class="p">[,</span> <span class="n">dst</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dst</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: Input image (single-channel, 8-bit or 32-bit floating point).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxValue</span></code>: The maximum value to assign to pixels that pass the adaptive thresholding. Typically set to 255 for binary images.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">adaptiveMethod</span></code>: Method used to calculate the threshold value for each pixel. It can take one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.ADAPTIVE_THRESH_MEAN_C</span></code>: Threshold value is the mean of the neighborhood area.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.ADAPTIVE_THRESH_GAUSSIAN_C</span></code>: Threshold value is the weighted sum of neighborhood values where weights are a Gaussian window.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">thresholdType</span></code>: Type of thresholding to apply. It can take one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.THRESH_BINARY</span></code>: Pixels with values greater than the calculated threshold are set to <code class="docutils literal notranslate"><span class="pre">maxValue</span></code>, and pixels below are set to 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.THRESH_BINARY_INV</span></code>: Inverse binary thresholding, where pixels above the threshold are set to 0, and pixels below are set to <code class="docutils literal notranslate"><span class="pre">maxValue</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">blockSize</span></code>: Size of the neighborhood area (odd number, typically 3, 5, 7, etc.). The threshold is calculated based on the pixel values within this local region.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code>: Constant subtracted from the mean (or weighted mean, in case of Gaussian) to calculate the final threshold value. It allows adjusting the sensitivity of the thresholding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst</span></code> (optional): Destination image where the result will be stored. If not provided, a new image will be created.</p></li>
</ol>
<p><strong>Returns:</strong></p>
<p>The output image (<code class="docutils literal notranslate"><span class="pre">dst</span></code>) after applying the adaptive thresholding.</p>
<p><strong>Usage:</strong></p>
<p>This function is useful for segmenting an image into regions of interest, separating objects from the background, or enhancing features in images with varying lighting conditions. The adaptive thresholding method helps handle variations in local image intensity, making it particularly useful for images with uneven illumination.</p>
<div class="important admonition">
<p class="admonition-title">Remark</p>
<p>The main difference between <code class="docutils literal notranslate"><span class="pre">cv2.threshold</span></code> and <code class="docutils literal notranslate"><span class="pre">cv2.adaptiveThreshold</span></code> in OpenCV lies in how they determine the threshold values for converting a grayscale image into a binary image.</p>
<ol class="arabic">
<li><p><strong>cv2.threshold:</strong></p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">cv2.threshold</span></code>, you specify a single global threshold value (an integer) that is applied uniformly to all pixels in the image. This means that the same threshold value is used for every pixel in the image.</p></li>
<li><p>Pixels with intensity values greater than the specified threshold value are set to a maximum value (often 255), and pixels with values less than or equal to the threshold value are set to 0.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">binary_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">threshold_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>cv2.adaptiveThreshold:</strong></p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">cv2.adaptiveThreshold</span></code>, the threshold value is calculated individually for each pixel based on the local neighborhood of that pixel. This allows for adaptive thresholding, where the threshold value can vary across different regions of the image.</p></li>
<li><p>You need to specify two additional parameters: <code class="docutils literal notranslate"><span class="pre">blockSize</span></code> (the size of the local neighborhood for calculating the threshold) and <code class="docutils literal notranslate"><span class="pre">C</span></code> (a constant subtracted from the mean or weighted mean, depending on the method chosen). These parameters control the adaptiveness of the thresholding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.adaptiveThreshold</span></code> supports two adaptive thresholding methods:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.ADAPTIVE_THRESH_MEAN_C</span></code>: The threshold value for each pixel is the mean of the pixel values in its local neighborhood.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.ADAPTIVE_THRESH_GAUSSIAN_C</span></code>: The threshold value for each pixel is the weighted sum of pixel values in its local neighborhood, with weights determined by a Gaussian window.</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">adaptiveMethod</span><span class="p">,</span> <span class="n">thresholdType</span><span class="p">,</span> <span class="n">blockSize</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<section id="id2">
<h3><span class="section-number">8.3.3.1. </span>Binary Thresholding Image Transformation<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>In the context of image thresholding, the <code class="docutils literal notranslate"><span class="pre">cv2.THRESH_BINARY</span></code> method is a fundamental technique used to create binary images from grayscale ones. The core idea can be expressed as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-acb732b0-1b89-48ad-b93b-a29b7de586b4">
<span class="eqno">(8.37)<a class="headerlink" href="#equation-acb732b0-1b89-48ad-b93b-a29b7de586b4" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output }(x,y) = \begin{cases}\text{maximum value}&amp;\mbox{if source(x,y)} &gt; T(x,y),\\0,&amp;\mbox{otherwise}\end{cases}
\end{equation}\]</div>
<p>For more detailed information, you can refer to the <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#adaptivethreshold">OpenCV documentation</a>.</p>
<p><font color='Blue'><b>Example - Binary Thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply adaptive thresholding to the &quot;Img_grayscale&quot; image</span>
    <span class="c1"># Set the maximum value after thresholding to 255</span>
    <span class="c1"># Use cv2.ADAPTIVE_THRESH_MEAN_C as the adaptive method</span>
    <span class="c1"># Use cv2.THRESH_BINARY as the threshold type</span>
    <span class="c1"># Set the block size for local thresholding to 11x11</span>
    <span class="c1"># Set the constant subtracted from the mean to 2</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ADAPTIVE_THRESH_MEAN_C</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Show both the original &quot;Img&quot; image and the thresholded &quot;Out&quot; image</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Thresholded Image&#39;</span><span class="p">],</span>
                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Binary Adaptive Thresholding&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e14a0847fa3e151e5bfeacbcb4b54d5cf1e0ae71286996978979668f670a9f81.png" src="../_images/e14a0847fa3e151e5bfeacbcb4b54d5cf1e0ae71286996978979668f670a9f81.png" />
<img alt="../_images/0ebef7f2fd43cd35cd87635922165b3066eb1b9f69dab62f7215daa0754896d8.png" src="../_images/0ebef7f2fd43cd35cd87635922165b3066eb1b9f69dab62f7215daa0754896d8.png" />
</div>
</div>
</section>
<section id="inverse-binary-thresholding-image-transformation">
<h3><span class="section-number">8.3.3.2. </span>Inverse Binary Thresholding Image Transformation<a class="headerlink" href="#inverse-binary-thresholding-image-transformation" title="Permalink to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-4993dee8-b70e-4b82-9ceb-a1cd861c68bc">
<span class="eqno">(8.38)<a class="headerlink" href="#equation-4993dee8-b70e-4b82-9ceb-a1cd861c68bc" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{Output }(x,y) = \begin{cases}0&amp;\mbox{if source(x,y)} &gt; T(x,y),\\\text{maximum value},&amp;\mbox{otherwise}\end{cases}
\end{equation}\]</div>
<p>For more detailed information, you can refer to the <a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cv2.threshold#adaptivethreshold">OpenCV documentation</a>.</p>
<p><font color='Blue'><b>Example - Inverse Binary Thresholding Image Transformation</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># Iterate through the Images dataset</span>
<span class="k">for</span> <span class="n">Img</span> <span class="ow">in</span> <span class="n">Images</span><span class="p">:</span>
    <span class="c1"># Convert the image to grayscale</span>
    <span class="n">Img_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">Img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># Apply adaptive thresholding to the &quot;Img_grayscale&quot; image</span>
    <span class="c1"># Set the maximum value after thresholding to 255</span>
    <span class="c1"># Use cv2.ADAPTIVE_THRESH_MEAN_C as the adaptive method</span>
    <span class="c1"># Use cv2.THRESH_BINARY_INV as the threshold type</span>
    <span class="c1"># Set the block size for local thresholding to 11x11</span>
    <span class="c1"># Set the constant subtracted from the mean to 2</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">Img_grayscale</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ADAPTIVE_THRESH_MEAN_C</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY_INV</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Show both the original &quot;Img&quot; image and the thresholded &quot;Out&quot; image</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ImShow</span><span class="p">([</span><span class="n">Img</span><span class="p">,</span> <span class="n">Out</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Thresholded Image&#39;</span><span class="p">],</span>
                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Binary Adaptive Thresholding&#39;</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c1a0a09b71cd70ffa878625de1ec36f0dad5910e98ea8cf1c6e7ed1e73c15180.png" src="../_images/c1a0a09b71cd70ffa878625de1ec36f0dad5910e98ea8cf1c6e7ed1e73c15180.png" />
<img alt="../_images/4b11aff39558eae48d9d7321f134afc16383051554990e2ede42638956ea216d.png" src="../_images/4b11aff39558eae48d9d7321f134afc16383051554990e2ede42638956ea216d.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="ENGG_680_C08S2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8.2. </span>Geometric Transformations</p>
      </div>
    </a>
    <a class="right-next"
       href="ENGG_680_C08S4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.4. </span>Image Filtering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-images">8.3.1. Sample Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-thresholding">8.3.2. Simple Thresholding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-thresholding-image-transformation">8.3.2.1. Binary Thresholding Image Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thresh-binary-inv-thresholding">8.3.2.2. THRESH_BINARY_INV Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#truncate-thresholding">8.3.2.3. Truncate Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-zero-thresholding">8.3.2.4. To-Zero Thresholding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-to-zero-thresholding">8.3.2.5. Inverse To-Zero Thresholding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptivethresholding-optional-content">8.3.3. AdaptiveThresholding (Optional Content)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">8.3.3.1. Binary Thresholding Image Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-binary-thresholding-image-transformation">8.3.3.2. Inverse Binary Thresholding Image Transformation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>