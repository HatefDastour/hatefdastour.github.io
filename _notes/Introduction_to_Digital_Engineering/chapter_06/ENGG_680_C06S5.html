

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.5. Combining Datasets using Pandas &#8212; Introduction to Digital Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_06/ENGG_680_C06S5';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.6. Aggregation and Grouping in Pandas" href="ENGG_680_C06S6.html" />
    <link rel="prev" title="6.4. Handling Missing Data in Pandas" href="ENGG_680_C06S4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_01/ReadMe.html">1. Introduction to Python Programming</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S1.html">1.1. Variable names, Expressions and statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S2.html">1.2. Fundamental Concepts and Operations in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/ENGG_680_C01S3.html">1.3. Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_02/ReadMe.html">2. Control Flow: Conditionals, Recursion, and Iteration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S1.html">2.1. Conditionals and recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/ENGG_680_C02S2.html">2.2. Iteration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_03/ReadMe.html">3. Data Structures and File Handling in Python</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S1.html">3.1. Strings in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S2.html">3.2. Python Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S3.html">3.3. Python Dictionaries: Key-Value Pairs in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S4.html">3.4. Python Tuples: Immutable Sequences in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S5.html">3.5. Python Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/ENGG_680_C03S6.html">3.6. Files in Python (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_04/ReadMe.html">4. Classes and Objects</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S1.html">4.1. Introduction to Classes and Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S2.html">4.2. Inheritance and Polymorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S3.html">4.3. Encapsulation and Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S4.html">4.4. Copying Objects (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S5.html">4.5. Magic Methods (Dunder Methods) in Python (Optional Section)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/ENGG_680_C04S6.html">4.6. Examples of Classes (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_05/ReadMe.html">5. Introduction to NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S1.html">5.1. Basics of Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S2.html">5.2. NumPy Function Reference and Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/ENGG_680_C05S3.html">5.3. Advanced Numpy Concepts (Optional Section)</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ReadMe.html">6. Working with Data using Pandas</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C06S1.html">6.1. An Introduction to Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C06S2.html">6.2. DataFrame and Series Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C06S3.html">6.3. Pandas Data Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C06S4.html">6.4. Handling Missing Data in Pandas</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.5. Combining Datasets using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENGG_680_C06S6.html">6.6. Aggregation and Grouping in Pandas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../appendixes/ReadMe.html">7. Appendices</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendixes/SampleQuestions_1.html">7.1. Sample Questions 1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">8. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Combining Datasets using Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-merge">6.5.1. Pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-key-merging">6.5.1.1. Multi-Key Merging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-left-and-right-prefixes">6.5.1.2. Specifying Left and Right Prefixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-on-index">6.5.1.3. Merging on Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-and-filtering-dataframes-in-pandas-using-merge-and-query-optional-section">6.5.1.4. Merging and Filtering DataFrames in Pandas using merge() and query() (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#semi-join-and-anti-join-optional-section">6.5.1.5. Semi-join and Anti-join (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-on-nearest-key-optional-section">6.5.1.6. Merge on Nearest Key (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-merging">6.5.1.7. Categorical Merging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-join">6.5.2. Pandas <code class="docutils literal notranslate"><span class="pre">join</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-join-using-indices">6.5.2.1. Basic Join Using Indices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-join-type-and-suffixes">6.5.2.2. Specifying Join Type and Suffixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-on-a-column-and-index">6.5.2.3. Joining on a Column and Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-with-dataframe-and-series">6.5.2.4. Joining with DataFrame and Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-with-a-multiindex-dataframe">6.5.2.5. Joining with a MultiIndex DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-concat">6.5.3. Pandas <code class="docutils literal notranslate"><span class="pre">concat</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="combining-datasets-using-pandas">
<h1><span class="section-number">6.5. </span>Combining Datasets using Pandas<a class="headerlink" href="#combining-datasets-using-pandas" title="Permalink to this headline">#</a></h1>
<p>Within the Pandas library, <code class="docutils literal notranslate"><span class="pre">merge</span></code>, <code class="docutils literal notranslate"><span class="pre">join</span></code>, and <code class="docutils literal notranslate"><span class="pre">concat</span></code> are fundamental functions that hold pivotal significance in the process of combining and merging data from various DataFrames.</p>
<div class="section" id="pandas-merge">
<h2><span class="section-number">6.5.1. </span>Pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#pandas-merge" title="Permalink to this headline">#</a></h2>
<p>In Pandas, the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function facilitates the merging of two DataFrames based on common columns or indices, resembling the behavior of SQL joins. By specifying the <code class="docutils literal notranslate"><span class="pre">on</span></code> parameter, you can identify the shared column(s) for merging. This function supports various types of joins, such as inner, left, right, and outer joins. To use <code class="docutils literal notranslate"><span class="pre">merge</span></code>, you simply follow this syntax <span id="id1">[<a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">),</span>
         <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, let’s explain each parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code>: The left DataFrame to be merged.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code>: The right DataFrame to be merged.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code>: The type of join to perform: <code class="docutils literal notranslate"><span class="pre">'inner'</span></code>, <code class="docutils literal notranslate"><span class="pre">'outer'</span></code>, <code class="docutils literal notranslate"><span class="pre">'left'</span></code>, <code class="docutils literal notranslate"><span class="pre">'right'</span></code> or , <code class="docutils literal notranslate"><span class="pre">'cross'</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">'inner'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: Column(s) to join on. It can be a single column name or a list of column names.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code>: Column(s) from the left DataFrame to use as join keys.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_on</span></code>: Column(s) from the right DataFrame to use as join keys.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_index</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use the left DataFrame’s index as a join key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_index</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use the right DataFrame’s index as a join key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code>: Sort the result DataFrame by the join keys.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">suffixes</span></code>: Suffixes to add to overlapping column names from both DataFrames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">copy</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, creates copies of input data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indicator</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, adds a column to indicate the source of each row.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validate</span></code>: Validates the merge keys: <code class="docutils literal notranslate"><span class="pre">'one_to_one'</span></code>, <code class="docutils literal notranslate"><span class="pre">'one_to_many'</span></code>, <code class="docutils literal notranslate"><span class="pre">'many_to_one'</span></code>, <code class="docutils literal notranslate"><span class="pre">'many_to_many'</span></code>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function is used to combine two or more DataFrames based on common columns or indices. The <code class="docutils literal notranslate"><span class="pre">how</span></code> parameter determines the type of join (inner, outer, left, right). The <code class="docutils literal notranslate"><span class="pre">on</span></code>, <code class="docutils literal notranslate"><span class="pre">left_on</span></code>, and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> parameters specify which columns to use as keys. The <code class="docutils literal notranslate"><span class="pre">left_index</span></code> and <code class="docutils literal notranslate"><span class="pre">right_index</span></code> parameters indicate whether to use the indices for joining. The <code class="docutils literal notranslate"><span class="pre">suffixes</span></code> parameter is used to handle overlapping column names.</p>
<p>For a comprehensive understanding of the function, you may refer to the complete documentation available <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html">here</a>.</p>
<p>These are the different types of merge operations that you can specify when combining dataframes using the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function in pandas <span id="id2">[<a class="reference internal" href="../References.html#id36" title="W. McKinney. Python for Data Analysis. O'Reilly Media, 2022. ISBN 9781098104009. URL: https://books.google.ca/books?id=EgKBEAAAQBAJ.">McKinney, 2022</a>]</span>:</p>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../_images/join_how.jpg"><img alt="../_images/join_how.jpg" src="../_images/join_how.jpg" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.18 </span><span class="caption-text">Pandas <code class="docutils literal notranslate"><span class="pre">how</span></code> visualization.</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</div>
<ol class="arabic simple">
<li><p><strong>Inner Merge (<code class="docutils literal notranslate"><span class="pre">'inner'</span></code>):</strong></p>
<ul class="simple">
<li><p>The inner merge returns only the rows where the keys (columns used for merging) exist in both dataframes.</p></li>
<li><p>It effectively performs an intersection of the keys and retains only the common rows between the dataframes.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create two DataFrames</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">]})</span>

<span class="c1"># Display the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Perform an inner merge on &#39;ID&#39; column</span>
<span class="n">inner_merged</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

<span class="c1"># Display the result of the inner merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mergerd df:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">inner_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mergerd df:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Bob</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Charlie</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Outer Merge (<code class="docutils literal notranslate"><span class="pre">'outer'</span></code>):</strong></p>
<ul class="simple">
<li><p>The outer merge returns all rows from both dataframes.</p></li>
<li><p>If a key exists in one dataframe but not in the other, the missing values will be filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (or specified fill values) in the resulting dataframe.</p></li>
<li><p>It effectively performs a union of the keys, including all rows from both dataframes.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Perform an outer merge on &#39;ID&#39; and store the result in &#39;outer_merged&#39;</span>
<span class="n">outer_merged</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>

<span class="c1"># Display the result of the outer merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">outer_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>NaN</td>
      <td>22.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Left Merge (<code class="docutils literal notranslate"><span class="pre">'left'</span></code>):</strong></p>
<ul class="simple">
<li><p>The left merge returns all rows from the left dataframe and any matching rows from the right dataframe.</p></li>
<li><p>If a key exists in the left dataframe but not in the right dataframe, the missing values in the right columns will be filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (or specified fill values) in the resulting dataframe.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Perform a left merge on &#39;ID&#39; and store the result in &#39;left_merged&#39;</span>
<span class="n">left_merged</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Display the result of the left merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">left_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="4">
<li><p><strong>Right Merge (<code class="docutils literal notranslate"><span class="pre">'right'</span></code>):</strong></p>
<ul class="simple">
<li><p>The right merge is similar to the left merge but keeps all rows from the right dataframe and includes matching rows from the left dataframe.</p></li>
<li><p>If a key exists in the right dataframe but not in the left dataframe, the missing values in the left columns will be filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (or specified fill values) in the resulting dataframe.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Perform a right merge on &#39;ID&#39; and store the result in &#39;right_merged&#39;</span>
<span class="n">right_merged</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="c1"># Display the result of the right merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">right_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Bob</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Charlie</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>NaN</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="5">
<li><p><strong>Cross Join (<code class="docutils literal notranslate"><span class="pre">'cross'</span></code>):</strong></p>
<ul class="simple">
<li><p>The cross join (also known as a Cartesian product) combines every row from the first dataframe with every row from the second dataframe.</p></li>
<li><p>It results in a dataframe with a size equal to the product of the number of rows in both input dataframes.</p></li>
<li><p>Since it generates a large number of rows, it should be used with caution and only when explicitly needed</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Perform a cross merge on &#39;ID&#39; and store the result in &#39;cross_join&#39;</span>
<span class="n">cross_join</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;cross&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_df1&#39;</span><span class="p">,</span> <span class="s1">&#39;_df2&#39;</span><span class="p">))</span>

<span class="c1"># Display the result of the cross join</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">cross_join</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID_df1</th>
      <th>Name</th>
      <th>ID_df2</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Alice</td>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Alice</td>
      <td>4</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>Bob</td>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>Bob</td>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>Bob</td>
      <td>4</td>
      <td>22</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>Charlie</td>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>Charlie</td>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>Charlie</td>
      <td>4</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here’s a quick summary of their behavior:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Merge Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'inner'</span></code></p></td>
<td><p>Retains rows with matching keys in both dataframes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code></p></td>
<td><p>Retains all rows, filling in missing values with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> for non-matching keys.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'left'</span></code></p></td>
<td><p>Retains all rows from the left dataframe and matches them with rows from the right dataframe.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'right'</span></code></p></td>
<td><p>Retains all rows from the right dataframe and matches them with rows from the left dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'cross'</span></code></p></td>
<td><p>Generates a new dataframe with all possible combinations of rows from both dataframes.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="multi-key-merging">
<h3><span class="section-number">6.5.1.1. </span>Multi-Key Merging<a class="headerlink" href="#multi-key-merging" title="Permalink to this headline">#</a></h3>
<p>You can merge DataFrames on multiple columns by passing a list of column names to the <code class="docutils literal notranslate"><span class="pre">on</span></code> parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create the first DataFrame</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
                    <span class="p">})</span>

<span class="c1"># Create the second DataFrame</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
                    <span class="p">})</span>

<span class="c1"># Display the first DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="c1"># Display the second DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Merge the DataFrames based on the common keys &#39;key1&#39; and &#39;key2&#39;</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>

<span class="c1"># Display the merged DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>X</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>Y</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>Z</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>Y</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>Z</td>
      <td>50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>D</td>
      <td>W</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>value_x</th>
      <th>value_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>Y</td>
      <td>20</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>Z</td>
      <td>30</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The resulting DataFrame contains only the rows where ‘key1’ and ‘key2’ values were common between <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code>, and it shows the corresponding values from both DataFrames in separate columns (‘value_x’ and ‘value_y’).</p>
</div>
<div class="section" id="specifying-left-and-right-prefixes">
<h3><span class="section-number">6.5.1.2. </span>Specifying Left and Right Prefixes<a class="headerlink" href="#specifying-left-and-right-prefixes" title="Permalink to this headline">#</a></h3>
<p>When merging DataFrames with overlapping column names, you can specify prefixes to differentiate them.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">],</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>value_left</th>
      <th>value_right</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>Y</td>
      <td>20</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>Z</td>
      <td>30</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="merging-on-index">
<h3><span class="section-number">6.5.1.3. </span>Merging on Index<a class="headerlink" href="#merging-on-index" title="Permalink to this headline">#</a></h3>
<p>You can merge DataFrames based on their indices using the <code class="docutils literal notranslate"><span class="pre">left_index</span></code> and <code class="docutils literal notranslate"><span class="pre">right_index</span></code> parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Assuming df1 and df2 are already defined</span>

<span class="c1"># Set the index of df1 to &#39;key1&#39;</span>
<span class="n">df1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set the index of df2 to &#39;key1&#39;</span>
<span class="n">df2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge the DataFrames based on their index (key1)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Display the merged DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key2_x</th>
      <th>value_x</th>
      <th>key2_y</th>
      <th>value_y</th>
    </tr>
    <tr>
      <th>key1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>B</th>
      <td>Y</td>
      <td>20</td>
      <td>Y</td>
      <td>40</td>
    </tr>
    <tr>
      <th>C</th>
      <td>Z</td>
      <td>30</td>
      <td>Z</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="merging-and-filtering-dataframes-in-pandas-using-merge-and-query-optional-section">
<h3><span class="section-number">6.5.1.4. </span>Merging and Filtering DataFrames in Pandas using merge() and query() (Optional Section)<a class="headerlink" href="#merging-and-filtering-dataframes-in-pandas-using-merge-and-query-optional-section" title="Permalink to this headline">#</a></h3>
<p>In Pandas, the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function is used to combine two or more DataFrames based on a common column or index. The <code class="docutils literal notranslate"><span class="pre">query()</span></code> function is used to filter rows from a DataFrame based on a given condition. Although you can use both functions separately, there might be scenarios where you want to merge DataFrames and then filter the result using a query <span id="id3">[<a class="reference internal" href="../References.html#id36" title="W. McKinney. Python for Data Analysis. O'Reilly Media, 2022. ISBN 9781098104009. URL: https://books.google.ca/books?id=EgKBEAAAQBAJ.">McKinney, 2022</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<p><font color='Blue'><b>Example</b></font>: Let’s assume you have two DataFrames, <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code>, and you want to merge them based on a common column, and then filter the merged result using a query condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Sample data for df1</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                    <span class="s1">&#39;Value1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                    <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="c1"># Sample data for df2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                    <span class="s1">&#39;Value2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                    <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Merge the two DataFrames on the &#39;ID&#39; column using an inner join</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>

<span class="c1"># Filter the merged DataFrame using the query function</span>
<span class="n">filtered_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Value1 &gt; 15 and Value2 &lt; 400&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Filtered:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>400</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>600</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
      <th>Value2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtered:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
      <th>Value2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="semi-join-and-anti-join-optional-section">
<h3><span class="section-number">6.5.1.5. </span>Semi-join and Anti-join (Optional Section)<a class="headerlink" href="#semi-join-and-anti-join-optional-section" title="Permalink to this headline">#</a></h3>
<p>Semi-join and anti-join are concepts in relational database management systems that involve combining two tables based on a common column but with specific filtering conditions. These concepts are useful for filtering and retrieving rows that meet certain criteria while excluding others <span id="id4">[<a class="reference internal" href="../References.html#id38" title="J. Rioux. Data Analysis with Python and PySpark. Manning, 2022. ISBN 9781617297205. URL: https://books.google.ca/books?id=4ytfEAAAQBAJ.">Rioux, 2022</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="../_images/semi_join.jpg"><img alt="../_images/semi_join.jpg" src="../_images/semi_join.jpg" style="width: 450px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.19 </span><span class="caption-text">Semi join and Anti-join</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</div>
<ol class="arabic simple">
<li><p><strong>Semi-Join</strong>:
A semi-join is a type of join operation that returns rows from the first table that match the condition in the second table. In other words, it selects rows from one table where there is a match in the other table based on a specified column. However, unlike a regular join, only the columns from the first table are included in the result <span id="id5">[<a class="reference internal" href="../References.html#id38" title="J. Rioux. Data Analysis with Python and PySpark. Manning, 2022. ISBN 9781617297205. URL: https://books.google.ca/books?id=4ytfEAAAQBAJ.">Rioux, 2022</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p></li>
<li><p><strong>Anti-Join</strong>:
An anti-join, also known as an anti-semi-join or difference join, is the opposite of a semi-join. It returns rows from the first table that do not have a match in the second table based on a specified column. Essentially, it filters out rows from the first table that meet a certain condition found in the second table <span id="id6">[<a class="reference internal" href="../References.html#id38" title="J. Rioux. Data Analysis with Python and PySpark. Manning, 2022. ISBN 9781617297205. URL: https://books.google.ca/books?id=4ytfEAAAQBAJ.">Rioux, 2022</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p></li>
</ol>
<div class="important admonition">
<p class="admonition-title">Remark</p>
<ul class="simple">
<li><p>Semi-joins are typically used to filter data based on a condition present in another table.</p></li>
<li><p>Anti-joins are useful for finding records that are not present in another table or for excluding certain records that meet a certain criterion.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Assuming df1 and df2 are already defined</span>

<span class="c1"># Print and display df1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="c1"># Print and display df2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Semi-Join: Get rows from df1 that have matching IDs in df2</span>
<span class="n">semi_join_result</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])]</span>

<span class="c1"># Anti-Join: Get rows from df1 that do not have matching IDs in df2</span>
<span class="n">anti_join_result</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="o">~</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])]</span>

<span class="c1"># Print Semi-Join Result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Semi-Join Result:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">semi_join_result</span><span class="p">)</span>

<span class="c1"># Print Anti-Join Result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anti-Join Result:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">anti_join_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>400</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>600</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Semi-Join Result:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Anti-Join Result:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In SQL, you can use the <code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">JOIN</span></code> (for semi-join) and <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">IN</span></code> or <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">EXISTS</span></code> (for anti-join) constructs to achieve these types of joins.</p>
<p>In Pandas, you can simulate these types of joins using various methods. For example, to perform a semi-join, you could use the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function with the desired <code class="docutils literal notranslate"><span class="pre">how</span></code> parameter and then select the columns you want. For an anti-join, you could use the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function with the <code class="docutils literal notranslate"><span class="pre">indicator</span></code> parameter and then filter out the matching rows <span id="id7">[<a class="reference internal" href="../References.html#id38" title="J. Rioux. Data Analysis with Python and PySpark. Manning, 2022. ISBN 9781617297205. URL: https://books.google.ca/books?id=4ytfEAAAQBAJ.">Rioux, 2022</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<p>Here’s a simplified example in Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Semi Join: Customers who have made orders</span>
<span class="n">semi_join_df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">[[</span><span class="s1">&#39;ID&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">semi_join_df</span> <span class="o">=</span> <span class="n">semi_join_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;_merge == &quot;both&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Semi-Join Result:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">semi_join_df</span><span class="p">)</span>

<span class="c1"># Anti Join: Customers who have not made orders</span>
<span class="n">anti_join_df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">[[</span><span class="s1">&#39;ID&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">anti_join_df</span> <span class="o">=</span> <span class="n">anti_join_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;_merge == &quot;left_only&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;_merge&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anti-Join Result:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">anti_join_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Semi-Join Result:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Anti-Join Result:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Set Theory Notation for Joins:</strong></p>
<ol class="arabic simple">
<li><p><strong>Inner Join:</strong></p>
<ul class="simple">
<li><p>Set Theory: A ∩ B</p></li>
<li><p>Description: Includes rows that have matching values in both A and B.</p></li>
</ul>
</li>
<li><p><strong>Outer Join (Full Outer Join):</strong></p>
<ul class="simple">
<li><p>Set Theory: A ∪ B</p></li>
<li><p>Description: Includes all rows from both A and B, with missing values for non-matching rows.</p></li>
</ul>
</li>
<li><p><strong>Left Join:</strong></p>
<ul class="simple">
<li><p>Set Theory: A ∪ (A ∩ B)</p></li>
<li><p>Description: Includes all rows from A and only the matching rows from B.</p></li>
</ul>
</li>
<li><p><strong>Right Join:</strong></p>
<ul class="simple">
<li><p>Set Theory: B ∪ (A ∩ B)</p></li>
<li><p>Description: Includes all rows from B and only the matching rows from A.</p></li>
</ul>
</li>
<li><p><strong>Cross Join (Cartesian Join):</strong></p>
<ul class="simple">
<li><p>Set Theory: A × B</p></li>
<li><p>Description: Creates all possible combinations of rows from A and B.</p></li>
</ul>
</li>
<li><p><strong>Semi-Join (Left or Right):</strong></p>
<ul class="simple">
<li><p>Set Theory: A ∩ B</p></li>
<li><p>Description: Includes rows from one DataFrame (A or B) that have matching values in the other DataFrame.</p></li>
</ul>
</li>
<li><p><strong>Anti-Join:</strong></p>
<ul class="simple">
<li><p>Set Theory: B - (A ∩ B)</p></li>
<li><p>Description: Includes rows from B that do not have matching values in A.</p></li>
</ul>
</li>
</ol>
<p><strong>Summary:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Join Type</p></th>
<th class="head"><p>Notation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Inner Join</p></td>
<td><p>A ∩ B</p></td>
<td><p>Rows with matching values in both A and B</p></td>
</tr>
<tr class="row-odd"><td><p>Outer Join</p></td>
<td><p>A ∪ B</p></td>
<td><p>All rows from both A and B, with missing values</p></td>
</tr>
<tr class="row-even"><td><p>Left Join</p></td>
<td><p>A ∪ (A ∩ B)</p></td>
<td><p>All rows from A, only matching rows from B</p></td>
</tr>
<tr class="row-odd"><td><p>Right Join</p></td>
<td><p>B ∪ (A ∩ B)</p></td>
<td><p>All rows from B, only matching rows from A</p></td>
</tr>
<tr class="row-even"><td><p>Cross Join</p></td>
<td><p>A × B</p></td>
<td><p>All possible combinations of rows from A and B</p></td>
</tr>
<tr class="row-odd"><td><p>Semi-Join</p></td>
<td><p>A ∩ B</p></td>
<td><p>Rows from one DataFrame (A or B) with matching values</p></td>
</tr>
<tr class="row-even"><td><p>Anti-Join</p></td>
<td><p>B - (A ∩ B)</p></td>
<td><p>Rows from B without matching values in A</p></td>
</tr>
</tbody>
</table>
<p>This table summarizes the various types of joins using set theory notation and provides brief descriptions of each join operation.</p>
</div>
<div class="section" id="merge-on-nearest-key-optional-section">
<h3><span class="section-number">6.5.1.6. </span>Merge on Nearest Key (Optional Section)<a class="headerlink" href="#merge-on-nearest-key-optional-section" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pd.merge_asof()</span></code> function in Pandas is used to perform a merge based on the nearest key, particularly for ordered data. It’s often used when you want to match records in two datasets based on a key column, but the values in the key column <strong>may not match exactly</strong>. Instead of requiring exact matches, this function allows you to match the nearest key values within a specified tolerance <span id="id8">[<a class="reference internal" href="../References.html#id11" title="Wes McKinney and others. Data structures for statistical computing in python. In Proceedings of the 9th Python in Science Conference, volume 445, 51–56. Austin, TX, 2010.">McKinney and others, 2010</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<p>Here’s the syntax of the <code class="docutils literal notranslate"><span class="pre">pd.merge_asof()</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">left_index</span><span class="p">,</span> <span class="n">right_index</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code>: The left DataFrame to merge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code>: The right DataFrame to merge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: The column name to use as the key for merging. It must be present in both DataFrames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by</span></code>: A list of columns to be used as additional keys for merging.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code>, <code class="docutils literal notranslate"><span class="pre">right_on</span></code>: Columns from the left and right DataFrames to use as keys instead of the <code class="docutils literal notranslate"><span class="pre">on</span></code> parameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_index</span></code>, <code class="docutils literal notranslate"><span class="pre">right_index</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use the index of the left or right DataFrame as a key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span></code>: Specifies whether to search for the nearest key in ‘backward’ or ‘forward’ direction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code>: The maximum allowable difference between key values for a successful match.</p></li>
</ul>
<p>Here’s an explanation of the parameters using an example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating stock price and economic data DataFrames</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01 09:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01 09:15:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01 09:30:00&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;stock_symbol&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">150.20</span><span class="p">,</span> <span class="mf">152.40</span><span class="p">,</span> <span class="mf">153.10</span><span class="p">]</span>
                             <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Stock Prices:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">stock_prices</span><span class="p">)</span>

<span class="n">economic_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2023-01-01 09:05:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01 09:25:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01 09:40:00&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;indicator&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GDP&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">,</span> <span class="s1">&#39;Inflation&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">]</span>
                              <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Economic Data:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">economic_data</span><span class="p">)</span>

<span class="c1"># Converting timestamps to datetime format</span>
<span class="n">stock_prices</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">stock_prices</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="n">economic_data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">economic_data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>

<span class="c1"># Merging based on the nearest key</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">stock_prices</span><span class="p">,</span> <span class="n">economic_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

<span class="c1"># Displaying the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Merged DataFrame:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stock Prices:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>stock_symbol</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-01-01 09:00:00</td>
      <td>AAPL</td>
      <td>150.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-01-01 09:15:00</td>
      <td>AAPL</td>
      <td>152.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023-01-01 09:30:00</td>
      <td>AAPL</td>
      <td>153.1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Economic Data:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>indicator</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-01-01 09:05:00</td>
      <td>GDP</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-01-01 09:25:00</td>
      <td>Unemployment</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023-01-01 09:40:00</td>
      <td>Inflation</td>
      <td>2.2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merged DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>stock_symbol</th>
      <th>price</th>
      <th>indicator</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-01-01 09:00:00</td>
      <td>AAPL</td>
      <td>150.2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-01-01 09:15:00</td>
      <td>AAPL</td>
      <td>152.4</td>
      <td>GDP</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023-01-01 09:30:00</td>
      <td>AAPL</td>
      <td>153.1</td>
      <td>Unemployment</td>
      <td>4.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="important admonition">
<p class="admonition-title">Remark</p>
<p>The choice between using <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.merge_asof</span></code> depends on the specific use case and the desired merging behavior. Both methods are useful for merging datasets, but they have different purposes and are suited for different scenarios.</p>
<p><code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> is generally used for precise merges on exact match conditions, including merges on columns other than datetime. It provides options for different types of joins (e.g., inner, outer, left, right), and it requires an exact match on the specified merge column(s).</p>
<p><code class="docutils literal notranslate"><span class="pre">pd.merge_asof</span></code>, on the other hand, is specifically designed for merging based on nearest key(s) with an optional tolerance. This method is particularly useful when you want to merge datasets based on datetime columns, and you want to match rows within a certain time range (tolerance) rather than requiring an exact match.</p>
<p>Here’s an example of when you might prefer to use <code class="docutils literal notranslate"><span class="pre">pd.merge_asof</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Sample DataFrames with datetime columns</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-02-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-04-01&quot;</span><span class="p">],</span>
    <span class="s2">&quot;value1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2023-01-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-03-15&quot;</span><span class="p">],</span>
    <span class="s2">&quot;value2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="c1"># Convert the &#39;datetime&#39; column to datetime format</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span>

<span class="c1"># Merge based on nearest datetime with a tolerance</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>

<span class="c1"># Print the merged DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">datetime</span>  <span class="n">value1</span>  <span class="n">value2</span>
<span class="mi">0</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>      <span class="mi">10</span>     <span class="n">NaN</span>
<span class="mi">1</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>      <span class="mi">20</span>     <span class="n">NaN</span>
<span class="mi">2</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span>      <span class="mi">30</span>   <span class="mf">200.0</span>
<span class="mi">3</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>      <span class="mi">40</span>     <span class="n">NaN</span>
</pre></div>
</div>
<p>In this code, <code class="docutils literal notranslate"><span class="pre">pd.merge_asof</span></code> is used to merge <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code> based on the “datetime” column with a tolerance of 15 days. This means rows from <code class="docutils literal notranslate"><span class="pre">df2</span></code> will be matched to the nearest row in <code class="docutils literal notranslate"><span class="pre">df1</span></code> based on the datetime column, allowing for a difference of up to 15 days.</p>
</div>
</div>
<div class="section" id="categorical-merging">
<h3><span class="section-number">6.5.1.7. </span>Categorical Merging<a class="headerlink" href="#categorical-merging" title="Permalink to this headline">#</a></h3>
<p>If your data has categorical variables, you can use categorical merging for better performance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;category_column&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><font color='Blue'><b>Example</b></font>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Generating example data</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>  <span class="c1"># Number of rows</span>
<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
    <span class="s1">&#39;category_column&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="p">})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;category_column&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">),</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># Regular merging (without categorical data type)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">regular_merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;category_column&#39;</span><span class="p">)</span>
<span class="n">regular_merge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Converting the &#39;category_column&#39; to categorical data type</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;category_column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># Categorical merging</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">categorical_merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;category_column&#39;</span><span class="p">)</span>
<span class="n">categorical_merge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Displaying results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regular Merge Time: </span><span class="si">{</span><span class="n">regular_merge_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Categorical Merge Time: </span><span class="si">{</span><span class="n">categorical_merge_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Regular Merge Time: 0.511
Categorical Merge Time: 0.319
</pre></div>
</div>
</div>
</div>
<p>In this example, we generate two DataFrames, df1 and df2, with a categorical column ‘category_column’. We then compare the performance of regular merging versus categorical merging.</p>
<p>Categorical merging can offer better performance, especially when dealing with large datasets, because categorical data types use integer-based codes internally, reducing memory usage and speeding up comparison operations. As a result, merging operations involving categorical columns can be more efficient.</p>
<p>Remember that the actual performance gain will depend on various factors including the size of your dataset and the specific operations being performed. Always consider the benefits of categorical data types based on your use case.</p>
<p>These advanced merging techniques provide more flexibility and control over how you combine datasets using Pandas. Be sure to refer to the Pandas documentation for detailed information on these methods and their parameters: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html</a></p>
</div>
</div>
<div class="section" id="pandas-join">
<h2><span class="section-number">6.5.2. </span>Pandas <code class="docutils literal notranslate"><span class="pre">join</span></code><a class="headerlink" href="#pandas-join" title="Permalink to this headline">#</a></h2>
<p>In pandas, the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method is used to combine two DataFrame objects based on their index or on a key column. It is one of the methods for data alignment and merging in pandas. This operation can be compared to a database-style join.
The basic syntax for the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method is as follows <span id="id9">[<a class="reference internal" href="../References.html#id11" title="Wes McKinney and others. Data structures for statistical computing in python. In Proceedings of the 9th Python in Science Conference, volume 445, 51–56. Austin, TX, 2010.">McKinney and others, 2010</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">left_dataframe</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right_dataframe</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">left_dataframe</span></code> is the DataFrame to which you want to join another DataFrame (<code class="docutils literal notranslate"><span class="pre">right_dataframe</span></code>). The <code class="docutils literal notranslate"><span class="pre">how</span></code> parameter specifies the type of join to perform, and it can take the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'inner'</span></code>: Performs an inner join, keeping only the rows that have matching keys in both DataFrames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code>: Performs an outer join, keeping all the rows from both DataFrames and filling in NaN values for missing keys.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'left'</span></code>: Performs a left join, keeping all the rows from the left DataFrame and filling in NaN values for missing keys in the right DataFrame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'right'</span></code>: Performs a right join, keeping all the rows from the right DataFrame and filling in NaN values for missing keys in the left DataFrame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cross'</span></code>: “The cross merge method produces the Cartesian product of both data frames while maintaining the original order of the left keys.”</p></li>
</ul>
<p>For a comprehensive description of the function, please refer to the official documentation <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html">here</a>.</p>
<div class="section" id="basic-join-using-indices">
<h3><span class="section-number">6.5.2.1. </span>Basic Join Using Indices<a class="headerlink" href="#basic-join-using-indices" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating example DataFrames</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">])</span>

<span class="c1"># Title: Joining DataFrames Based on Indices</span>

<span class="c1"># Print the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original df1:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original df2:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Joining based on indices</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Title: Displaying the Result</span>

<span class="c1"># Print the resulting joined DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Joined DataFrame (based on indices):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joined DataFrame (based on indices):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The code demonstrates how the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method can be used to combine two DataFrames using their indices, resulting in a new DataFrame where columns from both DataFrames are aligned based on the shared index labels. In this example, the resulting DataFrame will have columns ‘A’, ‘B’, ‘C’, and ‘D’.</p>
</div>
<div class="section" id="specifying-join-type-and-suffixes">
<h3><span class="section-number">6.5.2.2. </span>Specifying Join Type and Suffixes<a class="headerlink" href="#specifying-join-type-and-suffixes" title="Permalink to this headline">#</a></h3>
<p>In data manipulation with Pandas, specifying the join type and using custom suffixes can be essential when combining DataFrames.</p>
<p><font color='Blue'><b>Example:</b></font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating example DataFrames</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">])</span>

<span class="c1"># Title: Joining DataFrames with Custom Suffixes</span>

<span class="c1"># Print the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original df1:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original df2:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Performing an inner join with custom suffixes</span>
<span class="n">joined_df_inner</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_right&#39;</span><span class="p">)</span>

<span class="c1"># Title: Displaying the Result</span>

<span class="c1"># Print the resulting joined DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Joined DataFrame (inner join with custom suffixes):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df_inner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original df1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original df2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joined DataFrame (inner join with custom suffixes):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B_left</th>
      <th>B_right</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This code snippet demonstrates how to use the Pandas library in Python to create, join, and display DataFrames:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df1</span> <span class="pre">=</span> <span class="pre">pd.DataFrame({'A':</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3],</span> <span class="pre">'B':</span> <span class="pre">[4,</span> <span class="pre">5,</span> <span class="pre">6]},</span> <span class="pre">index=['X',</span> <span class="pre">'Y',</span> <span class="pre">'Z'])</span></code>: Here, we create the first DataFrame, <code class="docutils literal notranslate"><span class="pre">df1</span></code>, with two columns ‘A’ and ‘B’, each containing a list of values. The <code class="docutils literal notranslate"><span class="pre">index</span></code> parameter assigns custom row indices ‘X’, ‘Y’, and ‘Z’ to the DataFrame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df2</span> <span class="pre">=</span> <span class="pre">pd.DataFrame({'B':</span> <span class="pre">[7,</span> <span class="pre">8,</span> <span class="pre">9],</span> <span class="pre">'D':</span> <span class="pre">[10,</span> <span class="pre">11,</span> <span class="pre">12]},</span> <span class="pre">index=['X',</span> <span class="pre">'Y',</span> <span class="pre">'Z'])</span></code>: Similarly, the second DataFrame, <code class="docutils literal notranslate"><span class="pre">df2</span></code>, is created with columns ‘B’ and ‘D’, along with the same custom row indices as <code class="docutils literal notranslate"><span class="pre">df1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">joined_df_inner</span> <span class="pre">=</span> <span class="pre">df1.join(df2,</span> <span class="pre">how='inner',</span> <span class="pre">lsuffix='_left',</span> <span class="pre">rsuffix='_right')</span></code>: This line performs an inner join operation between <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code> using the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method. The <code class="docutils literal notranslate"><span class="pre">how='inner'</span></code> argument specifies an inner join, which retains only the rows with matching indices in both DataFrames. Additionally, the <code class="docutils literal notranslate"><span class="pre">lsuffix='_left'</span></code> and <code class="docutils literal notranslate"><span class="pre">rsuffix='_right'</span></code> arguments are used to add custom suffixes to the columns with identical names in the two DataFrames to differentiate them.</p></li>
</ol>
</div>
<div class="section" id="joining-on-a-column-and-index">
<h3><span class="section-number">6.5.2.3. </span>Joining on a Column and Index<a class="headerlink" href="#joining-on-a-column-and-index" title="Permalink to this headline">#</a></h3>
<p>In data manipulation with Pandas, it’s often necessary to combine DataFrames based on both columns and indices.</p>
<p><font color='Blue'><b>Example:</b></font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating example DataFrames</span>
<span class="n">students_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;student_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                            <span class="s1">&#39;student_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">]})</span>

<span class="n">scores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">]},</span>
                          <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># Index matches &#39;student_id&#39;</span>

<span class="c1"># Title: Joining on a Column and Index</span>

<span class="c1"># Print the original DataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original students_df:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">students_df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original scores_df:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">scores_df</span><span class="p">)</span>

<span class="c1"># Joining students_df with scores_df on student_id and index</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">students_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scores_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;student_id&#39;</span><span class="p">)</span>

<span class="c1"># Title: Displaying the Result</span>

<span class="c1"># Print the resulting joined DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Joined DataFrame:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original students_df:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>student_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original scores_df:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>92</td>
    </tr>
    <tr>
      <th>3</th>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joined DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>student_name</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Alice</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Bob</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Charlie</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The code demonstrates how to use the join() method to combine DataFrames on a specified column and index, effectively matching information from both DataFrames based on the shared ‘student_id’. The displayed output will show the combined information of student names and scores.</p>
<p><font color='Blue'><b>Example:</b></font> The following Python code exemplifies the process of merging two Pandas DataFrames based on both a shared column and an index. These DataFrames pertain to city information, with a specific focus on cities located in the province of Alberta, Canada. It’s important to acknowledge that there might be discrepancies between the population figures presented in this example and the precise figures for the year 2023. For precise and up-to-date population statistics, it is advisable to consult official sources such as <a class="reference external" href="https://www.alberta.ca/population-statistics">https://www.alberta.ca/population-statistics</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a City DataFrame with city names and populations</span>
<span class="n">cities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;City_Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Calgary&#39;</span><span class="p">,</span> <span class="s1">&#39;Edmonton&#39;</span><span class="p">,</span> <span class="s1">&#39;Lethbridge&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;Population&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">640000</span><span class="p">,</span> <span class="mi">1544000</span><span class="p">,</span> <span class="mi">106550</span><span class="p">]})</span>
<span class="c1"># Display the City DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">cities_df</span><span class="p">)</span>

<span class="c1"># Create an Additional Details DataFrame with &#39;City_Name&#39; as the index</span>
<span class="n">details_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;City_Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Calgary&#39;</span><span class="p">,</span> <span class="s1">&#39;Edmonton&#39;</span><span class="p">,</span> <span class="s1">&#39;Lethbridge&#39;</span><span class="p">],</span>
                           <span class="s1">&#39;Province&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alberta&#39;</span><span class="p">,</span> <span class="s1">&#39;Alberta&#39;</span><span class="p">,</span> <span class="s1">&#39;Alberta&#39;</span><span class="p">],</span>
                           <span class="s1">&#39;Area (km^2)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">825.3</span><span class="p">,</span> <span class="mf">684.47</span><span class="p">,</span> <span class="mf">127.2</span><span class="p">]})</span>
<span class="c1"># Set &#39;City_Name&#39; as the index for the Additional Details DataFrame</span>
<span class="n">details_df</span> <span class="o">=</span> <span class="n">details_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;City_Name&#39;</span><span class="p">)</span>
<span class="c1"># Display the Additional Details DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">details_df</span><span class="p">)</span>

<span class="c1"># Join the City DataFrame with the Additional Details DataFrame using both the &#39;City_Name&#39; column and index</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">cities_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">details_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;City_Name&#39;</span><span class="p">)</span>

<span class="c1"># Display the resulting joined DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>City_Name</th>
      <th>Population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calgary</td>
      <td>640000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Edmonton</td>
      <td>1544000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lethbridge</td>
      <td>106550</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Province</th>
      <th>Area (km^2)</th>
    </tr>
    <tr>
      <th>City_Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Calgary</th>
      <td>Alberta</td>
      <td>825.30</td>
    </tr>
    <tr>
      <th>Edmonton</th>
      <td>Alberta</td>
      <td>684.47</td>
    </tr>
    <tr>
      <th>Lethbridge</th>
      <td>Alberta</td>
      <td>127.20</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>City_Name</th>
      <th>Population</th>
      <th>Province</th>
      <th>Area (km^2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calgary</td>
      <td>640000</td>
      <td>Alberta</td>
      <td>825.30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Edmonton</td>
      <td>1544000</td>
      <td>Alberta</td>
      <td>684.47</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lethbridge</td>
      <td>106550</td>
      <td>Alberta</td>
      <td>127.20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="joining-with-dataframe-and-series">
<h3><span class="section-number">6.5.2.4. </span>Joining with DataFrame and Series<a class="headerlink" href="#joining-with-dataframe-and-series" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating a DataFrame and a Series</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>

<span class="c1"># Title: Joining a DataFrame with a Series</span>

<span class="c1"># Print the original DataFrame and Series</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame (df):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original Series (series):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="c1"># Joining the DataFrame with the Series</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="c1"># Title: Displaying the Result</span>

<span class="c1"># Print the resulting joined DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Joined DataFrame:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original DataFrame (df):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Series (series):
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    10
1    20
2    30
Name: C, dtype: int64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joined DataFrame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="joining-with-a-multiindex-dataframe">
<h3><span class="section-number">6.5.2.5. </span>Joining with a MultiIndex DataFrame<a class="headerlink" href="#joining-with-a-multiindex-dataframe" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Creating example DataFrames with MultiIndex</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
                   <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df2&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="c1"># Joining df1 with df2 on the MultiIndex &#39;idx&#39; and &#39;value&#39;</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>

<span class="c1"># Displaying the result</span>
<span class="n">display</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df1
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
    </tr>
    <tr>
      <th>idx</th>
      <th>value</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <th>1</th>
      <td>10</td>
    </tr>
    <tr>
      <th>Y</th>
      <th>2</th>
      <td>20</td>
    </tr>
    <tr>
      <th>Z</th>
      <th>3</th>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df2
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>B</th>
    </tr>
    <tr>
      <th>idx</th>
      <th>value</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <th>1</th>
      <td>100</td>
    </tr>
    <tr>
      <th>Y</th>
      <th>2</th>
      <td>200</td>
    </tr>
    <tr>
      <th>Z</th>
      <th>4</th>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>idx</th>
      <th>value</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <th>1</th>
      <td>10</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>Y</th>
      <th>2</th>
      <td>20</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>Z</th>
      <th>3</th>
      <td>30</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This example demonstrates how to use the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method to combine DataFrames with MultiIndexes based on specific MultiIndex levels.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">join()</span></code> method in Pandas is useful when working with indexed data and when you want a more concise way to combine DataFrames. It offers flexibility in terms of specifying join types, handling multi-index data, and broadcasting along different axes. Remember to consult the Pandas documentation for more information on the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method and its parameters: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html</a></p>
</div>
</div>
<div class="section" id="pandas-concat">
<h2><span class="section-number">6.5.3. </span>Pandas <code class="docutils literal notranslate"><span class="pre">concat</span></code><a class="headerlink" href="#pandas-concat" title="Permalink to this headline">#</a></h2>
<p>In pandas, the <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function is used to concatenate two or more DataFrames along a particular axis (either row-wise or column-wise). This allows you to combine multiple DataFrames into a single DataFrame. The <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function is quite versatile and can handle different concatenation scenarios.
The basic syntax for the <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function is as follows <span id="id10">[<a class="reference internal" href="../References.html#id11" title="Wes McKinney and others. Data structures for statistical computing in python. In Proceedings of the 9th Python in Science Conference, volume 445, 51–56. Austin, TX, 2010.">McKinney and others, 2010</a>, <a class="reference internal" href="../References.html#id10" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">df1</span></code>, <code class="docutils literal notranslate"><span class="pre">df2</span></code>, etc., are the DataFrames you want to concatenate. The <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter specifies the axis along which the concatenation will be performed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">axis=0</span></code> (default): Concatenate along the rows (vertical concatenation).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis=1</span></code>: Concatenate along the columns (horizontal concatenation).</p></li>
</ul>
<p><font color='Blue'><b>Example</b></font>: Vertical Concatenation (Concatenate along rows)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Sample DataFrames</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]}</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="c1"># Concatenate vertically (along rows)</span>
<span class="n">result_vertical</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Display the concatenated DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">result_vertical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='Blue'><b>Example</b></font>: Horizontal Concatenation (Concatenate along columns)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Sample DataFrames</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]}</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="c1"># Concatenate horizontally (along columns)</span>
<span class="n">result_horizontal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Display the concatenated DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">result_horizontal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that when concatenating along a particular axis, the DataFrames should have compatible shapes along that axis (i.e., the number of rows for vertical concatenation and the number of columns for horizontal concatenation).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function also allows you to handle duplicate indices, specify whether to ignore the original indices, and more. For more complex concatenation scenarios, you can refer to the pandas documentation: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="ENGG_680_C06S4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.4. </span>Handling Missing Data in Pandas</p>
      </div>
    </a>
    <a class="right-next"
       href="ENGG_680_C06S6.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.6. </span>Aggregation and Grouping in Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-merge">6.5.1. Pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-key-merging">6.5.1.1. Multi-Key Merging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-left-and-right-prefixes">6.5.1.2. Specifying Left and Right Prefixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-on-index">6.5.1.3. Merging on Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-and-filtering-dataframes-in-pandas-using-merge-and-query-optional-section">6.5.1.4. Merging and Filtering DataFrames in Pandas using merge() and query() (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#semi-join-and-anti-join-optional-section">6.5.1.5. Semi-join and Anti-join (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-on-nearest-key-optional-section">6.5.1.6. Merge on Nearest Key (Optional Section)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-merging">6.5.1.7. Categorical Merging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-join">6.5.2. Pandas <code class="docutils literal notranslate"><span class="pre">join</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-join-using-indices">6.5.2.1. Basic Join Using Indices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-join-type-and-suffixes">6.5.2.2. Specifying Join Type and Suffixes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-on-a-column-and-index">6.5.2.3. Joining on a Column and Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-with-dataframe-and-series">6.5.2.4. Joining with DataFrame and Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-with-a-multiindex-dataframe">6.5.2.5. Joining with a MultiIndex DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-concat">6.5.3. Pandas <code class="docutils literal notranslate"><span class="pre">concat</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>