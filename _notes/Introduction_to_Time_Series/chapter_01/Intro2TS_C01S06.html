
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6. Cross-Correlation in Time Series &#8212; Introduction to Time Series</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=564be945" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_01/Intro2TS_C01S06';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Missing Data in Time Series" href="../chapter_02/Intro2TS_C02.html" />
    <link rel="prev" title="1.5. What Are ACF and PACF?" href="Intro2TS_C01S05.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../Preface.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Time Series - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Time Series - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Intro2TS_C01.html">1. Introduction to Time Series</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Intro2TS_C01S01.html">1.1. What are Time Series?</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intro2TS_C01S02.html">1.2. Best Sources for Public Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intro2TS_C01S03.html">1.3. Time Series Cross-Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intro2TS_C01S04.html">1.4. Time Series Visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intro2TS_C01S05.html">1.5. What Are ACF and PACF?</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">1.6. Cross-Correlation in Time Series</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_02/Intro2TS_C02.html">2. Missing Data in Time Series</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/Intro2TS_C02S01.html">2.1. Types of Missing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/Intro2TS_C02S02.html">2.2. Identifying Patterns of Missingness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/Intro2TS_C02S03.html">2.3. Handling Missing Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/Intro2TS_C02S04.html">2.4. Advanced Imputation with K-Nearest Neighbors (KNN)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_03/Intro2TS_C03.html">3. Seasonality and Stationarity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/Intro2TS_C03S01.html">3.1. Understanding Seasonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/Intro2TS_C03S02.html">3.2. Seasonal-Trend Decomposition using LOESS (STL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/Intro2TS_C03S03.html">3.3. Additive vs. Multiplicative Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/Intro2TS_C03S04.html">3.4. Robust STL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/Intro2TS_C03S05.html">3.5. Stationarity and Non-Stationarity in Time-Series Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_04/Intro2TS_C04.html">4. Classical Time Series Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S01.html">4.1. Time Series Smoothing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S02.html">4.2. Foundations of Exponential Smoothing: Level &amp; Trend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S03.html">4.3. Advanced Exponential Smoothing: Seasonality &amp; Statistical Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S04.html">4.4. ARIMA Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S05.html">4.5. ARIMA Models in Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S06.html">4.6. SARIMA and SARIMAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/Intro2TS_C04S07.html">4.7. Automated ARIMA Models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_05/Intro2TS_C05.html">5. Outlier Detection in Time Series</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S01.html">5.1. Outlier Detection in Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S02.html">5.2. Outlier Classification by Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S03.html">5.3. Outlier Classification by Seasonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S04.html">5.4. Visual Methods for Outlier Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S05.html">5.5. Descriptive Statistics-Based Methods for Outlier Detection in Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_05/Intro2TS_C05S06.html">5.6. Time Series Modeling-Based Methods for Outlier Detection</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">6. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cross-Correlation in Time Series</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-background">1.6.1. Mathematical Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain-definition">1.6.1.1. Time Domain Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-domain-coherence">1.6.1.2. Frequency Domain (Coherence)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-columbia-vs-calgary-temperatures">1.6.2. Example: Columbia vs. Calgary Temperatures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-and-comparing-the-series">1.6.2.1. Visualizing and Comparing the Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timedomain-analysis-when-does-one-series-lead-the-other">1.6.2.2. Time‑Domain Analysis – When Does One Series Lead the Other?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequencydomain-analysis-at-what-timescales-are-the-cities-linked">1.6.2.3. Frequency‑Domain Analysis – At What Time‑Scales Are the Cities Linked?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-what-is-frequency">1.6.2.3.1. Concept: What is Frequency?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthesis-lag-and-coherence">1.6.2.4. Synthesis: Lag and Coherence</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="important admonition">
<p class="admonition-title">Remark</p>
<p>Please be aware that these lecture notes are accessible online in an ‘<strong>early access</strong>’ format. They are actively being developed, and certain sections will be further enriched to provide a comprehensive understanding of the subject matter.</p>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="cross-correlation-in-time-series">
<h1><span class="section-number">1.6. </span>Cross-Correlation in Time Series<a class="headerlink" href="#cross-correlation-in-time-series" title="Link to this heading">#</a></h1>
<p>In this section, we explore <strong>Cross-Correlation</strong>, a metric used to measure the similarity between two time series as a function of the time displacement (lag) between them. This is a fundamental tool in geophysical and environmental data science for identifying “lead-lag” relationships—determining if one signal (e.g., temperature in Calgary) has a predictive relationship with another (e.g., temperature in Columbia).</p>
<section id="mathematical-background">
<h2><span class="section-number">1.6.1. </span>Mathematical Background<a class="headerlink" href="#mathematical-background" title="Link to this heading">#</a></h2>
<p>Cross-correlation is a method used to measure the similarity between two sets of data, especially when one is shifted in time relative to the other. It helps us determine if a change in one signal precedes or follows a change in another, and quantifies the strength of that relationship. This is a fundamental tool in domains like geophysics, finance, and environmental data science for identifying predictive “lead-lag” relationships.</p>
<section id="time-domain-definition">
<h3><span class="section-number">1.6.1.1. </span>Time Domain Definition<a class="headerlink" href="#time-domain-definition" title="Link to this heading">#</a></h3>
<p>Mathematically, the raw cross-correlation <span class="math notranslate nohighlight">\(R_{xy}(\tau)\)</span> of two sequences <span class="math notranslate nohighlight">\(x_t\)</span> and <span class="math notranslate nohighlight">\(y_t\)</span> at lag <span class="math notranslate nohighlight">\(\tau\)</span> is given by the sliding dot product:</p>
<div class="amsmath math notranslate nohighlight" id="equation-342941f4-0c22-4842-b843-b9c1ca7ef353">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-342941f4-0c22-4842-b843-b9c1ca7ef353" title="Permalink to this equation">#</a></span>\[\begin{equation}

R_{xy}(\tau) = \sum_{t} x_t y_{t + \tau}

\end{equation}\]</div>
<p>However, to make the metric comparable across different datasets, we typically use the <strong>Normalized Cross-Correlation Function</strong>. According to <span id="id1">[<a class="reference internal" href="../References.html#id63" title="Peter J. Brockwell and Richard A. Davis. Introduction to time series and forecasting. Springer texts in statistics. Springer, Switzerland, 3rd ed edition, 2016. ISBN 978-3-319-29854-2.">Brockwell and Davis, 2016</a>]</span>, the sample cross-correlation <span class="math notranslate nohighlight">\(\hat{R}_{xy}(\tau)\)</span> is defined as:</p>
<div class="math notranslate nohighlight" id="equation-normalized-ccf-eq">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-normalized-ccf-eq" title="Link to this equation">#</a></span>\[\text{Normalized } R_{xy}(\tau) = \dfrac{1}{N} \sum_{t} \dfrac{(x_t - \mu_x)}{\sigma_x}\dfrac{(y_{t+\tau} - \mu_y)}{\sigma_y} \cdot \]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu_x, \mu_y\)</span>: Means of the series.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_x, \sigma_y\)</span>: Standard deviations of the series.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span>: The lag (shift) in time steps.</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span>: The number of observations.</p></li>
</ul>
<p><strong>Interpretation</strong>:
The resulting value ranges from <span class="math notranslate nohighlight">\(-1\)</span> to <span class="math notranslate nohighlight">\(+1\)</span>:</p>
<ul class="simple">
<li><p><strong>Peak at <span class="math notranslate nohighlight">\(\tau = 0\)</span></strong>: The series are synchronized.</p></li>
<li><p><strong>Peak at <span class="math notranslate nohighlight">\(\tau &lt; 0\)</span></strong>: <span class="math notranslate nohighlight">\(x_t\)</span> leads <span class="math notranslate nohighlight">\(y_t\)</span> (or <span class="math notranslate nohighlight">\(y_t\)</span> leads <span class="math notranslate nohighlight">\(x_t\)</span> depending on convention; see implementation below).</p></li>
<li><p><strong>Peak at <span class="math notranslate nohighlight">\(\tau &gt; 0\)</span></strong>: The opposite relationship holds.</p></li>
</ul>
</section>
<section id="frequency-domain-coherence">
<h3><span class="section-number">1.6.1.2. </span>Frequency Domain (Coherence)<a class="headerlink" href="#frequency-domain-coherence" title="Link to this heading">#</a></h3>
<p>While cross-correlation measures similarity in the time domain, <strong>Coherence</strong> measures the correlation between two signals as a function of frequency. It is analogous to a squared correlation coefficient for each frequency component.</p>
<p>The Magnitude Squared Coherence <span class="math notranslate nohighlight">\(C_{xy}(f)\)</span> is defined as:</p>
<div class="math notranslate nohighlight" id="equation-coherence-eq">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-coherence-eq" title="Link to this equation">#</a></span>\[C_{xy}(f) = \dfrac{|P_{xy}(f)|^2}{P_{xx}(f) P_{yy}(f)}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_{xy}(f)\)</span>: Cross-spectral density between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{xx}(f), P_{yy}(f)\)</span>: Power spectral densities of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> respectively.</p></li>
</ul>
<p>Values of <span class="math notranslate nohighlight">\(C_{xy}(f)\)</span> near 1 indicate a strong linear relationship at that frequency, while values near 0 indicate no relationship.</p>
<p>This efficiency is why standard libraries (such as <a class="reference external" href="https://docs.scipy.org/doc//scipy-1.16.2/reference/generated/scipy.signal.correlate.html"><code class="docutils literal notranslate"><span class="pre">scipy.signal.correlate</span></code></a>) often use FFT-based methods (<code class="docutils literal notranslate"><span class="pre">method='fft'</span></code>) for larger arrays.</p>
</section>
</section>
<section id="example-columbia-vs-calgary-temperatures">
<h2><span class="section-number">1.6.2. </span>Example: Columbia vs. Calgary Temperatures<a class="headerlink" href="#example-columbia-vs-calgary-temperatures" title="Link to this heading">#</a></h2>
<p>To illustrate cross-correlation and coherence, we analyze daily mean temperatures from <strong>Columbia, Missouri</strong> (target, at 92°W) and <strong>Calgary, Alberta</strong> (source, at 114°W) during 2024. These cities are separated by over 2,000 km with distinct climates: Calgary is colder year-round due to higher latitude and continental exposure, while Columbia experiences milder winters and more humid summers. The data spans is sourced from <a class="reference external" href="https://open-meteo.com/">https://open-meteo.com/</a> with daily temperatures means measured in degrees Celsius.</p>
<p>The key scientific question is: <strong>Do weather systems that affect Calgary (west) influence Columbia (east) with a detectable time delay?</strong> North American weather systems typically propagate eastward, so we hypothesize that Calgary’s temperature anomalies (unusually warm or cold days) may “lead” Columbia’s by a few days. Cross-correlation will quantify this lead-lag timing, and coherence will tell us <em>whether this relationship is strongest at the seasonal scale, the synoptic (3–7 day) scale, or both</em>.</p>
<p>We will apply this theory to analyze the relationship between daily temperatures in Columbia, MO, and Calgary, AB for the year 2024. Given the prevailing West-to-East weather patterns in North America, we hypothesize that temperature changes in Calgary (West) might “lead” similar changes in Columbia (East).</p>
<section id="visualizing-and-comparing-the-series">
<h3><span class="section-number">1.6.2.1. </span>Visualizing and Comparing the Series<a class="headerlink" href="#visualizing-and-comparing-the-series" title="Link to this heading">#</a></h3>
<p>We will analyze the daily mean temperatures of <strong>Calgary, AB</strong> and <strong>Columbia, MO</strong> for the year 2024. Note that Calgary (approx. 114°W) is significantly west of Columbia (approx. 92°W). Since weather systems in North America often move West-to-East, we might hypothesize a lag relationship.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># 1. Load the datasets</span>
<span class="n">como_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;chapter1_data/daily_temp_como.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">calgary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;chapter1_data/daily_temp_calgary.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>

<span class="c1"># 2. Filter for a complete overlapping period (Year 2024)</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2024-01-01&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;2024-12-31&#39;</span>

<span class="n">ts_target</span> <span class="o">=</span> <span class="n">como_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_date</span><span class="p">:</span><span class="n">end_date</span><span class="p">,</span> <span class="s1">&#39;temperature_2m_mean (°C)&#39;</span><span class="p">]</span>
<span class="n">ts_source</span> <span class="o">=</span> <span class="n">calgary_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start_date</span><span class="p">:</span><span class="n">end_date</span><span class="p">,</span> <span class="s1">&#39;temperature_2m_mean (°C)&#39;</span><span class="p">]</span>

<span class="c1"># 3. Align data (Inner Join)</span>
<span class="c1"># This ensures we only compare days where both cities have data</span>
<span class="n">df_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ts_target</span><span class="p">,</span> <span class="n">ts_source</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Columbia&#39;</span><span class="p">,</span> <span class="s1">&#39;Calgary&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Before diving into mathematical metrics, it is essential to visually inspect the time series. Here, we compare the daily mean temperatures of <strong>Calgary, Canada</strong>, and <strong>Columbia, Missouri</strong>.</p>
<p>Although these two cities are geographically distinct—separated by over 2,000 km and different climate zones—they are both located in the Northern Hemisphere. Therefore, we expect them to share a strong <strong>seasonal component</strong> (the annual temperature cycle).</p>
<figure class="align-center" id="como-calgary-daily-mean-temp">
<a class="reference internal image-reference" href="../_images/como_calgary_daily_mean_temp.png"><img alt="../_images/como_calgary_daily_mean_temp.png" src="../_images/como_calgary_daily_mean_temp.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.11 </span><span class="caption-text">Daily mean temperature in Columbia, MO (solid, purple) and Calgary, AB (dashed, red) for 2024. The series share a clear annual seasonal cycle (warming in summer, cooling in winter), but differ in amplitude and baseline. Notably, many warm and cold spells appear to occur nearly simultaneously, though slight timing offsets may exist within short intervals. This visual similarity motivates the search for an optimal time lag.</span><a class="headerlink" href="#como-calgary-daily-mean-temp" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Visual observations:</strong></p>
<ul class="simple">
<li><p>Both series follow a <strong>sinusoidal annual rhythm</strong>: winter minima (January, December) and summer maxima (July, August) occur at nearly the same calendar dates.</p></li>
<li><p><strong>Amplitude asymmetry</strong>: Calgary’s curve swings from roughly −30°C to +20°C, while Columbia ranges from −20°C to +30°C. This reflects Calgary’s continental climate (larger extremes) versus Columbia’s more temperate profile.</p></li>
<li><p><strong>Apparent synchrony</strong>: Many rapid warm-ups and cold snaps seem to happen together (e.g., both cities warm in April, cool in September), suggesting shared synoptic weather drivers.</p></li>
</ul>
<p>This visual alignment is reassuring—it tells us the two locations are not independent—but it doesn’t yet answer: <em>Is there a small time delay? And which timescale (seasonal vs. weekly) matters most?</em></p>
</section>
<section id="timedomain-analysis-when-does-one-series-lead-the-other">
<h3><span class="section-number">1.6.2.2. </span>Time‑Domain Analysis – When Does One Series Lead the Other?<a class="headerlink" href="#timedomain-analysis-when-does-one-series-lead-the-other" title="Link to this heading">#</a></h3>
<p>To answer <strong>“When?”</strong>, we compute the normalized cross-correlation function (CCF) across a range of lags. Recall the normalized CCF (from <a class="reference internal" href="#equation-normalized-ccf-eq">(1.3)</a>)</p>
<p><strong>Interpretation logic:</strong></p>
<ul class="simple">
<li><p>If the CCF peaks at <span class="math notranslate nohighlight">\(\tau = +2\)</span>, this means: <em>shift Calgary forward by 2 days, and the two series match best</em>. In meteorological terms, Calgary’s temperature anomalies arrive 2 days before Columbia’s. Put plainly: a cold spell in Calgary on January 10 tends to reach Columbia around January 12.</p></li>
<li><p>If the peak were at <span class="math notranslate nohighlight">\(\tau = -2\)</span>, it would mean Columbia leads Calgary—physically implausible for eastward-moving systems.</p></li>
<li><p>A peak near <span class="math notranslate nohighlight">\(\tau = 0\)</span> would mean the cities respond simultaneously to the same large-scale weather driver (e.g., the seasonal cycle), without a propagation delay.</p></li>
</ul>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_cross_correlation</span><span class="p">(</span><span class="n">target_series</span><span class="p">,</span> <span class="n">source_series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the cross-correlation between a target and a source series.</span>
<span class="sd">    Returns:</span>
<span class="sd">        lags (np.array): Array of lag indices.</span>
<span class="sd">        corr (np.array): Normalized cross-correlation values.</span>
<span class="sd">        lag_days (int): The lag in days where correlation is maximized.</span>
<span class="sd">        max_corr (float): The maximum correlation value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Normalize the signals (Z-score normalization)</span>
    <span class="c1"># This ensures the output is a correlation coefficient (-1 to 1)</span>
    <span class="n">target_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_series</span> <span class="o">-</span> <span class="n">target_series</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">target_series</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">source_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">source_series</span> <span class="o">-</span> <span class="n">source_series</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">source_series</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="c1"># 2. Compute Cross-Correlation using FFT</span>
    <span class="c1"># &#39;full&#39; mode returns valid cross-correlation for all possible overlaps</span>
    <span class="n">correlation</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">target_norm</span><span class="p">,</span> <span class="n">source_norm</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fft&#39;</span><span class="p">)</span>
    
    <span class="c1"># 3. Normalization by length to get Pearson Coefficient</span>
    <span class="c1"># Note: This is an approximation assuming large N. </span>
    <span class="n">correlation</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_series</span><span class="p">)</span>
    
    <span class="c1"># 4. Get the lags associated with the correlation array</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">correlation_lags</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_series</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_series</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
    
    <span class="c1"># 5. Find the optimal lag (max correlation)</span>
    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
    <span class="n">best_lag</span> <span class="o">=</span> <span class="n">lags</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
    <span class="n">max_corr</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">lags</span><span class="p">,</span> <span class="n">correlation</span><span class="p">,</span> <span class="n">best_lag</span><span class="p">,</span> <span class="n">max_corr</span>

<span class="c1"># Run the analysis</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">ccf_values</span><span class="p">,</span> <span class="n">best_lag</span><span class="p">,</span> <span class="n">max_corr</span> <span class="o">=</span> <span class="n">analyze_cross_correlation</span><span class="p">(</span>
    <span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Columbia&#39;</span><span class="p">],</span> 
    <span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Calgary&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal Lag: </span><span class="si">{</span><span class="n">best_lag</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Correlation: </span><span class="si">{</span><span class="n">max_corr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify Improvement</span>
<span class="n">original_corr</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Columbia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Calgary&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Correlation (Lag 0): </span><span class="si">{</span><span class="n">original_corr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, we move from what the series look like to when one location tends to follow the other by examining the cross‑correlation and a lagged overlay of the two series. We visualize the results to confirm the relationship. A negative lag implies the “Source” (Calgary) leads the “Target” (Columbia).</p>
<figure class="align-center" id="como-calgary-cross-corr-aligned">
<a class="reference internal image-reference" href="../_images/como_calgary_cross_corr_aligned.png"><img alt="../_images/como_calgary_cross_corr_aligned.png" src="../_images/como_calgary_cross_corr_aligned.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.12 </span><span class="caption-text"><strong>(a)</strong> Normalized cross-correlation between Calgary and Columbia daily temperatures for lags from −50 to +50 days. The peak occurs at <span class="math notranslate nohighlight">\(\tau = +2\)</span> days with a correlation of 0.83, substantially higher than the lag-0 correlation of 0.78. The dashed red line marks the optimal lag; the vertical black line shows lag zero for reference. <strong>(b)</strong> Time series overlay after shifting Calgary by +2 days. The two curves now track closely, confirming visual alignment. Deviations reflect either local weather noise or synoptic features that do not propagate uniformly across the distance.</span><a class="headerlink" href="#como-calgary-cross-corr-aligned" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Interpretation:</strong></p>
<p>The <strong>2-day lead</strong> makes meteorological sense. Weather systems (cold fronts, high-pressure ridges) that originate in the Pacific or Rocky Mountain region reach Calgary first, then propagate eastward at a typical speed of ~1,000 km per 2 days, arriving at Columbia 2–3 days later. This is consistent with observed wind speeds in the troposphere (~30–40 m/s at jet stream altitudes) and surface pressure perturbation propagation.</p>
<p>The <strong>correlation magnitude (0.83)</strong> is high but not perfect (1.0). Why? Because:</p>
<ol class="arabic simple">
<li><p>Local effects (urban heat island, local orography) introduce noise at each location.</p></li>
<li><p>Some weather systems weaken or split during eastward travel.</p></li>
<li><p>The 2-day lag is an average; some events lead by 1 day, others by 3, creating scatter.</p></li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Note</p>
<p>Lag answers the question: “How many days early does Location A predict Location B’s anomalies?” A positive lag means the source (Calgary) is predictive of the future target (Columbia); we are not claiming causality, only that they share a time-shifted correlation structure consistent with eastward weather propagation.</p>
</div>
</section>
<section id="frequencydomain-analysis-at-what-timescales-are-the-cities-linked">
<h3><span class="section-number">1.6.2.3. </span>Frequency‑Domain Analysis – At What Time‑Scales Are the Cities Linked?<a class="headerlink" href="#frequencydomain-analysis-at-what-timescales-are-the-cities-linked" title="Link to this heading">#</a></h3>
<p>We have established that Calgary generally “leads” Columbia by 2 days. Now we ask a deeper question: <strong>“Does this link exist for all weather patterns, or only specific ones?”</strong></p>
<p>To answer this, we must move from the <strong>Time Domain</strong> (looking at days) to the <strong>Frequency Domain</strong> (looking at cycles).</p>
<section id="concept-what-is-frequency">
<h4><span class="section-number">1.6.2.3.1. </span>Concept: What is Frequency?<a class="headerlink" href="#concept-what-is-frequency" title="Link to this heading">#</a></h4>
<p>Students often find “frequency” abstract, but it is simply the inverse of a cycle’s duration.</p>
<ul class="simple">
<li><p><strong>Period ():</strong> The time it takes for a cycle to repeat (e.g., “7 days”).</p></li>
<li><p><strong>Frequency ():</strong> How many cycles occur in one unit of time (e.g., “0.14 cycles per day”).</p></li>
</ul>
<p>The relationship is:</p>
<p>Before analyzing the data, we identify the physical “reference” frequencies we expect to see in weather data:</p>
<ol class="arabic simple">
<li><p><strong>The Annual Cycle ( days):</strong> Driven by Earth’s orbit.</p></li>
<li><p><strong>The Synoptic “Weather” Cycle ( days):</strong> Large-scale weather systems (fronts, high/low pressure) typically pass a location every 3 to 7 days.</p></li>
</ol>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="c1"># Compute Coherence using Welch&#39;s method</span>
<span class="c1"># Convert pandas Series to numpy arrays</span>
<span class="n">f</span><span class="p">,</span> <span class="n">Cxy</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Columbia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> 
                          <span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;Calgary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> 
                          <span class="n">fs</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># Here</span>
<span class="c1"># f: Frequency (cycles/day)</span>
<span class="c1"># Cxy: Coherence (0 to 1)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="como-calgary-freq-cross-corr">
<a class="reference internal image-reference" href="../_images/como_calgary_freq_cross_corr.png"><img alt="../_images/como_calgary_freq_cross_corr.png" src="../_images/como_calgary_freq_cross_corr.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.13 </span><span class="caption-text">Magnitude-squared coherence between Calgary and Columbia daily temperatures versus frequency (in cycles per day). Two vertical dashed lines mark reference timescales: the annual cycle at 1/365 ≈ 0.0027 cycles/day (red), and the weekly cycle at 1/7 ≈ 0.143 cycles/day (green). Coherence peaks sharply near the annual frequency (as expected), but importantly <em>remains high</em> in the 3–7 day band (around 0.15 cycles/day), indicating that synoptic weather patterns drive a substantial portion of the shared variability beyond simple seasonality.</span><a class="headerlink" href="#como-calgary-freq-cross-corr" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Interpretation</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Low frequencies (left side, near 0):</strong>
Coherence ≈ 1.0. This is expected and almost trivial: both locations experience winter in January and summer in July. The annual cycle dominates the temperature variance and is perfectly coherent between them.</p></li>
<li><p><strong>Intermediate frequencies (the “synoptic band,” 1/7 to 1/3 cycles/day, or 3–7 day timescales):</strong>
Coherence remains elevated (0.4–0.6 or higher). This is the <strong>key physical insight</strong>. Cold fronts, high-pressure ridges, and other synoptic disturbances that affect Calgary on, say, Monday tend to affect Columbia by Wednesday or Thursday. Because these systems propagate together across both locations, the cities show coherence at the 3–7 day timescale.</p></li>
<li><p><strong>High frequencies (right side, &gt;0.2 cycles/day, or sub-3-day scales):</strong>
Coherence drops. This makes sense: brief local events (afternoon thunderstorms, local wind shifts) occur at different times in different places and are not propagating organized systems.</p></li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Note</p>
<p>At what frequencies do the two signals behave like a single, coordinated system?” High annual coherence is expected (shared seasons). High synoptic coherence reveals that the cities are coupled by large-scale weather systems that propagate between them. Low high-frequency coherence reflects local independence. Together, these tell us the dominant physical mechanisms linking the two sites.</p>
</div>
</section>
</section>
<section id="synthesis-lag-and-coherence">
<h3><span class="section-number">1.6.2.4. </span>Synthesis: Lag and Coherence<a class="headerlink" href="#synthesis-lag-and-coherence" title="Link to this heading">#</a></h3>
<p>The cross‑correlation and coherence results answer complementary questions in a compact way:</p>
<div class="full-width docutils">
<div class="pst-scrollable-table-container"><table class="table" id="cross-correlation-lag-and-coherence-analyses-summary">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Aspect</p></th>
<th class="head text-left"><p>Question</p></th>
<th class="head text-left"><p>Answer from Data</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><strong>Timing (Time Domain)</strong></p></td>
<td class="text-left"><p>How many days does Calgary lead Columbia?</p></td>
<td class="text-left"><p>≈2 days (CCF peak at <span class="math notranslate nohighlight">\(\tau = +2\)</span>)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>Correlation strength (Time Domain)</strong></p></td>
<td class="text-left"><p>How strong is the link at that lag?</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r \approx 0.83\)</span> (higher than lag 0)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>Seasonal linkage (Frequency Domain)</strong></p></td>
<td class="text-left"><p>Are annual cycles shared?</p></td>
<td class="text-left"><p>Yes, coherence ≈ 1 at 1/365 cycles/day</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>Synoptic linkage (Frequency Domain)</strong></p></td>
<td class="text-left"><p>Are 3–7 day systems shared?</p></td>
<td class="text-left"><p>Yes, coherence stays elevated near 1/7 cycles/day</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>Local variability (Frequency Domain)</strong></p></td>
<td class="text-left"><p>Are sub‑3‑day fluctuations shared?</p></td>
<td class="text-left"><p>Mostly no, coherence drops at high frequencies</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ol class="arabic simple">
<li><p><strong>Why do we need both analyses?</strong><br />
Cross-correlation reveals <em>when</em> one location predicts another (the 2-day lead); coherence reveals <em>which timescales</em> matter (synoptic systems dominate, not just annual seasonality). Together, they expose the mechanisms linking the two cities: large-scale weather systems propagating eastward at ~1,000 km/2 days, while local boundary-layer processes remain independent.</p></li>
<li><p><strong>Note on Practical Use</strong>:
In operations, knowing that Calgary temperature anomalies lead Columbia by ~2 days allows meteorologists to use Calgary observations to improve short-range forecasts for Columbia. However, the imperfect correlation (0.83, not 1.0) reflects real variability in propagation speed and system intensity—a useful reminder that statistical relationships never replace physical reasoning.</p></li>
</ol>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Intro2TS_C01S05.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>What Are ACF and PACF?</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter_02/Intro2TS_C02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Missing Data in Time Series</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-background">1.6.1. Mathematical Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain-definition">1.6.1.1. Time Domain Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-domain-coherence">1.6.1.2. Frequency Domain (Coherence)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-columbia-vs-calgary-temperatures">1.6.2. Example: Columbia vs. Calgary Temperatures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-and-comparing-the-series">1.6.2.1. Visualizing and Comparing the Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timedomain-analysis-when-does-one-series-lead-the-other">1.6.2.2. Time‑Domain Analysis – When Does One Series Lead the Other?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequencydomain-analysis-at-what-timescales-are-the-cities-linked">1.6.2.3. Frequency‑Domain Analysis – At What Time‑Scales Are the Cities Linked?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-what-is-frequency">1.6.2.3.1. Concept: What is Frequency?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthesis-lag-and-coherence">1.6.2.4. Synthesis: Lag and Coherence</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>