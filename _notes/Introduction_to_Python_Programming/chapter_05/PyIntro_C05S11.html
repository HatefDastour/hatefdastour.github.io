
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.11. Aggregation and Grouping in Pandas &#8212; Introduction to Python Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=564be945" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_05/PyIntro_C05S11';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.12. Pandas pivot and melt" href="PyIntro_C05S12.html" />
    <link rel="prev" title="5.10. Pandas join and concat" href="PyIntro_C05S10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../Preface.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Python Programming - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Python Programming - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_01/PyIntro_C01.html">1. Fundamental Concepts of Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S01.html">1.1. Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S02.html">1.2. Data Types: A brief overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S03.html">1.3. Operations in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S04.html">1.4. Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S05.html">1.5. Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S06.html">1.6. Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S07.html">1.7. Iteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S08.html">1.8. Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S09.html">1.9. Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S10.html">1.10. Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S11.html">1.11. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S12.html">1.12. Recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/PyIntro_C01S13.html">1.13. Special Variables</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_02/PyIntro_C02.html">2. Data Structures and File Handling in Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S01.html">2.1. Strings in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S02.html">2.2. String Formatting Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S03.html">2.3. Python Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S04.html">2.4. Dictionaries in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S05.html">2.5. Python Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S06.html">2.6. Python Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/PyIntro_C02S07.html">2.7. Files in Python</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_03/PyIntro_C03.html">3. Classes and Objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S01.html">3.1. Introduction to Classes and Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S02.html">3.2. Inheritance and Polymorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S03.html">3.3. Encapsulation and Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S04.html">3.4. Copying Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S05.html">3.5. Magic Methods (Dunder Methods) in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/PyIntro_C03S06.html">3.6. Examples of Classes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_04/PyIntro_C04.html">4. Introduction to NumPy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/PyIntro_C04S01.html">4.1. Basics of Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/PyIntro_C04S02.html">4.2. NumPy Function Reference and Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_04/PyIntro_C04S03.html">4.3. Advanced Numpy Concepts</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="PyIntro_C05.html">5. Working with Data using Pandas</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S01.html">5.1. An Introduction to Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S02.html">5.2. DataFrame and Series Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S03.html">5.3. Pandas Data Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S04.html">5.4. Modifying a DataFrame in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S05.html">5.5. Handling Missing Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S06.html">5.6. Filling Missing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S07.html">5.7. Techniques for Filling Missing Data in Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S08.html">5.8. Strategies for Handling Missing Categorical Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S09.html">5.9. Pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S10.html">5.10. Pandas <code class="docutils literal notranslate"><span class="pre">join</span></code> and <code class="docutils literal notranslate"><span class="pre">concat</span></code></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.11. Aggregation and Grouping in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyIntro_C05S12.html">5.12. Pandas pivot and melt</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_06/PyIntro_C06.html">6. Data Visualization using Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S01.html">6.1. Getting Started with Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S02.html">6.2. Matplotlib Styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S03.html">6.3. Matplotlib interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S04.html">6.4. Marker, Linestyles and Colors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S05.html">6.5. Colormaps in Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S06.html">6.6. Seaborn plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/PyIntro_C06S07.html">6.7. Python Plotting Guide</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">7. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Aggregation and Grouping in Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data-with-groupby">5.11.1. Grouping Data with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-syntax">5.11.1.1. Basic Syntax</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-extracting-insights-from-groups">5.11.2. Aggregation: Extracting Insights from Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-aggregations">5.11.3. Multiple aggregations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-aggregation-optional-content">5.11.4. Custom aggregation (Optional Content)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-columns">5.11.5. Grouping by multiple columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-different-aggregations-to-different-columns">5.11.6. Applying different aggregations to different columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#named-aggregation">5.11.7. Named Aggregation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-resampling-time-series-data">5.11.8. Grouping and Resampling Time Series Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resample-function-for-time-series-analysis">5.11.8.1. <code class="docutils literal notranslate"><span class="pre">resample</span></code> Function for Time Series Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-iteration">5.11.9. Group Iteration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-groups">5.11.10. Filtering Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation">5.11.11. Transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-gaps-using-groupby">5.11.12. Filling Gaps Using <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-fill-and-backward-fill">5.11.12.1. Forward Fill and Backward Fill</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fill-with-aggregated-values">5.11.12.2. Fill with Aggregated Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-missing-values">5.11.12.3. Interpolate Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-fill-methods">5.11.12.4. Custom Fill Methods</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="aggregation-and-grouping-in-pandas">
<h1><span class="section-number">5.11. </span>Aggregation and Grouping in Pandas<a class="headerlink" href="#aggregation-and-grouping-in-pandas" title="Link to this heading">#</a></h1>
<p>In data analysis and manipulation, the concepts of aggregation and grouping play a crucial role, allowing us to derive insights from complex datasets. This section will delve deeper into the fundamental concepts of aggregation and grouping in the context of pandas, a powerful Python library for data manipulation and analysis.</p>
<section id="grouping-data-with-groupby">
<h2><span class="section-number">5.11.1. </span>Grouping Data with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code><a class="headerlink" href="#grouping-data-with-groupby" title="Link to this heading">#</a></h2>
<p>Grouping data involves categorizing and splitting a dataset into smaller subsets based on specific criteria. The <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> function in pandas is a fundamental tool for accomplishing this task. It allows us to group a DataFrame based on one or more columns, enabling subsequent analysis and computation within these groups <span id="id1">[<a class="reference internal" href="../References.html#id138" title="W. McKinney. Python for Data Analysis. O'Reilly Media, 2022. ISBN 9781098104009. URL: https://books.google.ca/books?id=EgKBEAAAQBAJ.">McKinney, 2022</a>, <a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<section id="basic-syntax">
<h3><span class="section-number">5.11.1.1. </span>Basic Syntax<a class="headerlink" href="#basic-syntax" title="Link to this heading">#</a></h3>
<p>The basic syntax for using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> function is as follows <span id="id2">[<a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Full syntax can be found <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">here</a>.</p>
<p><font color='Blue'><b>Example</b></font> This dataset records meteorological observations for the “UNIVERSITY OF CALGARY” weather station. It was obtained from the source <a class="reference external" href="https://climate.weather.gc.ca/">https://climate.weather.gc.ca/</a> and includes the following columns:</p>
<ol class="arabic simple">
<li><p><strong>Station Name:</strong> The name of the weather station, which is “UNIVERSITY OF CALGARY” in this case.</p></li>
<li><p><strong>Date/Time:</strong> The date and time of the observation in the format MM/DD/YYYY.</p></li>
<li><p><strong>Year:</strong> The year of the observation, extracted from the Date/Time column.</p></li>
<li><p><strong>Month:</strong> The month of the observation, extracted from the Date/Time column.</p></li>
<li><p><strong>Day:</strong> The day of the observation, extracted from the Date/Time column.</p></li>
<li><p><strong>Max Temp (°C):</strong> The maximum temperature recorded on that date in degrees Celsius.</p></li>
<li><p><strong>Min Temp (°C):</strong> The minimum temperature recorded on that date in degrees Celsius.</p></li>
<li><p><strong>Mean Temp (°C):</strong> The mean temperature recorded on that date in degrees Celsius, typically calculated as the average of the maximum and minimum temperatures.</p></li>
<li><p><strong>Total Rain (mm):</strong> The total amount of rainfall in millimeters on that date.</p></li>
<li><p><strong>Total Snow (cm):</strong> The total amount of snowfall in centimeters on that date.</p></li>
<li><p><strong>Total Precip (mm):</strong> The cumulative total of precipitation, which combines rain and snow, in millimeters on that date.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/HatefDastour/ENGG_680/main/Datasets/UofC_Daily_1990_Q1Q2.csv&#39;</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Station Name</th>
      <th>Date/Time</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Max Temp (°C)</th>
      <th>Min Temp (°C)</th>
      <th>Mean Temp (°C)</th>
      <th>Total Rain (mm)</th>
      <th>Total Snow (cm)</th>
      <th>Total Precip (mm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>176</th>
      <td>UNIVERSITY OF CALGARY</td>
      <td>6/26/1990</td>
      <td>1990</td>
      <td>6</td>
      <td>26</td>
      <td>26.0</td>
      <td>11.5</td>
      <td>18.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>177</th>
      <td>UNIVERSITY OF CALGARY</td>
      <td>6/27/1990</td>
      <td>1990</td>
      <td>6</td>
      <td>27</td>
      <td>22.0</td>
      <td>10.0</td>
      <td>16.0</td>
      <td>6.8</td>
      <td>0.0</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>178</th>
      <td>UNIVERSITY OF CALGARY</td>
      <td>6/28/1990</td>
      <td>1990</td>
      <td>6</td>
      <td>28</td>
      <td>21.0</td>
      <td>8.0</td>
      <td>14.5</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>179</th>
      <td>UNIVERSITY OF CALGARY</td>
      <td>6/29/1990</td>
      <td>1990</td>
      <td>6</td>
      <td>29</td>
      <td>22.0</td>
      <td>7.0</td>
      <td>14.5</td>
      <td>3.3</td>
      <td>0.0</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>180</th>
      <td>UNIVERSITY OF CALGARY</td>
      <td>6/30/1990</td>
      <td>1990</td>
      <td>6</td>
      <td>30</td>
      <td>24.5</td>
      <td>12.0</td>
      <td>18.3</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>grouped would be an object as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grouping by &#39;Month&#39;</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000233D73ED8E0&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="aggregation-extracting-insights-from-groups">
<h2><span class="section-number">5.11.2. </span>Aggregation: Extracting Insights from Groups<a class="headerlink" href="#aggregation-extracting-insights-from-groups" title="Link to this heading">#</a></h2>
<p>Once you’ve successfully grouped your data using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> function, the next step is to harness the power of aggregation. Aggregation involves summarizing and extracting meaningful information from the grouped data by applying various functions to each group. This process unveils hidden patterns, trends, and characteristics within your dataset.</p>
<p>Pandas offers a multitude of aggregation functions that allow you to compute summary statistics and insights for each group. These functions include <span id="id3">[<a class="reference internal" href="../References.html#id138" title="W. McKinney. Python for Data Analysis. O'Reilly Media, 2022. ISBN 9781098104009. URL: https://books.google.ca/books?id=EgKBEAAAQBAJ.">McKinney, 2022</a>, <a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<ul class="simple">
<li><p><strong>Mean</strong>: Calculates the average value of a specific column within each group.</p></li>
<li><p><strong>Sum</strong>: Computes the total sum of values in a column for each group.</p></li>
<li><p><strong>Count</strong>: Determines the number of non-null values within a column for each group.</p></li>
<li><p><strong>Max</strong>: Identifies the maximum value within a column for each group.</p></li>
<li><p><strong>Min</strong>: Finds the minimum value within a column for each group.</p></li>
<li><p>…and many more.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Line</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="c1"># Applying aggregation functions on the groups</span>

<span class="c1"># Calculating the mean of &#39;Value&#39; for each group</span>
<span class="n">average_values</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Max Temp (°C)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">average_values</span><span class="p">)</span>
<span class="n">Line</span><span class="p">()</span>

<span class="c1"># Calculating the sum of &#39;Value&#39; for each group</span>
<span class="n">sum_values</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Total Precip (mm)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sum_values</span><span class="p">)</span>
<span class="n">Line</span><span class="p">()</span>

<span class="c1"># Counting the number of occurrences in each group</span>
<span class="n">count_values</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Max Temp (°C)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Count Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_values</span><span class="p">)</span>
<span class="n">Line</span><span class="p">()</span>

<span class="c1"># Finding the maximum value in each group</span>
<span class="n">max_value</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Max Temp (°C)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span>
<span class="n">Line</span><span class="p">()</span>

<span class="c1"># Finding the minimum value in each group</span>
<span class="n">min_value</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Max Temp (°C)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span>
<span class="n">Line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average Values:
Month
1     0.73
2     0.70
3     7.71
4    10.50
5    14.58
6    19.13
Name: Max Temp (°C), dtype: float64
________________________________________
Sum Values:
Month
1      8.9
2     10.0
3     12.0
4     32.5
5    102.9
6     64.3
Name: Total Precip (mm), dtype: float64
________________________________________
Count Values:
Month
1    31
2    28
3    31
4    30
5    31
6    30
Name: Max Temp (°C), dtype: int64
________________________________________
Max Values:
Month
1    10.0
2    16.0
3    18.0
4    20.0
5    25.0
6    26.5
Name: Max Temp (°C), dtype: float64
________________________________________
Min Values:
Month
1   -26.0
2   -24.5
3    -9.0
4    -3.5
5     7.0
6     8.0
Name: Max Temp (°C), dtype: float64
________________________________________
</pre></div>
</div>
</div>
</div>
<p>The code then calculates various aggregation functions (<code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">count()</span></code>, <code class="docutils literal notranslate"><span class="pre">max()</span></code>, <code class="docutils literal notranslate"><span class="pre">min()</span></code>) on the grouped data and prints out the results for each function. The <code class="docutils literal notranslate"><span class="pre">Line()</span></code> function is used to separate the output of each aggregation function for better readability.</p>
<p><a class="reference internal" href="#tablec0506-01"><span class="std std-numref">Table 5.7</span></a> provides a detailed overview of the various aggregation functions available in pandas’ <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> operation, as documented in the Pandas Documentation. These functions offer extensive options for summarizing and analyzing data within each group formed by the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method <span id="id4">[<a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="tablec0506-01">
<caption><span class="caption-number">Table 5.7 </span><span class="caption-text">Comprehensive List of Aggregation Functions in Pandas</span><a class="headerlink" href="#tablec0506-01" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Aggregation Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg(func)</span></code></p></td>
<td><p>Applies a custom aggregation function to each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">apply(func)</span></code></p></td>
<td><p>Applies a function to each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></td>
<td><p>Counts the non-null values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cummax()</span></code></p></td>
<td><p>Computes the cumulative maximum of values in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cummin()</span></code></p></td>
<td><p>Computes the cumulative minimum of values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cumprod()</span></code></p></td>
<td><p>Computes the cumulative product of values in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cumsum()</span></code></p></td>
<td><p>Computes the cumulative sum of values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">describe()</span></code></p></td>
<td><p>Generates summary statistics for each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">first()</span></code></p></td>
<td><p>Returns the first element in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">last()</span></code></p></td>
<td><p>Returns the last element in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max()</span></code></p></td>
<td><p>Finds the maximum value in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code></p></td>
<td><p>Computes the mean (average) of values in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">median()</span></code></p></td>
<td><p>Calculates the median of values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min()</span></code></p></td>
<td><p>Finds the minimum value in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nth(n)</span></code></p></td>
<td><p>Returns the nth element in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">prod()</span></code></p></td>
<td><p>Calculates the product of values in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quantile(q)</span></code></p></td>
<td><p>Computes the qth quantile of values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">size()</span></code></p></td>
<td><p>Determines the number of elements in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">std()</span></code></p></td>
<td><p>Computes the standard deviation of values in each group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code></p></td>
<td><p>Calculates the sum of values in each group.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">transform(func)</span></code></p></td>
<td><p>Applies a function to each group and broadcasts the result.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">var()</span></code></p></td>
<td><p>Calculates the variance of values in each group.</p></td>
</tr>
</tbody>
</table>
</div>
<p>These aggregation functions provide a wide range of options for summarizing and analyzing data within each group formed by the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> operation in pandas.</p>
</section>
<section id="multiple-aggregations">
<h2><span class="section-number">5.11.3. </span>Multiple aggregations<a class="headerlink" href="#multiple-aggregations" title="Link to this heading">#</a></h2>
<p>You can apply multiple aggregation functions simultaneously using the <code class="docutils literal notranslate"><span class="pre">agg()</span></code> method.</p>
<p><font color='Blue'><b>Example - Exploring Store Sales Patterns:</b></font> Imagine you’re analyzing sales data for a small boutique store. The store sells products from two categories, ‘A’ and ‘B’. You want to understand how the sales values for these categories differ.</p>
<p>You start by generating a random dataset using numpy and pandas to simulate the store’s sales records. You set a random seed for reproducibility and create 100 rows of data. Each row has a ‘Category’ column with either ‘A’ or ‘B’ values and a ‘Value’ column with random sales amounts between 1 and 100.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Set the random seed for reproducibility</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define the number of rows in the DataFrame</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Generate random alphabet column with only &#39;A&#39; and &#39;B&#39;</span>
<span class="n">random_alphabet</span> <span class="o">=</span> <span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_rows</span><span class="p">)]</span>

<span class="c1"># Generate random numeric column</span>
<span class="n">random_numeric</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">)</span>

<span class="c1"># Create a Pandas DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="n">random_alphabet</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">random_numeric</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>81</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grouping by &#39;Category&#39;</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)</span>

<span class="c1">#  Applying multiple aggregation functions</span>
<span class="n">agg_functions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">]}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_functions</span><span class="p">)</span>
<span class="c1"># or simply result = grouped.agg({&#39;Value&#39;: [&#39;mean&#39;, &#39;sum&#39;, &#39;count&#39;, &#39;max&#39;, &#39;min&#39;]})</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Value</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sum</th>
      <th>count</th>
      <th>max</th>
      <th>min</th>
    </tr>
    <tr>
      <th>Category</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>46.458333</td>
      <td>2230</td>
      <td>48</td>
      <td>100</td>
      <td>1</td>
    </tr>
    <tr>
      <th>B</th>
      <td>52.519231</td>
      <td>2731</td>
      <td>52</td>
      <td>100</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This code snippet applies multiple aggregation functions to a grouped dataset. It calculates statistics like mean, sum, count, maximum, and minimum values for the ‘Value’ column within each group.</p>
</section>
<section id="custom-aggregation-optional-content">
<h2><span class="section-number">5.11.4. </span>Custom aggregation (Optional Content)<a class="headerlink" href="#custom-aggregation-optional-content" title="Link to this heading">#</a></h2>
<p>You can also define custom aggregation functions using lambda functions or regular functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom aggregation function</span>
<span class="n">custom_agg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">custom_agg</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
    </tr>
    <tr>
      <th>Category</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>99</td>
    </tr>
    <tr>
      <th>B</th>
      <td>96</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This code employs a custom aggregation function to compute the range (difference between maximum and minimum) of the ‘Value’ column within each group.</p>
</section>
<section id="grouping-by-multiple-columns">
<h2><span class="section-number">5.11.5. </span>Grouping by multiple columns<a class="headerlink" href="#grouping-by-multiple-columns" title="Link to this heading">#</a></h2>
<p>Suppose we have a dataset containing sales data for different products in different regions. We want to group the data by both “Product” and “Region” to analyze the total sales and average price for each combination.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Set the random seed to ensure reproducibility</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define the number of rows in the DataFrame</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Generate random data using NumPy functions directly</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Product&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">],</span> <span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">)}</span>

<span class="c1"># Create a Pandas DataFrame from the dictionary</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Display the resulting DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First top 5 rows of the data&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Grouping by both &quot;Product&quot; and &quot;Region&quot; and aggregating Sales and Price</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Region&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">result&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># This flattens the DataFrame.</span>
<span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">result (with reset index)&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First top 5 rows of the data
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Product</th>
      <th>Region</th>
      <th>Sales</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>South</td>
      <td>136</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>North</td>
      <td>191</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>South</td>
      <td>150</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>North</td>
      <td>170</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>South</td>
      <td>146</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>result
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Sales</th>
      <th>Price</th>
    </tr>
    <tr>
      <th>Product</th>
      <th>Region</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">A</th>
      <th>North</th>
      <td>4242</td>
      <td>16.214286</td>
    </tr>
    <tr>
      <th>South</th>
      <td>2922</td>
      <td>16.150000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">B</th>
      <th>North</th>
      <td>3311</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>South</th>
      <td>4318</td>
      <td>15.103448</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>result (with reset index)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Product</th>
      <th>Region</th>
      <th>Sales</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>North</td>
      <td>4242</td>
      <td>16.214286</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>South</td>
      <td>2922</td>
      <td>16.150000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>North</td>
      <td>3311</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>South</td>
      <td>4318</td>
      <td>15.103448</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this example, we first create a DataFrame containing sales data for different products in different regions. Then, we group the data using <code class="docutils literal notranslate"><span class="pre">groupby(['Product',</span> <span class="pre">'Region'])</span></code> to form multi-level groups based on both “Product” and “Region”. Finally, we calculate the total sales and average price for each combination using the <code class="docutils literal notranslate"><span class="pre">agg()</span></code> function with a dictionary specifying the aggregation functions for each column. The <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> function is used to convert the grouped results into a DataFrame for better presentation.</p>
</section>
<section id="applying-different-aggregations-to-different-columns">
<h2><span class="section-number">5.11.6. </span>Applying different aggregations to different columns<a class="headerlink" href="#applying-different-aggregations-to-different-columns" title="Link to this heading">#</a></h2>
<p>You can apply different aggregate functions to different columns using the <code class="docutils literal notranslate"><span class="pre">agg()</span></code> method with a dictionary. Consider a dataset containing information about sales of different products. We want to group the data by “Product” and calculate the total sales as well as the maximum and minimum prices for each product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grouping by &quot;Product&quot;</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span>

<span class="c1"># Applying different aggregations to different columns</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>      <span class="c1"># Calculate total sales for each product</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">]</span>  <span class="c1"># Calculate maximum and minimum prices for each product</span>
    <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Product</th>
      <th>Sales</th>
      <th colspan="2" halign="left">Price</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>max</th>
      <th>min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>7164</td>
      <td>22</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>7629</td>
      <td>22</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This code groups a DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> by the ‘Product’ column, then applies aggregation functions to calculate the total sales for each product and the maximum and minimum prices.</p>
</section>
<section id="named-aggregation">
<h2><span class="section-number">5.11.7. </span>Named Aggregation<a class="headerlink" href="#named-aggregation" title="Link to this heading">#</a></h2>
<p>Named Aggregation in pandas allows you to assign custom column names to the results of aggregation functions, making it easier to interpret and work with the summarized data. This feature was introduced in pandas version 0.25.</p>
<p>To use named aggregation, you can define a named tuple with custom column names and specify the aggregation functions for each column in the <code class="docutils literal notranslate"><span class="pre">agg()</span></code> method. This allows you to have more descriptive column names in the resulting DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Set the random seed to ensure reproducibility</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define the number of rows in the DataFrame</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Generate random data using NumPy functions directly</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Product&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">],</span> <span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">),</span>
        <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">)}</span>

<span class="c1"># Create a Pandas DataFrame from the dictionary</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Group, aggregate, and display in one chain</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">TotalSales</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span>
                                    <span class="n">MinPrice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">),</span>
                                    <span class="n">AvgPrice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">),</span>
                                    <span class="n">MaxPrice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
                                    <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="c1"># Adding spaces between words in column names that are in CamelCase.</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?&lt;=[a-z])(?=[A-Z])&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">grouped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Product</th>
      <th>Total Sales</th>
      <th>Min Price</th>
      <th>Avg Price</th>
      <th>Max Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>7164</td>
      <td>10</td>
      <td>16.1875</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>7629</td>
      <td>10</td>
      <td>15.5000</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The provided Python code uses the pandas library to work with a dataset containing product information, including sales and prices. It groups the data by product, and within each group, it calculates total sales, minimum price, average price, and maximum price. The code then organizes the results into a new DataFrame with appropriately named columns. It employs regular expressions to add spaces between words in column names that are in CamelCase.</p>
</section>
<section id="grouping-and-resampling-time-series-data">
<h2><span class="section-number">5.11.8. </span>Grouping and Resampling Time Series Data<a class="headerlink" href="#grouping-and-resampling-time-series-data" title="Link to this heading">#</a></h2>
<section id="resample-function-for-time-series-analysis">
<h3><span class="section-number">5.11.8.1. </span><code class="docutils literal notranslate"><span class="pre">resample</span></code> Function for Time Series Analysis<a class="headerlink" href="#resample-function-for-time-series-analysis" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">resample</span></code> function within pandas is a versatile and dynamic tool designed explicitly for managing time series data. It extends the capability to modify the frequency of your time-dependent data and simultaneously carry out a multitude of aggregation operations on the grouped data. The essence of the <code class="docutils literal notranslate"><span class="pre">resample</span></code> function can be succinctly encapsulated as follows <span id="id5">[<a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>:</p>
<p>When applied to pandas DataFrames or Series with a datetime index, the <code class="docutils literal notranslate"><span class="pre">resample</span></code> function’s primary purpose is to partition time series data into distinct time intervals (such as days, months, years) while offering the flexibility to employ aggregation functions within each interval. The general syntax of utilization stands as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_resampled_object</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
</pre></div>
</div>
<p>In this context, <code class="docutils literal notranslate"><span class="pre">rule</span></code> symbolizes a string that defines the desired resampling frequency, such as <code class="docutils literal notranslate"><span class="pre">'D'</span></code> for daily, <code class="docutils literal notranslate"><span class="pre">'M'</span></code> for monthly, <code class="docutils literal notranslate"><span class="pre">'A'</span></code> for annually, and so forth.</p>
<p>The true power of the <code class="docutils literal notranslate"><span class="pre">resample</span></code> function lies in its inherent adaptability, enabling a seamless exploration of trends, patterns, and aggregated insights across various time intervals.</p>
<p>You can find a comprehensive description by following this <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.resample.html">link</a>.</p>
<p><font color='Blue'><b>Example:</b></font> Consider our initial illustration involving climate data from the University of Calgary station for the 1st half of the year 1990.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/HatefDastour/ENGG_680/main/Datasets/UofC_Daily_1990_Q1Q2.csv&#39;</span><span class="p">,</span>
                <span class="n">parse_dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Date/Time&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date/Time&#39;</span><span class="p">)</span>

<span class="c1"># Grouping by month and calculating the sum of sales and revenue for each group</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Mean Temp (°C)&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>

<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mean Temp (°C)</th>
    </tr>
    <tr>
      <th>Date/Time</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1990-01-01</th>
      <td>-4.377419</td>
    </tr>
    <tr>
      <th>1990-02-01</th>
      <td>-6.096429</td>
    </tr>
    <tr>
      <th>1990-03-01</th>
      <td>1.225806</td>
    </tr>
    <tr>
      <th>1990-04-01</th>
      <td>4.573333</td>
    </tr>
    <tr>
      <th>1990-05-01</th>
      <td>8.854839</td>
    </tr>
    <tr>
      <th>1990-06-01</th>
      <td>13.296667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">df.resample('MS').agg({'Mean</span> <span class="pre">Temp</span> <span class="pre">(°C)':</span> <span class="pre">'mean'})</span></code>: Here, <code class="docutils literal notranslate"><span class="pre">resample</span></code> is applied to the DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">resample('MS')</span></code> specifies the resampling frequency. ‘MS’ stands for “Month Start,” indicating that the data will be resampled at the beginning of each month.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agg({'Mean</span> <span class="pre">Temp</span> <span class="pre">(°C)':</span> <span class="pre">'mean'})</span></code> defines the aggregation operation to be performed during resampling. In this case, it calculates the mean of the ‘Mean Temp (°C)’ column for each month.</p></li>
</ul>
</section>
</section>
<section id="group-iteration">
<h2><span class="section-number">5.11.9. </span>Group Iteration<a class="headerlink" href="#group-iteration" title="Link to this heading">#</a></h2>
<p>In Pandas, you can use the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method to group data in a DataFrame based on one or more columns. Once you have grouped the data, you might want to perform operations on each group or apply custom functions to each group. Iterating through the grouped data can be done using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> object.</p>
<p>Let’s go through an example to illustrate how to iterate through the groups:</p>
<p>Suppose you have the following DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># Set the random seed for reproducibility (optional)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Define the number of rows in the DataFrame</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="mi">10</span>


<span class="c1"># Create a dictionary with the generated data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_rows</span><span class="p">)],</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_rows</span><span class="p">)}</span>

<span class="c1"># Create a Pandas DataFrame from the dictionary</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Print the resulting DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>88</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, let’s group the data by the ‘Category’ column and iterate through the groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group: A
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>88</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A</td>
      <td>95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>A</td>
      <td>53</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A</td>
      <td>99</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group: B
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>68</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>80</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>49</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method has created two groups based on the unique values in the ‘Category’ column (‘A’ and ‘B’). We used a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to iterate through each group, and in each iteration, the variable <code class="docutils literal notranslate"><span class="pre">name</span></code> contains the group name (‘A’ or ‘B’), and the variable <code class="docutils literal notranslate"><span class="pre">group</span></code> contains the corresponding DataFrame for that group.</p>
<p>You can perform various operations on each group inside the loop or apply custom functions using the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method on the grouped object. The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method is a powerful tool for data aggregation and analysis, making it easier to work with subsets of data based on certain criteria.</p>
</section>
<section id="filtering-groups">
<h2><span class="section-number">5.11.10. </span>Filtering Groups<a class="headerlink" href="#filtering-groups" title="Link to this heading">#</a></h2>
<p>In Pandas, after grouping the data using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method, you may want to filter the groups based on specific conditions. This can be done using the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function of the grouped object. The <code class="docutils literal notranslate"><span class="pre">filter</span></code> function allows you to apply a function to each group and returns only the groups that satisfy the specified condition <span id="id6">[<a class="reference internal" href="../References.html#id51" title="Pandas Developers. Pandas documentation. https://pandas.pydata.org/docs/, 2023. [Online; accessed 01-August-2023].">Pandas Developers, 2023</a>]</span>.</p>
<p>Let’s go through an example to demonstrate how to filter groups in Pandas:</p>
<p>Suppose you have the following DataFrame:</p>
<p>Now, let’s group the data by the ‘Category’ column and filter out the groups based on a condition, for example, keeping only the groups with a sum of ‘Value’ greater than 30:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)</span>

<span class="n">filtered_groups</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">filtered_groups</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>88</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>80</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>49</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>11</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A</td>
      <td>95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>A</td>
      <td>53</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A</td>
      <td>99</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this example, the lambda function inside the <code class="docutils literal notranslate"><span class="pre">filter</span></code> method checks whether the sum of ‘Value’ in each group is greater than 30. Only the groups that satisfy this condition are returned in the <code class="docutils literal notranslate"><span class="pre">filtered_groups</span></code> DataFrame.</p>
<p>You can use any custom function inside the <code class="docutils literal notranslate"><span class="pre">filter</span></code> method to perform more complex filtering operations based on your specific requirements.</p>
<p>Remember that the result of filtering will be a new DataFrame that contains only the rows from the original DataFrame that belong to the groups meeting the specified condition.</p>
</section>
<section id="transformation">
<h2><span class="section-number">5.11.11. </span>Transformation<a class="headerlink" href="#transformation" title="Link to this heading">#</a></h2>
<p>In Pandas, the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> transform operation is used to transform the grouped data, broadcasting the results back to the original DataFrame. The transform function returns a new DataFrame or Series with the same shape as the original, but with the transformed values based on the grouped data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">transform</span></code> method is often used to perform operations on each group and align the results with the original DataFrame, preserving the index and columns. This is especially useful when you want to add aggregated values back to each row of the original DataFrame.</p>
<p>Let’s go through an example to demonstrate how to use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> with <code class="docutils literal notranslate"><span class="pre">transform</span></code>:</p>
<p>Suppose you have the following DataFrame:</p>
<p>Now, let’s use the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> transform to add a new column ‘GroupSum’ containing the sum of ‘Value’ for each ‘Category’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;GroupSum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>88</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>80</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>49</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>11</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A</td>
      <td>95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>A</td>
      <td>53</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A</td>
      <td>99</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Value</th>
      <th>GroupSum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>9</td>
      <td>344</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>25</td>
      <td>233</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>68</td>
      <td>233</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>88</td>
      <td>344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>80</td>
      <td>233</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>49</td>
      <td>233</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>11</td>
      <td>233</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A</td>
      <td>95</td>
      <td>344</td>
    </tr>
    <tr>
      <th>8</th>
      <td>A</td>
      <td>53</td>
      <td>344</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A</td>
      <td>99</td>
      <td>344</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the ‘GroupSum’ column is added to the original DataFrame, and each row now contains the sum of ‘Value’ for its corresponding ‘Category’.</p>
<p>You can use any function compatible with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> (e.g., ‘sum’, ‘mean’, ‘min’, ‘max’, custom functions) with the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method. This allows you to apply various transformations to the grouped data and broadcast the results back to the original DataFrame.</p>
</section>
<section id="filling-gaps-using-groupby">
<h2><span class="section-number">5.11.12. </span>Filling Gaps Using <code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#filling-gaps-using-groupby" title="Link to this heading">#</a></h2>
<p>When handling grouped data, addressing missing values or gaps is a crucial task. Pandas offers various methods to fill these gaps effectively, each with its unique approach and advantages.</p>
<section id="forward-fill-and-backward-fill">
<h3><span class="section-number">5.11.12.1. </span>Forward Fill and Backward Fill<a class="headerlink" href="#forward-fill-and-backward-fill" title="Link to this heading">#</a></h3>
<p>Forward Fill and Backward Fill are two straightforward methods to handle missing values. <strong>Forward Fill</strong> (<code class="docutils literal notranslate"><span class="pre">ffill()</span></code>) propagates the last valid observation forward to fill gaps. This method is useful when the preceding value is a reasonable estimate for the missing data. Conversely, <strong>Backward Fill</strong> (<code class="docutils literal notranslate"><span class="pre">bfill()</span></code>) propagates the next valid observation backward. This method can be useful when subsequent values are expected to be similar to the missing ones. These methods are often used in time series data where the latest available data is assumed to be the best estimate for the missing values.</p>
<p><font color='Blue'><b>Example:</b></font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Sample DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Forward Fill</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Forward Fill:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Reset for Backward Fill Example</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Backward Fill</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Backward Fill:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Data
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Forward Fill:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backward Fill:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="fill-with-aggregated-values">
<h3><span class="section-number">5.11.12.2. </span>Fill with Aggregated Values<a class="headerlink" href="#fill-with-aggregated-values" title="Link to this heading">#</a></h3>
<p>Filling gaps with aggregated values involves using statistical measures such as mean, median, or mode to replace missing values within each group. This method ensures that the filled values are representative of the group’s overall trend. For instance, filling missing values with the group’s mean provides a balanced estimate, reducing the impact of outliers. This approach is particularly effective when the data within each group is expected to follow a normal distribution.</p>
<p><font color='Blue'><b>Example:</b></font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Sample DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Fill with Mean</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fill with Mean:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Data
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fill with Mean:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="interpolate-missing-values">
<h3><span class="section-number">5.11.12.3. </span>Interpolate Missing Values<a class="headerlink" href="#interpolate-missing-values" title="Link to this heading">#</a></h3>
<p>Interpolation is a technique used to estimate missing values based on the known values surrounding them. The <code class="docutils literal notranslate"><span class="pre">interpolate()</span></code> method in pandas provides a flexible way to perform linear or non-linear interpolation within each group. This method is beneficial when the data is expected to change gradually and smoothly. Interpolation can provide more accurate estimates than simple forward or backward fills, especially in datasets where trends or patterns are present.</p>
<p><font color='Blue'><b>Example:</b></font> Within each group, the code uses the <code class="docutils literal notranslate"><span class="pre">interpolate()</span></code> method to estimate and fill in the missing values. Interpolation is a technique that estimates missing values based on the values before and after the gap, providing a smooth transition between data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Sample DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Interpolate Missing Values</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">interpolate</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interpolate Missing Values:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Data
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolate Missing Values:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="custom-fill-methods">
<h3><span class="section-number">5.11.12.4. </span>Custom Fill Methods<a class="headerlink" href="#custom-fill-methods" title="Link to this heading">#</a></h3>
<p>In some cases, predefined methods might not be sufficient to handle specific data requirements. Custom fill methods allow you to define your own logic to fill gaps based on specific criteria. For instance, you might combine forward and backward fill methods or apply complex rules tailored to your dataset. This flexibility ensures that the method used to fill missing values aligns perfectly with the nature of the data and the analytical goals.</p>
<p><font color='Blue'><b>Example:</b></font> Within each group, the code fills the missing values using a combination of forward fill (<code class="docutils literal notranslate"><span class="pre">ffill()</span></code>) and backward fill (<code class="docutils literal notranslate"><span class="pre">bfill()</span></code>). This ensures that any gaps in the data are filled with the nearest available values from within the same group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Sample DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Custom Fill Function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">custom_fill</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Custom logic to fill gaps</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">custom_fill</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom Fill Method:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Data
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Custom Fill Method:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="PyIntro_C05S10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.10. </span>Pandas <code class="docutils literal notranslate"><span class="pre">join</span></code> and <code class="docutils literal notranslate"><span class="pre">concat</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="PyIntro_C05S12.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.12. </span>Pandas pivot and melt</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data-with-groupby">5.11.1. Grouping Data with <code class="docutils literal notranslate"><span class="pre">groupby()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-syntax">5.11.1.1. Basic Syntax</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-extracting-insights-from-groups">5.11.2. Aggregation: Extracting Insights from Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-aggregations">5.11.3. Multiple aggregations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-aggregation-optional-content">5.11.4. Custom aggregation (Optional Content)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-by-multiple-columns">5.11.5. Grouping by multiple columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-different-aggregations-to-different-columns">5.11.6. Applying different aggregations to different columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#named-aggregation">5.11.7. Named Aggregation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-resampling-time-series-data">5.11.8. Grouping and Resampling Time Series Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resample-function-for-time-series-analysis">5.11.8.1. <code class="docutils literal notranslate"><span class="pre">resample</span></code> Function for Time Series Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-iteration">5.11.9. Group Iteration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-groups">5.11.10. Filtering Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation">5.11.11. Transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-gaps-using-groupby">5.11.12. Filling Gaps Using <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-fill-and-backward-fill">5.11.12.1. Forward Fill and Backward Fill</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fill-with-aggregated-values">5.11.12.2. Fill with Aggregated Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-missing-values">5.11.12.3. Interpolate Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-fill-methods">5.11.12.4. Custom Fill Methods</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hatef Dastour
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>